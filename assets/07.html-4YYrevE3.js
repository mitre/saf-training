import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as d,a as k,d as n,b as i,w as t,e as s,r as p,o}from"./app-CUwJYUKO.js";const g={};function A(y,e){const l=p("CodeTabs");return o(),d("div",null,[e[28]||(e[28]=k('<h2 id="inspec-control-enhancements" tabindex="-1"><a class="header-anchor" href="#inspec-control-enhancements"><span>InSpec Control Enhancements</span></a></h2><p>You should have the basic idea of how an InSpec test is written and how to leverage InSpec&#39;s built-in features to help you write tests quickly and easily. Now let&#39;s discuss some of the more powerful features available to you when writing tests to control what output is displayed to the user.</p><h3 id="rspec" tabindex="-1"><a class="header-anchor" href="#rspec"><span>RSpec</span></a></h3><p>The InSpec testing framework is itself built on <a href="https://rspec.info/" target="_blank" rel="noopener noreferrer">RSpec</a>, a unit testing module for Ruby. InSpec extended rspec by including features like the resources library and more user-friendly syntax for writing tests, but we can still write our tests using RSpec syntax and they will work just fine.</p><p>Most of the time you won&#39;t need to use RSpec syntax to write a good test. But we want to show you a few neat tricks you can accomplish with RSpec.</p><h3 id="rspec-explicit-subject" tabindex="-1"><a class="header-anchor" href="#rspec-explicit-subject"><span>RSpec Explicit Subject</span></a></h3><p>We will write a few tests in this section to demonstrate the difference between InSpec&#39;s default syntax and RSpec syntax.</p><p>Let&#39;s pretend we have a new requirement for NGINX:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NGINX&#39;s /etc/nginx directory should not be empty.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>(It&#39;s a bit of an odd requirement, but bear with us for the sake of this example.)</p><p>First, we&#39;ll try a test that <em>does not</em> use RSpec syntax to illustrate the problem we want to solve:</p>',11)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[0]||(e[0]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[1]||(e[1]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[2]||(e[2]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"control "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'Requirement 6'"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  impact "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  title "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'Checking that /etc/nginx does not return empty'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  desc "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'Let"),i("span",{style:{"--shiki-light":"#0184BC","--shiki-dark":"#56B6C2"}},"\\'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"s do this the ugly way.'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'ls -al'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"stdout"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"strip"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"    it { should_not be_empty }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"  end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[3]||(e[3]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Requirement"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Checking"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," that"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," does"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," return"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," empty")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  total"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 76")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," .")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ..")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     -rwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," .dockerenv")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     lrwxrwxrwx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    7"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bin"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," -> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"usr/bin")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Sep"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 29"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:04"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," boot")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   5"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  360"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," dev")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 05:12"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-entrypoint.d")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     -rwxrwxr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1620"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 05:11"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-entrypoint.sh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," etc")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Sep"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 29"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:04"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," home")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     lrwxrwxrwx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    7"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," lib"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," -> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"usr/lib")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     lrwxrwxrwx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    9"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," lib32"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," -> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"usr/lib32")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     lrwxrwxrwx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    9"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," lib64"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," -> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"usr/lib64")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     lrwxrwxrwx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   10"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," libx32"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," -> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"usr/libx32")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," media")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," mnt")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," opt")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     dr-xr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 228"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," proc")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwx------"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," run")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     lrwxrwxrwx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," sbin"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," -> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"usr/sbin")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," srv")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     dr-xr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  12"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"    0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  8"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 20:21"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," sys")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxrwxrwt"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Nov"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"  1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 05:12"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," tmp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," usr")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     drwxr-xr-x"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4096"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Oct"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 30"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 00:00"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," var"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," empty")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[29]||(e[29]=k('<p>Well. . . it <em>sort of</em> works.</p><p>Notice how much output InSpec printed here to answer the simple question of &quot;did this command return empty?&quot; Imagine if we had done this on a directory with many files in it. We&#39;d just be cluttering up the screen (and our report files) with output that is only tangential to what we really want to know, which is that the directory is <em>not empty</em>; we don&#39;t care what&#39;s in it.</p><div class="hint-container warning"><p class="hint-container-title">Wait, couldn&#39;t we have just used the directory resource for this?</p><p>Correct. That would have been a much better way of doing this, and illustrates the general principle of &quot;don&#39;t use raw shell commands with the <code>command</code> resource unless you have to.&quot;</p><p>We&#39;re just doing it this way for the example.</p></div><p>If we would like to have a more detailed and cleaner feedback to our user, we can override the standard title of our describe block with a specific message that describes the intent of the test and use the <a href="https://rspec.info/features/3-12/rspec-core/subject/explicit-subject/" target="_blank" rel="noopener noreferrer"><code>subject</code> keyword</a> to tell InSpec what the &quot;subject&quot; is for the test. This allows us to refactor the code like this:</p>',4)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[4]||(e[4]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[5]||(e[5]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[6]||(e[6]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"control "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'Requirement 6'"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  impact "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  title "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'Checking that /etc/nginx does not return empty'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  desc "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'Let"),i("span",{style:{"--shiki-light":"#0184BC","--shiki-dark":"#56B6C2"}},"\\'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"s do this the concise way.'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  describe "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"The /etc/nginx directory"'),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"    subject { "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'ls -al'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"stdout"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"strip"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"    it { should_not be_empty }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"  end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[7]||(e[7]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Requirement"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Checking"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," that"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," does"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," return"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," empty")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  The"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," directory"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," empty")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[30]||(e[30]=k('<p>Much better, right? We can override InSpec&#39;s default output to print a message that is actually useful.</p><div class="hint-container info"><p class="hint-container-title">Info</p><p>Another benefit to using <code>subject</code> is preventing command output from being stored in the report.</p></div><h3 id="the-should-vs-expect-syntax" tabindex="-1"><a class="header-anchor" href="#the-should-vs-expect-syntax"><span>The <code>should</code> vs. <code>expect</code> syntax</span></a></h3><p>Users familiar with the RSpec testing framework may know that there are two ways to write test statements: <code>should</code> and <code>expect</code>. The RSpec community decided that <code>expect</code> is the preferred syntax.</p><p>InSpec recommends the <code>should</code> syntax as it tends to read more easily. However, there are times when the <code>expect</code> syntax will communicate much more clearly to the end-user. InSpec will continue to support both methods of writing tests.</p><p>Let&#39;s copy the <code>describe</code> shown below directly into our <code>example.rb</code> file (we don&#39;t need to wrap them in a <code>control</code> block for this section). Consider this <code>describe</code> block from your <code>my_nginx</code> profile:</p>',6)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[8]||(e[8]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[9]||(e[9]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[10]||(e[10]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"file"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'/etc/nginx/nginx.conf'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it { should be_file }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[11]||(e[11]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"   ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  should"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," a"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[31]||(e[31]=i("p",null,"This can be re-written with expect syntax.",-1)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[12]||(e[12]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[13]||(e[13]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[14]||(e[14]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"file"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'/etc/nginx/nginx.conf'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'should be a file'"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    expect"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(subject)."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"to"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(be_file)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"  end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[15]||(e[15]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"   ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  should"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," a"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[32]||(e[32]=i("p",null,"Notice that the output is the same for both the examples above.",-1)),e[33]||(e[33]=i("p",null,[s("In addition, you can make use of the "),i("code",null,"subject"),s(" keyword to further control your output if you choose:")],-1)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[16]||(e[16]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[17]||(e[17]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[18]||(e[18]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'I can make this any string I want!'"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  subject { "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"file"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'/etc/nginx/nginx.conf'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'should be a file'"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    expect"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(subject)."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"to"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(be_file)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"  end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[19]||(e[19]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  I"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," can"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," make"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," this"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," any"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," string"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," I"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," want!")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  should"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," a"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[34]||(e[34]=k('<div class="hint-container info"><p class="hint-container-title">Info</p><p>Note that all three of the above code examples are running the same test that will pass or fail in the same circumstances — the difference is that the second two examples give more control over the message output that appears to the test performer. If you write tests that will later be executed by other people, you should be sure to write descriptive test output!</p></div><p>Reference: <a href="https://docs.chef.io/inspec/profiles/" target="_blank" rel="noopener noreferrer">https://docs.chef.io/inspec/profiles/</a></p><h3 id="expect-syntax-with-a-failure-message" tabindex="-1"><a class="header-anchor" href="#expect-syntax-with-a-failure-message"><span><code>expect</code> syntax with a failure message</span></a></h3><p>In addition to using an <code>expect</code> statement, a failure message can be added to provide a meaningful output to the end user.</p><p>Consider this shell access test from your nginx profile:</p>',5)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[20]||(e[20]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[21]||(e[21]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[22]||(e[22]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe users."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"shells"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#0184BC","--shiki-dark":"#E06C75"}},"/bash/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"usernames"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it { should be_in "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"input"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'admin_users'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[23]||(e[23]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"root"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," in"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "admin"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' `["root"]`'),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," in"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," the"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," list:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' `["admin"]`'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     Diff:")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"root"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[35]||(e[35]=i("p",null,`Again, this is a valid test, and will return the right pass/fail answer when run, but it is difficult for a person to parse if they were not the author ("The root user is supposed to be 'in' the admin user? What does that mean?!").`,-1)),e[36]||(e[36]=i("p",null,"The output of a test like this can be refined to provide a cleaner output to the user. This can be done using a custom failure message:",-1)),n(l,{data:[{id:"Code"},{id:"Output"}]},{title0:t(({value:a,isActive:h})=>[...e[24]||(e[24]=[s("Code",-1)])]),title1:t(({value:a,isActive:h})=>[...e[25]||(e[25]=[s("Output",-1)])]),tab0:t(({value:a,isActive:h})=>[...e[26]||(e[26]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"non_admin_users"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}}," ="),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," users."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"shells"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#0184BC","--shiki-dark":"#E06C75"}},"/bash/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"usernames")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"Shell access for non-admin users"'),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"should be removed."'),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    failure_message"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}}," ="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "These non-admin should not have shell access: '),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"#{"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"non_admin_users."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"join"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'", "'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},")"),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"}"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    expect"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(non_admin_users)."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"to"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," eq"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"input"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'admin_users'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")), failure_message")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"  end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:t(({value:a,isActive:h})=>[...e[27]||(e[27]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Shell"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," access"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," non-admin"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," users")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  should"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," removed.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     These"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," non-admin"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," should"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," have"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," shell"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," access:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," root")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),e[37]||(e[37]=k(`<p>The <code>failure_message</code> variable in the above <code>describe</code> block is assigned a value by pure Ruby assignment. Remember how we said that, since InSpec is built on Ruby, any Ruby syntax will work inside an InSpec test? Ruby&#39;s string formatting syntax (the <code>#{non_admin_users.join(&quot;, &quot;)}</code>) can create a string that lists the users who fail the test by having shell access when they shouldn&#39;t.</p><div class="hint-container tip"><p class="hint-container-title">Writing good failure messages</p><p>The trick to writing useful failure messages is to use Ruby to find the <em>subset</em> of all elements we are testing (here, the users) that actually fail the test. We don&#39;t need to print a statement for <em>every array element we tested;</em> we only need to print a statement that shows the elements that failed.</p></div><h3 id="expect-syntax-and-password-hashes" tabindex="-1"><a class="header-anchor" href="#expect-syntax-and-password-hashes"><span><code>Expect</code> syntax and Password Hashes</span></a></h3><p>Here&#39;s another example -- we have an InSpec test that checks if passwords are SHA512 hashes.</p><p>As we said, when possible, and when there is a high change of a large set only having a few offending items, attempt to find only those items that could be outside our requirements. If there are none -- wonderful! We met our requirement.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">bad_users</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">shadow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">where</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;*&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;!&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!~</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;"> /</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\$</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">6</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\$</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">users</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # note that SHA512-encrypted passwords are marked by starting with &#39;$6$&#39; in /etc/shadow</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">describe </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Password hashes in /etc/shadow&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  it </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;should only contain SHA512 hashes&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    failure_message</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Users without SHA512 hashes: </span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">#{</span><span style="--shiki-light:#50A14F;--shiki-dark:#ABB2BF;">bad_users.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#50A14F;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;, &#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    expect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(bad_users).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">to</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> be_empty, failure_message</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="using-multiple-resources-for-one-test" tabindex="-1"><a class="header-anchor" href="#using-multiple-resources-for-one-test"><span>Using Multiple Resources For One Test</span></a></h3><p>The <code>file</code> resource is perfect for looking at single files and their properties. However, it does not look at <em>groups</em> of files. To do that, we need to use multiple resources in concert.</p><p>Take a look at this example from a profile for use in AWS virtual machines. We use the <code>command</code> resource to run the <code>find</code> command and then use the <code>file</code> resource to investigate each result. Using multiple resources together is one of the key values InSpec provides, allowing you to get at just the data you need when you need it.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;find ~/* -type f -maxdepth 0 -xdev&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stdout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">each</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">fname</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # we need to be careful about using &#39;find&#39; --</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                                            # there could be a LOT of output if we are not specific enough with the search!</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(fname) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;owner&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should cmp </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ec2-user&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">Avoid Large Sets or &#39;Check Everyone at the Door&#39; Approaches</p><p>For IO intensive (full filesystem, or global scans) or large scale processes, try to be as specific as possible with your searches. Think about using &#39;negative logic&#39; vs &#39;positive logic&#39; - &quot;Find me all the items outside my target set&quot; vs &quot;Look at each item in the set and ensure it has these properties&quot;.</p><p>This &#39;find the outsiders&#39; vs &#39;check everyone at the door&#39; approach can really speed things along. Again, keep your data set as small as possible, don&#39;t inspect more than the requirements require!</p></div>`,11))])}const F=r(g,[["render",A]]),m=JSON.parse(`{"path":"/courses/beginner/07.html","title":"7. InSpec Control Enhancements","lang":"en-US","frontmatter":{"order":7,"next":"08.md","title":"7. InSpec Control Enhancements","author":"Aaron Lippold","description":"InSpec Control Enhancements You should have the basic idea of how an InSpec test is written and how to leverage InSpec's built-in features to help you write tests quickly and ea...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"7. InSpec Control Enhancements\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-04T15:19:54.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron Lippold\\"}]}"],["meta",{"property":"og:url","content":"https://mitre.github.io/saf-training/saf-training/courses/beginner/07.html"}],["meta",{"property":"og:site_name","content":"MITRE SAF Training"}],["meta",{"property":"og:title","content":"7. InSpec Control Enhancements"}],["meta",{"property":"og:description","content":"InSpec Control Enhancements You should have the basic idea of how an InSpec test is written and how to leverage InSpec's built-in features to help you write tests quickly and ea..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-12-04T15:19:54.000Z"}],["meta",{"property":"article:author","content":"Aaron Lippold"}],["meta",{"property":"article:modified_time","content":"2024-12-04T15:19:54.000Z"}]]},"git":{"createdTime":1653259416000,"updatedTime":1733325594000,"contributors":[{"name":"Aaron Lippold","username":"","email":"lippold@gmail.com","commits":3},{"name":"em-c-rod","username":"em-c-rod","email":"32680215+em-c-rod@users.noreply.github.com","commits":3,"url":"https://github.com/em-c-rod"},{"name":"Emily Rodriguez","username":"","email":"ecrodriguez@mm279976-pc.lan","commits":5},{"name":"Shivani Karikar","username":"","email":"karikarshivani@gmail.com","commits":10},{"name":"wdower","username":"wdower","email":"will@dower.dev","commits":3,"url":"https://github.com/wdower"},{"name":"Amndeep Singh Mann","username":"","email":"amann@mitre.org","commits":6},{"name":"p-oneil","username":"p-oneil","email":"poneil@mitre.org","commits":1,"url":"https://github.com/p-oneil"},{"name":"Will","username":"Will","email":"will@dower.dev","commits":1,"url":"https://github.com/Will"}]},"readingTime":{"minutes":6.35,"words":1904},"filePathRelative":"courses/beginner/07.md","autoDesc":true}`);export{F as comp,m as data};
