import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,a as n,b as i,e as t,d as o,w as s,r as d,o as c}from"./app-CUwJYUKO.js";const p="/saf-training/assets/control_body-MCJfsTn0.png",h="/saf-training/assets/describe_block-O__Fc_IR.png",u="/saf-training/assets/inspec_full-m1TMJASt.png",m={},g={class:"hint-container warning"};function y(f,e){const a=d("RouteLink");return c(),l("div",null,[e[7]||(e[7]=n('<h2 id="_9-1-automated-validation-tests" tabindex="-1"><a class="header-anchor" href="#_9-1-automated-validation-tests"><span>9.1 Automated Validation Tests</span></a></h2><p>Now that we have written up some Check and Fix text, it&#39;s time to use one of Vulcan&#39;s other features -- the InSpec code pane.</p><h3 id="_9-1-1-the-inspec-control-body" tabindex="-1"><a class="header-anchor" href="#_9-1-1-the-inspec-control-body"><span>9.1.1 The InSpec Control Body</span></a></h3><p>Click on the InSpec Control Body tab in the requirement window.</p><figure><img src="'+p+'" alt="InSpec Control Body" tabindex="0" loading="lazy"><figcaption>InSpec Control Body</figcaption></figure><p>You&#39;ll see a code editing window directly in Vulcan. At present there isn&#39;t much to see inside of it. We should fix that.</p>',6)),i("div",g,[e[5]||(e[5]=i("p",{class:"hint-container-title"},"Wait, what if I have no idea how to write InSpec code?!",-1)),i("p",null,[e[2]||(e[2]=t("Great news, we have an in-depth ",-1)),o(a,{to:"/courses/beginner/"},{default:s(()=>[...e[0]||(e[0]=[t("training class",-1)])]),_:1}),e[3]||(e[3]=t(" on how to do this (",-1)),o(a,{to:"/courses/advanced/"},{default:s(()=>[...e[1]||(e[1]=[t("two of them",-1)])]),_:1}),e[4]||(e[4]=t(", actually).",-1))]),e[6]||(e[6]=i("p",null,"But if you don't have the time for those, don't sweat it; we just want you to know that this is something you can do with Vulcan.",-1))]),e[8]||(e[8]=n(`<p>Let&#39;s add in a few lines of InSpec code. You can write your own, or borrow from the below.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">parse_config_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/etc/security/faillock.conf&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;fail_interval&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should cmp </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 900</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go ahead and copy that code block and paste it into the editing window.</p><figure><img src="`+h+'" alt="InSpec Control" tabindex="0" loading="lazy"><figcaption>InSpec Control</figcaption></figure><div class="hint-container note"><p class="hint-container-title">Note</p><p>If you have taken the SAF User class, you have used <code>inspec exec</code> to run code that looks like the above against a target system.</p></div><p>Save the requirement.</p><p>Now check the &quot;InSpec Control (Read-Only)&quot; tab. It has used the contents of the other two tabs to assemble a completed InSpec control from your requirement, including the complete context of your STIG control as metadata tags in the test.</p><figure><img src="'+u+'" alt="InSpec Control" tabindex="0" loading="lazy"><figcaption>InSpec Control</figcaption></figure><p>We can export this content and start using it immediately if we wish (we&#39;ll discuss how in a later section).</p><h3 id="_9-1-2-why-am-i-writing-test-code-inside-vulcan" tabindex="-1"><a class="header-anchor" href="#_9-1-2-why-am-i-writing-test-code-inside-vulcan"><span>9.1.2 Why am I writing test code inside Vulcan?</span></a></h3><p>Vulcan includes the ability to write InSpec control code right alongside original guidance because we need a tight binding between the human-readable guidance and the machine-readable automation code.</p><p>Using Vulcan will ensure that all of your guidance is included in your test code as metadata (you can also do this by creating a profile stub with the <a href="https://saf-cli.mitre.org/#xccdf-benchmark-to-inspec-stub" target="_blank" rel="noopener noreferrer">SAF CLI</a>.)</p><p>You can think of this process as recording the pedigree of your tests into the code, so that you dont lose it as your code moves down the pipeline, and so that you <em>always know why you are running a check</em>.</p><p>Furthermore, another reason we added the InSpec control editing window is because in most cases, you are writing security guidance because you want to write security validation code! Recall that the whole point of Vulcan is to help us define the security posture target so that we can automate reaching it!</p><p>If you&#39;ve taken any other SAF classes, you may have noticed that a well-formed validation test&#39;s code will include tagging that aligns each individual test back to the baseline security document that required us to run it. The MITRE SAF tests in the validation library, in fact, include the exact text of the baseline document as tags and descriptions inside each test control. Therefore, Vulcan was built to automatically begin drafting an automated test as soon as we fill out our requirement details.</p><div class="hint-container note"><p class="hint-container-title">Do I need to use InSpec for my ATO process?</p><p>DOD does not and will not require teams to use any one particlar security validation tool.</p><p>MITRE SAF favors InSpec because it favors our use cases nicely, but there are many different security tools on the market, some of which are better suited to particular tasks.</p><p>In all cases, any test tool is better than no test tool.</p></div>',16))])}const b=r(m,[["render",y]]),v=JSON.parse(`{"path":"/courses/guidance/09.html","title":"9. Automated InSpec Testing","lang":"en-US","frontmatter":{"order":9,"next":"10.md","title":"9. Automated InSpec Testing","author":"Sumaa Sayed","headerDepth":3,"toc":{"levels":[2,5]},"description":"9.1 Automated Validation Tests Now that we have written up some Check and Fix text, it's time to use one of Vulcan's other features -- the InSpec code pane. 9.1.1 The InSpec Con...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"9. Automated InSpec Testing\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-02T03:46:43.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Sumaa Sayed\\"}]}"],["meta",{"property":"og:url","content":"https://mitre.github.io/saf-training/saf-training/courses/guidance/09.html"}],["meta",{"property":"og:site_name","content":"MITRE SAF Training"}],["meta",{"property":"og:title","content":"9. Automated InSpec Testing"}],["meta",{"property":"og:description","content":"9.1 Automated Validation Tests Now that we have written up some Check and Fix text, it's time to use one of Vulcan's other features -- the InSpec code pane. 9.1.1 The InSpec Con..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-12-02T03:46:43.000Z"}],["meta",{"property":"article:author","content":"Sumaa Sayed"}],["meta",{"property":"article:modified_time","content":"2024-12-02T03:46:43.000Z"}]]},"git":{"createdTime":1653259416000,"updatedTime":1733111203000,"contributors":[{"name":"Aaron Lippold","username":"","email":"lippold@gmail.com","commits":4},{"name":"wdower","username":"wdower","email":"57142072+wdower@users.noreply.github.com","commits":3,"url":"https://github.com/wdower"},{"name":"ssayed118","username":"ssayed118","email":"sumaasayed@mitre.org","commits":2,"url":"https://github.com/ssayed118"},{"name":"Emily Rodriguez","username":"","email":"ecrodriguez@mitre.org","commits":2},{"name":"em-c-rod","username":"em-c-rod","email":"32680215+em-c-rod@users.noreply.github.com","commits":3,"url":"https://github.com/em-c-rod"}]},"readingTime":{"minutes":2.07,"words":622},"filePathRelative":"courses/guidance/09.md","autoDesc":true}`);export{b as comp,v as data};
