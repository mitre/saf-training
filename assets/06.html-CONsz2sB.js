import{_ as r}from"./TestDrivenDevelopment-BPnOXm-o.js";import{_ as d}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,a as k,d as h,b as i,w as e,e as s,r as g,o}from"./app-CUwJYUKO.js";const c={},A={class:"hint-container tip"};function F(y,a){const t=g("CodeTabs");return o(),p("div",null,[a[44]||(a[44]=k(`<h2 id="custom-resource-docker" tabindex="-1"><a class="header-anchor" href="#custom-resource-docker"><span>Custom Resource - Docker</span></a></h2><p>Let&#39;s try a more complicated example by creating a resource that can parse a Docker Compose file.</p><p>If you&#39;ve ever deployed containerized applications before, you might be familiar with <a href="https://docs.docker.com/compose/" target="_blank" rel="noopener noreferrer">Docker Compose</a>, which is a container orchestration feature of the Docker container runtime. Docker Compose works by reading a YAML specfile called the Compose file that defines attributes about a set of containers we want to deploy and how they connect together. We don&#39;t need to know too much about how to run Docker Compose for this class, but let&#39;s say that we want to write an InSpec resource for testing that our Compose files match the configuration we expect.</p><h3 id="create-a-new-profile-and-set-up-docker-files" tabindex="-1"><a class="header-anchor" href="#create-a-new-profile-and-set-up-docker-files"><span>Create a new profile and set up Docker files</span></a></h3><p>First, we need a test target. Luckily, we already have a great one sitting in our Codespaces environment. It&#39;s the same Docker Compose file we use in the <code>build-lab.sh</code> script to launch the containers we use for this class! It looks like this:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># https://docs.docker.com/compose/compose-file/compose-file-v3/</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;3&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  operatingsystem</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">redhat/ubi9</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">redhat9</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    tty</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    stdin_open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  nginx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    tty</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    stdin_open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We will continue writing our controls to check against this Compose file.</p>`,7)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[0]||(a[0]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[1]||(a[1]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[2]||(a[2]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," init"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," profile"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[3]||(a[3]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," ───────────────────────────"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Code"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Generator"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ───────────────────────────"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," new"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," profile"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," at"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/docker-workstations")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," inspec.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," directory"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/docker-workstations/controls")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls/example.rb")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," README.md")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[45]||(a[45]=k(`<h3 id="develop-controls-to-test-run-profile" tabindex="-1"><a class="header-anchor" href="#develop-controls-to-test-run-profile"><span>Develop controls to test/run profile</span></a></h3><p>Conceptually, we want to write tests with this profile that will check different settings in a docker-compose file. If you are not sure what the InSpec code looks like for a particular test, start by writing what conceptually you want to achieve, then modify it to be correct syntax. We can do that with the idea of checking a setting in a docker-compose file, which we know is a YAML file, as such:</p><p>In the <code>docker-workstations/controls/example.rb</code> file, write the control:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;file_name&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;setting&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should_not eq </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;value&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We test early and often as according to the test-driven development paradigm. We know that the test we wrote is not complete, but we can see if we are on the right track. Remember that the command line output can help guide your development!</p>`,5)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[4]||(a[4]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[5]||(a[5]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[6]||(a[6]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[7]||(a[7]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file_name")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ↺"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Can't find file: file_name")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Test Summary: 0 successful, 0 failures, 1 skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[46]||(a[46]=k(`<p>We need to replace the <code>file_name</code> above with the location of the <code>docker-compose.yml</code> file. We also need to change the <code>setting</code> to grab the tag we want to retrieve. Finally we need to change <code>value</code> with the actual value as shown in the docker compose file. You can write multiple expectation statements in the describe block.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker-compose.yml&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;services&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;operatingsystem&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;image&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]) { should eq </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;redhat/ubi9&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;services&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;image&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]) { should cmp </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx:latest&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now if we test this control using the following command we should see all the tests pass.</p>`,3)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[8]||(a[8]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[9]||(a[9]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[10]||(a[10]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[11]||(a[11]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"operatingsystem",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[47]||(a[47]=k('<p>Much like our <code>git </code> example, this series of tests works, but it could be made better. We essentially parsed the Compose file with a simple YAML file parser which is fine for a one-off. However, if anybody else reads this code, it might not be clear what specific system component we are testing. Recall that we want InSpec tests to be extremely intuitive to read, even by people who did not write the code (and even by people who are not InSpec developers!). Furthermore, Compose files are very common! There&#39;s a high likelihood that you&#39;d need to assess the contents of one again.</p><p>Instead of writing a lot of repetitive code, we could create a resource specific to Compose files that exposes relevant attributes in an easy to access manner for reuse by our other controls - or even the broader security community if we choose to publish it publicly and/or get it merged into InSpec proper.</p><h3 id="rewrite-test-to-utilize-a-new-resource" tabindex="-1"><a class="header-anchor" href="#rewrite-test-to-utilize-a-new-resource"><span>Rewrite test to utilize a new resource</span></a></h3><p>Going back to the control, we will write it using a resource that doesn&#39;t exist called docker-compose-config that is going to take a path as a parameter.</p><details class="hint-container details"><summary>Test Driven Development</summary><p>Remember the idea of Test Driven Development (TDD), the &quot;red-green-clean&quot; cycle. This way of development is driven by the tests. In this way, you know when you have succeeded while developing something new! In other words, before writing a solution, first write the test (which will fail - red), so that you know exactly what the expectation should be and when you have achieved it. Then you can write the solution to make the test pass (green). Finally, clean up the solution to make it easy to read and efficient!<br><img src="'+r+'" alt="Test Driven Development" loading="lazy"></p></details>',5)),h(t,{data:[{id:"Tests"}]},{title0:e(({value:l,isActive:n})=>[...a[12]||(a[12]=[s("Tests",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[13]||(a[13]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"yaml"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'docker-compose.yml'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  its"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'services'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'operatingsystem'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'image'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]) { should eq "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'redhat/ubi9'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  its"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"(["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'services'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'nginx'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'image'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]) { should cmp "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'nginx:latest'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"docker_compose_config"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'docker-compose.yml'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  its"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'services.operatingsystem.image'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") { should eq "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'redhat/ubi9'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  its"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'services.nginx.image'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") { should cmp "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'nginx:latest'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[48]||(a[48]=i("p",null,[s("Now we should see an error if we go back to terminal and run the same command to execute a scan. We should get an error saying the "),i("code",null,"docker_compose_config"),s(" method does not yet exist. That's because we have not yet defined this resource.")],-1)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[14]||(a[14]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[15]||(a[15]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[16]||(a[16]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[17]||(a[17]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"operatingsystem",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"@wdower"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ➜"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (answer_key) $ inspec exec docker-workstations/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"< lots of error text >")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"         InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"         0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Failure"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Message:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Failed"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," load"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," source"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls/example.rb:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," undefined"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," method"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"docker_compose_config' for ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"< lots more error text >")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:          local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target ID:       bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     No tests executed.")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test Summary: 0 successful, 0 failures, 0 skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[49]||(a[49]=k(`<h3 id="develop-the-docker-resource" tabindex="-1"><a class="header-anchor" href="#develop-the-docker-resource"><span>Develop the Docker resource</span></a></h3><p>In the <code>libraries</code> directory of the profile we will make a <code>docker_compose_config.rb</code> file, , the content of the file should look like this:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># encoding: utf-8</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># copyright: 2019, The Authors</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DockerComposeConfig</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker_compose_config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),i("div",A,[a[22]||(a[22]=i("p",{class:"hint-container-title"},"Using InSpec Init to Create the Resource",-1)),a[23]||(a[23]=i("p",null,[s("Alternatively, you can use "),i("code",null,"inspec init resource <your-resource-name>"),s(' to create the template for your custom resource. You may have a "lib" folder or a "libraries" folder. Make sure that InSpec recognizes the location of your custom resource.')],-1)),h(t,{data:[{id:"Command"},{id:"Options"}]},{title0:e(({value:l,isActive:n})=>[...a[18]||(a[18]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[19]||(a[19]=[s("Options",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[20]||(a[20]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," init"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," resource"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker_compose_config"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --overwrite")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[21]||(a[21]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Enter"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Subdirectory"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," under"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," which"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," create"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," files:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ./docker-workstations")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Choose"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," layout,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," either"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 'resource-pack'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," or"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 'core':"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Resource"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Pack")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Choose"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Which"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," type"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," of"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," resource"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," template"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," use:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Basic")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Enter"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," the"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," description"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," of"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," this"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," resource:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," A"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," resource"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," testing"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," files")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Enter"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Class"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Name"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," your"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," resource.:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," DockerComposeConfig")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," ───────────────────────────"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Code"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Generator"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ───────────────────────────"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," new"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," resource"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," at"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/docker-workstations")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," directory"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/docker-workstations/docs")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docs/docker_compose_config.md")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," directory"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/docker-workstations/libraries")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," libraries/docker_compose_config.rb")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1})]),a[50]||(a[50]=i("p",null,"Now when we save and run the profile again using:",-1)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[24]||(a[24]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[25]||(a[25]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[26]||(a[26]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[27]||(a[27]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"[2024-12-09T07:03:10+00:00] ERROR: Failed to load profile docker-workstations: Failed to load source "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"for"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," controls/example.rb: wrong number of arguments ("),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"given"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 1,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"         InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"         0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Failure"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Message:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Failed"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," load"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," source"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls/example.rb:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," wrong"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," number"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," of"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," arguments"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (given "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"1,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"          local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"       bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     No"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," tests"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," executed.")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[51]||(a[51]=k(`<p>We will get an error saying we gave it the wrong number of arguments: <code>was given 1 but expected 0</code>. This is because every class in Ruby that has a parameter must have an initialize function to accept that parameter.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># encoding: utf-8</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># copyright: 2019, The Authors</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DockerComposeConfig</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker_compose_config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now let&#39;s run the profile once more.</p>`,3)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[28]||(a[28]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[29]||(a[29]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[30]||(a[30]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[31]||(a[31]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"operatingsystem",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  docker_compose_config")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  services.operatingsystem.image"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," method"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},`services' for #<#<Class:0x000077e66a0908d0>:0x000077e66a0c2358 @resource_skipped=false, @resource_failed=false, @supports=nil, @resource_exception_message=nil, @__backend_runner__=Inspec::Backend::Class @transport=Train::Transports::Local::Connection, @__resource_name__="docker_compose_config", @resource_params=["docker-compose.yml"], @path="docker-compose.yml">`)]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×  services.nginx.image ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined method `services'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for "),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},'#<#<Class:0x000077e66a0908d0>:0x000077e66a0c2358 @resource_skipped=false, @resource_failed=false, @supports=nil, @resource_exception_message=nil, @__backend_runner__=Inspec::Backend::Class @transport=Train::Transports::Local::Connection, @__resource_name__="docker_compose_config", @resource_params=["docker-compose.yml"], @path="docker-compose.yml">')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary: "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[52]||(a[52]=k(`<p>This time the profile runs, but we get a message that the <code>docker_compose_config</code> resource does not have the <code>services</code> method. So let&#39;s define that method now:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># encoding: utf-8</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># copyright: 2019, The Authors</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DockerComposeConfig</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker_compose_config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> services</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Start by just defining the <code>services</code> method. Then, let&#39;s run the profile once more.</p>`,3)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[32]||(a[32]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[33]||(a[33]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[34]||(a[34]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[35]||(a[35]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"operatingsystem",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  docker_compose_config")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  services.operatingsystem.image"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," method"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"operatingsystem' for nil:NilClass")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×  services.nginx.image ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined method `nginx'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for nil:NilClass")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary: "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[53]||(a[53]=k(`<p>Now we got a different failure that tells us a <code>nil</code> value was returned. So now we will go ahead and define the services method. We will use an already existing InSpec resource to parse the path file.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># encoding: utf-8</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># copyright: 2019, The Authors</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DockerComposeConfig</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker_compose_config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(path)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> services</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;services&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now let&#39;s run the profile once more.</p>`,3)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[36]||(a[36]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[37]||(a[37]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[38]||(a[38]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[39]||(a[39]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"operatingsystem",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  docker_compose_config")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  services.operatingsystem.image"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," method"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},`operatingsystem' for {"operatingsystem"=>{"image"=>"redhat/ubi9", "container_name"=>"redhat9", "tty"=>true, "stdin_open"=>true, "restart"=>"always"}, "nginx"=>{"image"=>"nginx:latest", "container_name"=>"nginx", "tty"=>true, "stdin_open"=>true, "restart"=>"always"}}:Hash`)]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×  services.nginx.image ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined method `nginx'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' for {"operatingsystem"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'{"image"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"redhat/ubi9", "container_name"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"redhat9", "tty"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"true"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},', "stdin_open"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"true"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},', "restart"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"always"}, "nginx"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'{"image"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx:latest", "container_name"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx", "tty"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"true"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},', "stdin_open"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"true"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},', "restart"='),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},">"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"always"}}:Hash')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary: "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[54]||(a[54]=k(`<p>You will notice that it parses correctly, but instead of our result we end up getting a giant hash of data that doesn&#39;t seem to parse correctly. We need to convert the hash into an object that appears like other objects so that we may use our dot notation. So we will wrap our hash in a Ruby class called a <code>Hashie::Mash</code>. This gives us a quick way to convert a hash into a Ruby object with a number of methods attached to it. You will have to import the Hashie library by running <code>gem install hashie</code> and import it in the resource file to be used. It and is written as follows:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># encoding: utf-8</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># copyright: 2019, The Authors</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">require </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;hashie/mash&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> DockerComposeConfig</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;docker_compose_config&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    @yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(path)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> services</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    Hashie</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">::</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Mash</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">@yaml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;services&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Lets run the profile again.</p>`,3)),h(t,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:n})=>[...a[40]||(a[40]=[s("Command",-1)])]),title1:e(({value:l,isActive:n})=>[...a[41]||(a[41]=[s("Output",-1)])]),tab0:e(({value:l,isActive:n})=>[...a[42]||(a[42]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-workstations")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:n})=>[...a[43]||(a[43]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (docker-workstations)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," bdf4338d-8fb0-5ca6-a949-ced198781ad5")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  YAML"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker-compose.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"operatingsystem",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"services"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"nginx",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "image"]'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  docker_compose_config")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  services.operatingsystem.image"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "redhat/ubi9"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  services.nginx.image"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," =="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "nginx:latest"')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[55]||(a[55]=i("p",null,"Everything passed!",-1))])}const v=d(c,[["render",F]]),C=JSON.parse(`{"path":"/courses/advanced/06.html","title":"6. Create a Custom Resource - The Docker Example","lang":"en-US","frontmatter":{"order":6,"next":"07.md","title":"6. Create a Custom Resource - The Docker Example","author":"Aaron Lippold","headerDepth":3,"toc":{"levels":[2,5]},"description":"Custom Resource - Docker Let's try a more complicated example by creating a resource that can parse a Docker Compose file. If you've ever deployed containerized applications bef...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"6. Create a Custom Resource - The Docker Example\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-09T16:39:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron Lippold\\"}]}"],["meta",{"property":"og:url","content":"https://mitre.github.io/saf-training/saf-training/courses/advanced/06.html"}],["meta",{"property":"og:site_name","content":"MITRE SAF Training"}],["meta",{"property":"og:title","content":"6. Create a Custom Resource - The Docker Example"}],["meta",{"property":"og:description","content":"Custom Resource - Docker Let's try a more complicated example by creating a resource that can parse a Docker Compose file. If you've ever deployed containerized applications bef..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-12-09T16:39:22.000Z"}],["meta",{"property":"article:author","content":"Aaron Lippold"}],["meta",{"property":"article:modified_time","content":"2024-12-09T16:39:22.000Z"}]]},"git":{"createdTime":1656449910000,"updatedTime":1733762362000,"contributors":[{"name":"Emily Rodriguez","username":"","email":"ecrodriguez@mm279976-pc.lan","commits":5},{"name":"wdower","username":"wdower","email":"57142072+wdower@users.noreply.github.com","commits":3,"url":"https://github.com/wdower"},{"name":"Will Dower","username":"","email":"wdow95@hotmail.com","commits":1},{"name":"Aaron Lippold","username":"","email":"lippold@gmail.com","commits":2},{"name":"Will","username":"Will","email":"will@dower.dev","commits":1,"url":"https://github.com/Will"},{"name":"Amndeep Singh Mann","username":"","email":"amann@mitre.org","commits":1}]},"readingTime":{"minutes":7.29,"words":2186},"filePathRelative":"courses/advanced/06.md","autoDesc":true}`);export{v as comp,C as data};
