import{_ as i}from"./plugin-vue_export-helper.21dcd24c.js";import{r as o,o as l,c,a as s,b as a,F as r,e as n,d as t}from"./app.3b4d192a.js";var p="/saf-training/assets/Download_STIG_Viewer.8ba59eda.png",d="/saf-training/assets/Download_STIG.e9934a52.png";const u={},k=s("h2",{id:"from-stig-to-profile",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#from-stig-to-profile","aria-hidden":"true"},"#"),n(" From STIG to Profile")],-1),v=s("h3",{id:"download-stig-requirements",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#download-stig-requirements","aria-hidden":"true"},"#"),n(" Download STIG Requirements")],-1),m=n("Download the latest STIG Viewer located here "),h={href:"https://public.cyber.mil/stigs/srg-stig-tools/",target:"_blank",rel:"noopener noreferrer"},b=n("STIG Viewer"),g=s("p",null,[s("img",{src:p,alt:"Alt text",loading:"lazy"})],-1),f=n("Download the "),_=s("code",null,"Red Hat Enterprise Linux 8 STIG - Ver 1, Rel 5",-1),y=n(" located here "),w={href:"https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",target:"_blank",rel:"noopener noreferrer"},S=n("RHEL8 STIG Download"),I=t('<p><img src="'+d+`" alt="Alt text" loading="lazy"></p><h3 id="convert-the-stig-xccdf-benchmark-to-an-inspec-stubs-profile" tabindex="-1"><a class="header-anchor" href="#convert-the-stig-xccdf-benchmark-to-an-inspec-stubs-profile" aria-hidden="true">#</a> Convert the STIG XCCDF Benchmark To an InSpec Stubs Profile</h3><div class="custom-container note"><p class="custom-container-title">Timesaver Ahead!</p><p>We already converted the XCCDF STIG Benchmark into a starter profile using the <code>saf generate xccdf2inspec_stub</code> command using the correct flags, mapping file and other options.</p></div><p>The SAF CLI has the <code>generate xccdf2inspec_stub</code> sub-command which can help you quickly convert an XCCDF Benchmark document into the start of an InSpec Profile.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>XCCDF to InSpec Stub
generate xccdf2inspec_stub              Generate an InSpec profile stub from a DISA STIG XCCDF XML <span class="token function">file</span>

  USAGE
    $ saf generate xccdf2inspec_stub -i, --input<span class="token operator">=</span>XML -o, --output<span class="token operator">=</span>FOLDER

  OPTIONS
    -S, --useStigID              Use STIG IDs <span class="token punctuation">(</span><span class="token operator">&lt;</span>Group/Rule/Version<span class="token operator">&gt;</span><span class="token punctuation">)</span> instead of Group IDs <span class="token punctuation">(</span>ex. <span class="token string">&#39;V-XXXXX&#39;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> InSpec Control IDs
    -i, --input<span class="token operator">=</span>input            <span class="token punctuation">(</span>required<span class="token punctuation">)</span> Path to the DISA STIG XCCDF <span class="token function">file</span>
    -l, --lineLength<span class="token operator">=</span>lineLength  <span class="token punctuation">[</span>default: <span class="token number">80</span><span class="token punctuation">]</span> Characters between lines within InSpec controls
    -e, --encodingHeader         Add the <span class="token string">&quot;# encoding: UTF-8&quot;</span> comment at the <span class="token function">top</span> of each control
    -m, --metadata<span class="token operator">=</span>metadata      Path to a JSON <span class="token function">file</span> with additional metadata <span class="token keyword">for</span> the inspec.yml <span class="token function">file</span>
    -o, --output<span class="token operator">=</span>output          <span class="token punctuation">(</span>required<span class="token punctuation">)</span> <span class="token punctuation">[</span>default: profile<span class="token punctuation">]</span>
    -r, --useVulnerabilityId     Use Vulnerability IDs <span class="token punctuation">(</span>ex. <span class="token string">&#39;SV-XXXXX&#39;</span><span class="token punctuation">)</span> instead of Group IDs <span class="token punctuation">(</span>ex. <span class="token string">&#39;V-XXXXX&#39;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> InSpec control IDs
    -s, --singleFile             Output the resulting controls as a single <span class="token function">file</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),x=n("To learn how you can use the "),q=s("code",null,"saf generate xccdf2stub",-1),C=n(", go to the saf-cli homepage which has all the options and capabilities as well as all the other utilities provided by the saf-cli, at "),V={href:"https://saf-cli.mitre.org/#generate",target:"_blank",rel:"noopener noreferrer"},T=n("https://saf-cli.mitre.org/#generate"),D=n("."),G=t(`<h3 id="example-stub-control-sv-230502" tabindex="-1"><a class="header-anchor" href="#example-stub-control-sv-230502" aria-hidden="true">#</a> Example &#39;Stub&#39; Control SV-230502</h3><p>Let&#39;s take a look at what one of the <code>stubs</code> created by the <code>saf-cli generate xccdf2stub</code> command:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">&#39;SV-230502&#39;</span></span> <span class="token keyword">do</span>
  title <span class="token string-literal"><span class="token string">&#39;The RHEL 8 file system automounter must be disabled unless required.&#39;</span></span>
  desc  &quot;Automatically mounting file systems permits easy introduction of
unknown devices<span class="token punctuation">,</span> thereby facilitating malicious activity<span class="token punctuation">.</span>&quot;
  desc  <span class="token string-literal"><span class="token string">&#39;rationale&#39;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&#39;&#39;</span></span>
  desc  <span class="token string-literal"><span class="token string">&#39;check&#39;</span></span><span class="token punctuation">,</span> &quot;
    Verify the operating system disables the ability to automount devices<span class="token punctuation">.</span>

    Check to see <span class="token keyword">if</span> automounter service is active with the following command<span class="token operator">:</span>

    <span class="token symbol">Note</span><span class="token operator">:</span> If the autofs service is <span class="token keyword">not</span> installed<span class="token punctuation">,</span> this requirement is <span class="token keyword">not</span>
applicable<span class="token punctuation">.</span>

    $ sudo systemctl status autofs

    autofs<span class="token punctuation">.</span>service <span class="token operator">-</span> Automounts filesystems on demand
    <span class="token symbol">Loaded</span><span class="token operator">:</span> loaded <span class="token punctuation">(</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>systemd<span class="token operator">/</span>system<span class="token operator">/</span>autofs<span class="token punctuation">.</span>service<span class="token punctuation">;</span> disabled<span class="token punctuation">)</span>
    <span class="token symbol">Active</span><span class="token operator">:</span> inactive <span class="token punctuation">(</span>dead<span class="token punctuation">)</span>

    If the \\&quot;autofs\\&quot; status is set to \\&quot;active\\&quot; <span class="token keyword">and</span> is <span class="token keyword">not</span> documented with
the Information System Security Officer <span class="token punctuation">(</span><span class="token constant">ISSO</span><span class="token punctuation">)</span> as an operational requirement<span class="token punctuation">,</span>
this is a finding<span class="token punctuation">.</span>
  &quot;
  desc <span class="token string-literal"><span class="token string">&#39;fix&#39;</span></span><span class="token punctuation">,</span> &quot;
    Configure the operating system to disable the ability to automount devices<span class="token punctuation">.</span>

    Turn off the automount service with the following commands<span class="token operator">:</span>

    $ sudo systemctl stop autofs
    $ sudo systemctl disable autofs

    If \\&quot;autofs\\&quot; is required <span class="token keyword">for</span> Network <span class="token builtin">File</span> System <span class="token punctuation">(</span><span class="token constant">NFS</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it must be
documented with the <span class="token constant">ISSO</span><span class="token punctuation">.</span>
  &quot;
  impact <span class="token number">0.5</span>
  tag severity<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;medium&#39;</span></span>
  tag gtitle<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;SRG-OS-000114-GPOS-00059&#39;</span></span>
  tag gid<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;V-230502&#39;</span></span>
  tag rid<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;SV-230502r627750_rule&#39;</span></span>
  tag stig_id<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;RHEL-08-040070&#39;</span></span>
  tag fix_id<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;F-33146r568253_fix&#39;</span></span>
  tag cci<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;CCI-000778&#39;</span></span><span class="token punctuation">]</span>
  tag nist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;IA-3&#39;</span></span><span class="token punctuation">]</span>

  <span class="token comment"># ...add your describe blocks here ... #</span>

<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="completed-sv-230502-control" tabindex="-1"><a class="header-anchor" href="#completed-sv-230502-control" aria-hidden="true">#</a> Completed SV-230502 Control</h3><p>Let&#39;s take a look at how we would write the InSpec control for SV-230502:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">&#39;SV-230502&#39;</span></span> <span class="token keyword">do</span>
  title <span class="token string-literal"><span class="token string">&#39;The RHEL 8 file system automounter must be disabled unless required.&#39;</span></span>
  desc  &quot;Automatically mounting file systems permits easy introduction of
unknown devices<span class="token punctuation">,</span> thereby facilitating malicious activity<span class="token punctuation">.</span>&quot;
  desc  <span class="token string-literal"><span class="token string">&#39;rationale&#39;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&#39;&#39;</span></span>
  desc  <span class="token string-literal"><span class="token string">&#39;check&#39;</span></span><span class="token punctuation">,</span> &quot;
    Verify the operating system disables the ability to automount devices<span class="token punctuation">.</span>

    Check to see <span class="token keyword">if</span> automounter service is active with the following command<span class="token operator">:</span>

    <span class="token symbol">Note</span><span class="token operator">:</span> If the autofs service is <span class="token keyword">not</span> installed<span class="token punctuation">,</span> this requirement is <span class="token keyword">not</span>
applicable<span class="token punctuation">.</span>

    $ sudo systemctl status autofs

    autofs<span class="token punctuation">.</span>service <span class="token operator">-</span> Automounts filesystems on demand
    <span class="token symbol">Loaded</span><span class="token operator">:</span> loaded <span class="token punctuation">(</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>systemd<span class="token operator">/</span>system<span class="token operator">/</span>autofs<span class="token punctuation">.</span>service<span class="token punctuation">;</span> disabled<span class="token punctuation">)</span>
    <span class="token symbol">Active</span><span class="token operator">:</span> inactive <span class="token punctuation">(</span>dead<span class="token punctuation">)</span>

    If the \\&quot;autofs\\&quot; status is set to \\&quot;active\\&quot; <span class="token keyword">and</span> is <span class="token keyword">not</span> documented with
the Information System Security Officer <span class="token punctuation">(</span><span class="token constant">ISSO</span><span class="token punctuation">)</span> as an operational requirement<span class="token punctuation">,</span>
this is a finding<span class="token punctuation">.</span>
  &quot;
  desc <span class="token string-literal"><span class="token string">&#39;fix&#39;</span></span><span class="token punctuation">,</span> &quot;
    Configure the operating system to disable the ability to automount devices<span class="token punctuation">.</span>

    Turn off the automount service with the following commands<span class="token operator">:</span>

    $ sudo systemctl stop autofs
    $ sudo systemctl disable autofs

    If \\&quot;autofs\\&quot; is required <span class="token keyword">for</span> Network <span class="token builtin">File</span> System <span class="token punctuation">(</span><span class="token constant">NFS</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it must be
documented with the <span class="token constant">ISSO</span><span class="token punctuation">.</span>
  &quot;
  impact <span class="token number">0.5</span>
  tag severity<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;medium&#39;</span></span>
  tag gtitle<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;SRG-OS-000114-GPOS-00059&#39;</span></span>
  tag gid<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;V-230502&#39;</span></span>
  tag rid<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;SV-230502r627750_rule&#39;</span></span>
  tag stig_id<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;RHEL-08-040070&#39;</span></span>
  tag fix_id<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;F-33146r568253_fix&#39;</span></span>
  tag cci<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;CCI-000778&#39;</span></span><span class="token punctuation">]</span>
  tag nist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;IA-3&#39;</span></span><span class="token punctuation">]</span>

  <span class="token keyword">if</span> virtualization<span class="token punctuation">.</span>system<span class="token punctuation">.</span>eql<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;docker&#39;</span></span><span class="token punctuation">)</span>
    impact <span class="token number">0.0</span>
    describe <span class="token string-literal"><span class="token string">&quot;Control not applicable within a container&quot;</span></span> <span class="token keyword">do</span>
      skip <span class="token string-literal"><span class="token string">&quot;Control not applicable within a container&quot;</span></span>
    <span class="token keyword">end</span>
  <span class="token keyword">else</span>
    <span class="token keyword">if</span> package<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;autofs&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>installed<span class="token operator">?</span>
      describe systemd_service<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;autofs.service&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
        it <span class="token punctuation">{</span> should_not be_running <span class="token punctuation">}</span>
        it <span class="token punctuation">{</span> should_not be_enabled <span class="token punctuation">}</span>
        it <span class="token punctuation">{</span> should_not be_installed <span class="token punctuation">}</span>
      <span class="token keyword">end</span>
    <span class="token keyword">else</span>
      impact <span class="token number">0.0</span>
      describe <span class="token string-literal"><span class="token string">&#39;The autofs service is not installed&#39;</span></span> <span class="token keyword">do</span>
        skip <span class="token string-literal"><span class="token string">&#39;The autofs service is not installed, this control is Not Applicable.&#39;</span></span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="getting-started-on-the-rhel8-baseline" tabindex="-1"><a class="header-anchor" href="#getting-started-on-the-rhel8-baseline" aria-hidden="true">#</a> Getting Started on the RHEL8 Baseline</h3><h4 id="controls-we-will-demonstrate" tabindex="-1"><a class="header-anchor" href="#controls-we-will-demonstrate" aria-hidden="true">#</a> Controls We Will Demonstrate</h4><ul><li>SV-230324 &lt;---login_defs resource</li><li>SV-230250 &lt;---directory resource</li><li>SV-230243 &lt;---directory looping &amp; file resource</li><li>SV-230505 &lt;---non applicable use case &amp; package resource</li></ul><h4 id="suggested-level-1-controls" tabindex="-1"><a class="header-anchor" href="#suggested-level-1-controls" aria-hidden="true">#</a> Suggested Level 1 Controls</h4><ul><li>SV-230383 &lt;---login_defs resource</li><li>SV-230249 &lt;---directory resource</li><li>SV-230242 &lt;---directory looping &amp; file resource</li><li>SV-230241 &lt;---non applicable use case &amp; package resource</li></ul><h4 id="suggested-level-2-controls" tabindex="-1"><a class="header-anchor" href="#suggested-level-2-controls" aria-hidden="true">#</a> Suggested Level 2 Controls</h4><ul><li>SV-230281 &lt;---parse config file</li><li>SV-230365 &lt;---login_defs resource</li><li>SV-230264 &lt;---file content</li></ul><h4 id="suggested-inspec-resources-to-review" tabindex="-1"><a class="header-anchor" href="#suggested-inspec-resources-to-review" aria-hidden="true">#</a> Suggested InSpec Resources to Review</h4>`,14),L={href:"https://www.inspec.io/docs/reference/resources/command/",target:"_blank",rel:"noopener noreferrer"},X=n("command"),A={href:"https://www.inspec.io/docs/reference/resources/file/",target:"_blank",rel:"noopener noreferrer"},F=n("file"),R={href:"https://www.inspec.io/docs/reference/resources/directory/",target:"_blank",rel:"noopener noreferrer"},E=n("directory"),O={href:"https://www.inspec.io/docs/reference/resources/parse_config_file/",target:"_blank",rel:"noopener noreferrer"},N=n("parse_config_file"),H={href:"https://www.inspec.io/docs/reference/resources/package/",target:"_blank",rel:"noopener noreferrer"},P=n("package"),B={href:"https://docs.chef.io/inspec/resources/login_defs/",target:"_blank",rel:"noopener noreferrer"},$=n("login_defs"),U=s("h3",{id:"completed-rhel8-profile-for-reference",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#completed-rhel8-profile-for-reference","aria-hidden":"true"},"#"),n(" Completed RHEL8 Profile for Reference")],-1),z=s("p",null,"Below is the url to the completed RHEL8 Inspec Profile for reference, and a few things to take note of.",-1),M={href:"https://github.com/CMSgov/redhat-enterprise-linux-8-stig-baseline",target:"_blank",rel:"noopener noreferrer"},W=n("redhat-enterprise-linux-8-stig-baseline"),J=s("div",{class:"custom-container tip"},[s("p",{class:"custom-container-title"},"Key Elements in this Profile"),s("ul",null,[s("li",null,[n("The use of "),s("code",null,"impact 0"),n(" for NA & Container Aware Controls")]),s("li",null,[n("How we make the controls "),s("code",null,"container aware"),n(", and")]),s("li",null,[n("The "),s("code",null,"fail fast"),n(" approach to testing execution.")])])],-1);function K(j,Q){const e=o("ExternalLinkIcon");return l(),c(r,null,[k,v,s("p",null,[m,s("a",h,[b,a(e)])]),g,s("p",null,[f,_,y,s("a",w,[S,a(e)])]),I,s("p",null,[x,q,C,s("a",V,[T,a(e)]),D]),G,s("ul",null,[s("li",null,[s("a",L,[X,a(e)])]),s("li",null,[s("a",A,[F,a(e)])]),s("li",null,[s("a",R,[E,a(e)])]),s("li",null,[s("a",O,[N,a(e)])]),s("li",null,[s("a",H,[P,a(e)])]),s("li",null,[s("a",B,[$,a(e)])])]),U,z,s("ol",null,[s("li",null,[s("a",M,[W,a(e)])])]),J],64)}var ss=i(u,[["render",K],["__file","10.html.vue"]]);export{ss as default};
