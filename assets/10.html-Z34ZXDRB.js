import{_ as s}from"./SAF_Site_Harden-CbpHnNj7.js";import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as e,o as t}from"./app-CUwJYUKO.js";const l="/saf-training/assets/SAF_Capabilities_Harden-DdoBMvWM.png",h="/saf-training/assets/Codespaces_Hardening_Files-CbcSEr1o.png",r={};function p(d,i){return t(),n("div",null,[...i[0]||(i[0]=[e('<h2 id="_10-1-from-plan-to-validate-to-visualize-to-harden" tabindex="-1"><a class="header-anchor" href="#_10-1-from-plan-to-validate-to-visualize-to-harden"><span>10.1 From &quot;Plan&quot; to &quot;Validate&quot; to &quot;Visualize&quot; to &quot;Harden&quot;</span></a></h2><p>Finally! We get to secure the software. After starting with a plan, and then seeing the requirements and current state through validation and visualization, let&#39;s harden the component and re-validate it after the changes.</p><figure><img src="'+l+'" alt="The Harden Capability" tabindex="0" loading="lazy"><figcaption>The Harden Capability</figcaption></figure><h2 id="_10-2-find-the-hardening-content" tabindex="-1"><a class="header-anchor" href="#_10-2-find-the-hardening-content"><span>10.2 Find the hardening content</span></a></h2><p>Remember when you perused the hardening content on the SAF site when we talked about the &quot;Plan&quot; pillar? This is where we will find automated content for configuring a software component to some guidance. In this case, we will use the NGINX STIG-ready Content on the <a href="https://saf.mitre.org/#/harden" target="_blank" rel="noopener noreferrer">SAF Hardening page</a>.</p><figure><img src="'+s+'" alt="The SAF Hardening page" tabindex="0" loading="lazy"><figcaption>The SAF Hardening page</figcaption></figure><p>You could peruse this <a href="https://github.com/mitre/ansible-nginx-stigready-hardening" target="_blank" rel="noopener noreferrer">GitHub repository</a>, including the README and inputs to find out more information, but for this training, we have put any preparation needed for running this hardening content into a pre-script.</p><h2 id="_10-3-prepare-your-codespaces-to-run-the-hardening-script" tabindex="-1"><a class="header-anchor" href="#_10-3-prepare-your-codespaces-to-run-the-hardening-script"><span>10.3 Prepare your Codespaces to run the hardening script</span></a></h2><p>Just like we saw some requirements for running an InSpec scan, there are also some requirements to run the hardening script on the NGINX container in your Codespaces. We are going to run another setup script for those.</p><p>In your Codespace terminal from your main workspace directory, run the following commands:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./install-nginxHardeningTools.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This command will make sure that the NGINX docker container has the required software dependencies such as Python to run the Ansible hardening content. This script also downloads the hardening content locally. Unlike the InSpec scan, we will run the hardening content from a local folder rather than from GitHub. Therefore, you should see the <code>ansible-nginx-stigready-hardening</code> folder in your files when the script completes.</p><figure><img src="'+h+`" alt="After Running the Hardening Tools Script" tabindex="0" loading="lazy"><figcaption>After Running the Hardening Tools Script</figcaption></figure><h2 id="_10-4-cli-results-of-hardening-script" tabindex="-1"><a class="header-anchor" href="#_10-4-cli-results-of-hardening-script"><span>10.4 CLI Results of Hardening Script</span></a></h2><p>Run this command:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ansible-playbook</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hosts.yml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hardening-playbook.yml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You should see the following results from the hardening script. If you run this hardening content multiple times, the numbers in the results may be different because the starting configuration will be different and the script will not have to change the same numbers of settings.</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ansible-playbook</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hosts.yml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hardening-playbook.yml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[WARNING]: Ansible is being run in a world writable directory (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/workspaces/saf-training-lab-environment/ansible-nginx-stigready-hardening</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), ignoring</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> an</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ansible.cfg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> source.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> For</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> more</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> information</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> see</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://docs.ansible.com/ansible/devel/reference_appendices/config.html#cfg-in-world-writable-</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dir</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PLAY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [all] ******************************************************************************************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TASK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [Gathering </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Facts]</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ******************************************************************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ok:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [docker]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TASK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [../ansible-nginx-stigready-hardening </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Ensure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/usr/sbin/nginx&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> worldwide</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> writeable]</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *******************************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changed:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [docker]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TASK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [../ansible-nginx-stigready-hardening </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Generate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/C=US/O=U.S. Government/OU=DoD/CN=DoD&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> self-signed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> certificate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key]</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ****************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changed:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [docker]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TASK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [../ansible-nginx-stigready-hardening </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Ensure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> private</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> only</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> readable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;root&#39;]</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *****************************************************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changed:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [docker]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TASK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [../ansible-nginx-stigready-hardening </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Ensure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> crt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> should</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> only</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> readable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;root&#39;]</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ******************************************************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changed:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [docker]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">TASK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [../ansible-nginx-stigready-hardening </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Post</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Task]</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *********************************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changed:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [docker]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PLAY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RECAP</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ******************************************************************************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ok=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   changed=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">35</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   unreachable=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    failed=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    skipped=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    rescued=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    ignored=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,18)])])}const c=a(r,[["render",p]]),u=JSON.parse('{"path":"/courses/user/10.html","title":"10. Harden","lang":"en-US","frontmatter":{"order":10,"next":"11.md","title":"10. Harden","author":"Aaron Lippold","headerDepth":3,"toc":{"levels":[2,5]},"description":"10.1 From \\"Plan\\" to \\"Validate\\" to \\"Visualize\\" to \\"Harden\\" Finally! We get to secure the software. After starting with a plan, and then seeing the requirements and current state ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"10. Harden\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-02T21:27:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron Lippold\\"}]}"],["meta",{"property":"og:url","content":"https://mitre.github.io/saf-training/saf-training/courses/user/10.html"}],["meta",{"property":"og:site_name","content":"MITRE SAF Training"}],["meta",{"property":"og:title","content":"10. Harden"}],["meta",{"property":"og:description","content":"10.1 From \\"Plan\\" to \\"Validate\\" to \\"Visualize\\" to \\"Harden\\" Finally! We get to secure the software. After starting with a plan, and then seeing the requirements and current state ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-12-02T21:27:28.000Z"}],["meta",{"property":"article:author","content":"Aaron Lippold"}],["meta",{"property":"article:modified_time","content":"2024-12-02T21:27:28.000Z"}]]},"git":{"createdTime":1656525471000,"updatedTime":1733174848000,"contributors":[{"name":"Emily Rodriguez","username":"","email":"ecrodriguez@mm279976-pc.lan","commits":11},{"name":"em-c-rod","username":"em-c-rod","email":"32680215+em-c-rod@users.noreply.github.com","commits":1,"url":"https://github.com/em-c-rod"},{"name":"wdower","username":"wdower","email":"will@dower.dev","commits":2,"url":"https://github.com/wdower"},{"name":"Aaron Lippold","username":"","email":"lippold@gmail.com","commits":2},{"name":"Shivani Karikar","username":"","email":"karikarshivani@gmail.com","commits":1},{"name":"Will","username":"Will","email":"will@dower.dev","commits":1,"url":"https://github.com/Will"},{"name":"dependabot[bot]","username":"dependabot[bot]","email":"49699333+dependabot[bot]@users.noreply.github.com","commits":1,"url":"https://github.com/dependabot[bot]"},{"name":"p-oneil","username":"p-oneil","email":"poneil@mitre.org","commits":1,"url":"https://github.com/p-oneil"}]},"readingTime":{"minutes":1.7,"words":510},"filePathRelative":"courses/user/10.md","autoDesc":true}');export{c as comp,u as data};
