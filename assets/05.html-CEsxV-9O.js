import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as d,b as i,d as h,a as k,e as s,w as e,r as p,o as g}from"./app-CUwJYUKO.js";const c={};function o(A,a){const n=p("CodeTabs");return g(),d("div",null,[a[40]||(a[40]=i("p",null,[s("Let's practice creating our own custom resource. Suppose we want to write tests that examine the current state of a local Git repository. We will create a "),i("code",null,"git"),s(" resource that can handle all of InSpec's interactions with a Git repo under the hood, allowing us to focus on writing clean and easy-to-read code within a control.")],-1)),a[41]||(a[41]=i("h3",{id:"create-a-new-inspec-profile",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#create-a-new-inspec-profile"},[i("span",null,"Create a New InSpec Profile")])],-1)),a[42]||(a[42]=i("p",null,"Let's start by creating a new profile:",-1)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[0]||(a[0]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[1]||(a[1]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[2]||(a[2]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," init"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," profile"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[3]||(a[3]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," ───────────────────────────"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Code"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Generator"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ───────────────────────────"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," new"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," profile"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," at"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/my_git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," inspec.yml")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," directory"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/my_git/controls")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls/example.rb")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," •"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Creating"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," README.md")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[43]||(a[43]=k('<h3 id="develop-example-use-case-tests" tabindex="-1"><a class="header-anchor" href="#develop-example-use-case-tests"><span>Develop Example Use-case Tests</span></a></h3><p>To write resources, we first need to know what we are testing! In your Codespaces environment, there is a git repository that we will test under the <code>resources</code> folder. The git repository will be the test target, similarly to how the docker containers acted as test targets in previous sections. Unzip the target git repository using the following command:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resources/git_test_target.tar.gz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This will generate a <code>git_test_target</code> repository which we will use for these examples.</p><p>Now let&#39;s write some tests and confirm that they run. You can put these tests in the <code>example.rb</code> file generated in the <code>controls</code> folder of your <code>my_git</code> InSpec profile. These tests are written using the <code>command</code> resource which is provided by InSpec. We will write a <code>git</code> resource in this section to improve this test.</p><div class="hint-container note"><p class="hint-container-title">Inputs review</p><p>The <code>git_dir</code> input will be used in our profile. It needs to contain the path of the <code>.git</code> folder you are assessing. Usually, you&#39;d want to put a default location for that input in your <code>inspec.yml</code>, such as <code>./.git</code>, that the user of your profile could overwrite with an inputfile, but for expediency&#39;s sake we&#39;re going to hardcode it to the <code>.git</code> folder inside of your <code>git_test_target</code> repository. The value in the codeblock below should be correct, but it&#39;s always good to doublecheck by using the <code>cd</code> command to navigate inside of the <code>.git</code> folder in the <code>git_test_target</code> repository and then using the <code>pwd</code> command to get the full path.</p></div>',6)),h(n,{data:[{id:"inspec.yml"},{id:"example.rb"}]},{title0:e(({value:l,isActive:t})=>[...a[4]||(a[4]=[s("inspec.yml",-1)])]),title1:e(({value:l,isActive:t})=>[...a[5]||(a[5]=[s("example.rb",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[6]||(a[6]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"my_git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"title"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"InSpec Profile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"maintainer"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"The Authors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"copyright"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"The Authors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"copyright_email"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"you@example.com")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"license"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Apache-2.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"summary"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"An InSpec Compliance Profile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"version"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"supports"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"  platform"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"os")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"inputs"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"git_dir")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"String")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"/workspaces/saf-training-lab-environment/git_test_target/.git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[7]||(a[7]=[i("div",{class:"language-ruby line-numbers-mode","data-highlighter":"shiki","data-ext":"ruby",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-ruby"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"git_dir"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}}," ="),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," input"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'git_dir'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# The following branches should exist")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"git --git-dir '),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"#{"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"git_dir"),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"}"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},` branch --format='%(refname:short)'"`),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"stdout"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"lines"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"map"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"&"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},":"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#56B6C2"}},"strip"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it { should "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 'main'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"git --git-dir '),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"#{"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"git_dir"),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"}"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},` branch --format='%(refname:short)'"`),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"stdout"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"lines"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"map"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"&"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},":"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#56B6C2"}},"strip"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it { should "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 'testBranch'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# What is the current branch")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"git --git-dir '),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"#{"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"git_dir"),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"}"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' branch --show-current"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"stdout"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"."),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"strip"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}}," do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  it { should eq "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'main'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# What is the latest commit")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"git --git-dir '),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"#{"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"git_dir"),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"}"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},` log -1 --pretty=format:'%h'"`),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  its"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'stdout'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") { should match "),i("span",{style:{"--shiki-light":"#0184BC","--shiki-dark":"#E06C75"}},"/7a748c6/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# What is the second to last commit")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"describe "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"command"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"git --git-dir '),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"#{"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#ABB2BF"}},"git_dir"),i("span",{style:{"--shiki-light":"#CA1243","--shiki-dark":"#C678DD"}},"}"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},` log --skip=1 -1 --pretty=format:'%h'"`),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  its"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'stdout'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},") { should match "),i("span",{style:{"--shiki-light":"#0184BC","--shiki-dark":"#E06C75"}},"/edc207f/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"end")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[8]||(a[8]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[9]||(a[9]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[10]||(a[10]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[11]||(a[11]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"main"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"testBranch"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"main"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"testBranch"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "testBranch"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  main")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --git-dir"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/git_test_target/.git log "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"-1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --pretty=format:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  stdout"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," match"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /7a748c6/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --git-dir"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/git_test_target/.git log "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"--skip=1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --pretty=format:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  stdout"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," match"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /edc207f/")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 5"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[44]||(a[44]=k(`<p>Our tests pass, but they all use the <code>command</code> resource. It&#39;s not best practice to do this -- for one thing, it makes our tests more complicated, and the output too long.</p><div class="hint-container warning"><p class="hint-container-title">But What If I Don&#39;t Care About The Tests Being Complicated And The Output Being Too Long?</p><p>Some test writers like to wrap their favorite bash commands in a <code>command</code> block and call it a day.<br> However, best practice is to write clean and maintainable InSpec code even if you yourself have no trouble using the <code>command</code> resource to do everything.</p><p>Recall that other developers and assessors need to be able to understand how your tests function. Nobody likes trying to debug someone else&#39;s profile that assumes that the operator knows exactly how the profile writer&#39;s favorite terminal commands work.</p></div><p>Let&#39;s rewrite these tests in a way that abstracts away the complexity of working with the <code>git</code> command into a resource.</p><h3 id="rewrite-a-test" tabindex="-1"><a class="header-anchor" href="#rewrite-a-test"><span>Rewrite a Test</span></a></h3><p>Let&#39;s rewrite the first test in our example file to make it more readable by inventing a <code>git</code> resource that can simplify our test as follows:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The following branches should exist</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(git_dir) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;branches&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;main&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now let&#39;s run the profile.</p>`,7)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[12]||(a[12]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[13]||(a[13]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[14]||(a[14]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[15]||(a[15]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"[2023-02-22T03:21:41+00:00] ERROR: Failed to load profile my_git: Failed to load source "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"for"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," controls/example.rb: undefined method "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"`"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git' for #<Inspec::ControlEvalContext:0x000000000540af38>")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:         InSpec Profile (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:         0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Failure Message: Failed to load source for controls/example.rb: undefined method `git'"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for "),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"#<Inspec::ControlEvalContext:0x000000000540af38>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"          local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:       6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     No"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," tests executed.")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary: "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures, "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[45]||(a[45]=k(`<p>We should get an error because the git method and resource are not defined yet. We should fix that.</p><h3 id="develop-the-git-resource" tabindex="-1"><a class="header-anchor" href="#develop-the-git-resource"><span>Develop the git resource</span></a></h3><p>Let&#39;s start by creating a new file called <code>git.rb</code> in the <code>libraries</code> directory. If you do not already have a <code>libraries</code> directory, you can make one in the <code>my_git</code> InSpec profile directory. The content of the file should look like this:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Git</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;git&#39;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This is - technically - a valid resource! It was very easy to write, but it is not particularly useful for testing. Let&#39;s run our tests again to see why not.</p><div class="hint-container tip"><p class="hint-container-title">Setting Up a Resource Using InSpec Init</p><p>Instead of just creating the <code>git.rb</code> file in the <code>libraries</code> directory, you can use InSpec to assist you in creating a resource. Run <code>inspec init resource &lt;your-resource-name&gt;</code> and follow the prompts to create the foundation and see examples for a resource.</p></div><p>Run the profile again.</p>`,7)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[16]||(a[16]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[17]||(a[17]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[18]||(a[18]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[19]||(a[19]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"[2023-02-22T03:25:57+00:00] ERROR: Failed to load profile my_git: Failed to load source "),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},"for"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," controls/example.rb: wrong number of arguments ("),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"given"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 1,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"         InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"         0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Failure"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Message:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Failed"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," load"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," source"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," for"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls/example.rb:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," wrong"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," number"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," of"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," arguments"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (given "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"1,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"          local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"       6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     No"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," tests"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," executed.")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[46]||(a[46]=k(`<p>This time we get another error letting us know that we have a resource that has been given the incorrect number of arguments. This means we have given an additional parameter to this resource that we have not yet accepted.</p><p>Each resource will require an initialization method.</p><p>For our git.rb file let&#39;s add that initialization method:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Git</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;git&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This is saving the path we are passing in from the control into an instance method called <code>path</code>.</p><p>Now when we run the profile:</p>`,6)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[20]||(a[20]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[21]||(a[21]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[22]||(a[22]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[23]||(a[23]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  branches"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," method"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"branches' for #<#<Class:0x00000000041485a8>:0x00000000043620c8>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},'  ["main", "testBranch"]')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},'     ✔  is expected to include "testBranch"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  main")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},'     ✔  is expected to eq "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command: `git --git-dir /workspaces/saf-training-lab-environment/git_test_target/.git log -1 --pretty=format:'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔  stdout is expected to match /7a748c6/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command: `git --git-dir /workspaces/saf-training-lab-environment/git_test_target/.git log --skip=1 -1 --pretty=format:'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔  stdout is expected to match /edc207f/")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test Summary: 4 successful, 1 failure, 0 skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[47]||(a[47]=k(`<p>The test will run but we will get an error saying we do not have a <code>branches</code> method. Remember that the other 4 tests are still passing because they are not yet using the <code>git</code> resource, but are still relying on InSpec&#39;s <code>command</code> resource.</p><p>Let&#39;s go back to our git.rb file to fix that by adding a <code>branches</code> method:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Git</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;git&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> branches</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We have now defined the branches method. Let&#39;s see what the test output shows us.</p>`,4)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[24]||(a[24]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[25]||(a[25]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[26]||(a[26]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[27]||(a[27]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  branches"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," nil"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main",'),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," but"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," it"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," does"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," respond"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"include?"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"main"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},", "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"testBranch"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "testBranch"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  main")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --git-dir"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/git_test_target/.git log "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"-1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --pretty=format:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  stdout"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," match"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /7a748c6/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --git-dir"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/git_test_target/.git log "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"--skip=1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --pretty=format:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  stdout"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," match"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /edc207f/")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 4"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failure,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[48]||(a[48]=k(`<p>Now the error message says that the <code>branches</code> method is returning a null value which is a problem because it actually needs to return something, like an array, that implements the predicate method <code>include?</code>. A predicate method is one that evaluates a condition, in this case whether a given branch is &quot;included&quot; in the set of branches, and returns true or false accordingly.</p><p>To resolve this problem, we can use the <code>inspec</code> helper method to invoke the built-in <code>command</code> resource to extract this data as shown below:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Git</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;git&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> branches</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;git --git-dir </span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">#{</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">@</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">path</span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch --format=&#39;%(refname:short)&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stdout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lines</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">map</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">:</span><span style="--shiki-light:#986801;--shiki-dark:#56B6C2;">strip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You might notice some similarities between this code and what we originally started with in our <code>example.rb</code> file - this is intentional! Resources are used to encapsulate complicated behaviors, such as the mechanics of dealing with niche <code>git</code> subcommands, and expose clean interfaces for use by control authors.</p><p>Now we see that we get a passing test!</p><p>Now let&#39;s adjust our test to also check for our second branch that we created earlier as well as check our current branch:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The following branches should exist</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(git_dir) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;branches&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;main&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;branches&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;testBranch&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;current_branch&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should eq </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;main&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[28]||(a[28]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[29]||(a[29]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[30]||(a[30]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[31]||(a[31]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  branches"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  branches"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "testBranch"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  current_branch"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     undefined"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," method"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"current_branch' for #<#<Class:0x0000000005400588>:0x00000000053fd0b8>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command: `git --git-dir /workspaces/saf-training-lab-environment/git_test_target/.git log -1 --pretty=format:'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔  stdout is expected to match /7a748c6/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command: `git --git-dir /workspaces/saf-training-lab-environment/git_test_target/.git log --skip=1 -1 --pretty=format:'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔  stdout is expected to match /edc207f/")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test Summary: 6 successful, 1 failure, 0 skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[49]||(a[49]=k(`<p>Let&#39;s head over to the git.rb file to create the <code>current_branch</code> method we are invoking in the above test:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Git</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Inspec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;git&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initialize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        @path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> path</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> branches</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;git --git-dir </span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">#{</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">@</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">path</span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch --format=&#39;%(refname:short)&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stdout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lines</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">map</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">:</span><span style="--shiki-light:#986801;--shiki-dark:#56B6C2;">strip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> current_branch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;git --git-dir </span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">#{</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">@</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">path</span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch --show-current&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stdout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strip</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">1337 h4x0rs</p><p>While InSpec controls are intended on being easy to read by both software/cybersecurity engineers AND assessors, InSpec resources are an opportunity to flex those programming muscles and use that arcane sysadmin knowledge to do things in the most optimal way.</p><p>Here&#39;s an alternative implementation for <code>current_branch</code>:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> current_branch</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    branch_name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> inspec.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;git --git-dir </span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">#{</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">@</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">path</span><span style="--shiki-light:#CA1243;--shiki-dark:#C678DD;">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stdout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">gsub</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">find</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">|</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        name.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start_with?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;*&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    branch_name[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">..</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Note how this iterates over the baseline <code>git branch</code> output which looks like this:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">* main</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  testBranch</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And then we do some fancy stuff with string manipulation while searching for the magic string that starts with an asterisk (which marks the current branch). We&#39;re able to leverage the full power of Ruby here!</p><p>However, if you&#39;re a command line expert (or read the docs!), you&#39;d know that you could just pass a single additional flag to the <code>git branch</code> function that spits out the exact answer that we want - don&#39;t get carried away when a simple solution exists!</p></div><p>Now we can run the profile again.</p>`,4)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[32]||(a[32]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[33]||(a[33]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[34]||(a[34]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[35]||(a[35]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-bash"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_git)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    local://")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," 6dcb9e6f-5ede-5474-9521-595fadf5c7ce")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  git")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  branches"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  branches"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "testBranch"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  current_branch"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," eq"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "main"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --git-dir"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/git_test_target/.git log "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"-1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --pretty=format:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  stdout"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," match"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /7a748c6/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  Command:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," `"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"git"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --git-dir"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /workspaces/saf-training-lab-environment/git_test_target/.git log "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"--skip=1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -1"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --pretty=format:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'%h'`")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  stdout"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," match"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /edc207f/")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 7"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 0"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[50]||(a[50]=k('<p>All the tests should pass!</p><div class="hint-container tip"><p class="hint-container-title">Exercise!</p><p>As a solo exercise, try to create a method in the git.rb file to check what the last commit is.</p></div><div class="hint-container important"><p class="hint-container-title">This is Test-Driven Development!</p><p>Did you notice the overall arc of how we wrote this resource? We started with a set of tests before we even wrote any resource code, so we <em>knew</em> we would start out with a failing profile.</p><p>However, that failing profile helped us define how we should build our resource. Since we knew what sort of tests we wanted to be able to run, we knew what functions we needed to write to support them in the <code>git</code> resource. Test-driven development is an excellent method of defining requirements for your code before you even start writing it!</p></div><h2 id="run-the-inspec-shell-with-a-custom-resource" tabindex="-1"><a class="header-anchor" href="#run-the-inspec-shell-with-a-custom-resource"><span>Run the InSpec shell with a custom resource</span></a></h2><p>Invoking the InSpec shell with <code>inspec shell</code> will give you access to all the core InSpec resources by default, but InSpec does not automatically know about your locally defined resources unless you point them out. If you&#39;re testing a local resource, use the <code>--depends</code> flag and pass in the profile directory that your resource lives in.</p>',5)),h(n,{data:[{id:"Command"},{id:"Output"}]},{title0:e(({value:l,isActive:t})=>[...a[36]||(a[36]=[s("Command",-1)])]),title1:e(({value:l,isActive:t})=>[...a[37]||(a[37]=[s("Output",-1)])]),tab0:e(({value:l,isActive:t})=>[...a[38]||(a[38]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," shell"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --depends"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_git")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:e(({value:l,isActive:t})=>[...a[39]||(a[39]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Welcome"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," the"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," interactive"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Shell")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"To"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," find"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," out"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," how"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," use"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," it,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," type:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," help")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"You"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," are"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," currently"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," running"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," on:")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    Name:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"      ubuntu")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    Families:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  debian,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," linux,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," unix,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," os")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    Release:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   20.04")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    Arch:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"      x86_64")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"git"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"("),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"'/workspaces/saf-training-lab-environment/git_test_target/.git'"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},".current_branch")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"="),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"> "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"main"')])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[51]||(a[51]=k('<div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Note that we are passing in the <em>profile</em> directory to the <code>--depends</code> flag, and not the profile&#39;s <code>libraries</code> directory. In our example, it&#39;s <code>inspec shell --depends my_git</code> and not <code>inspec shell --depends my_git/libraries</code>.</p></div><p>If you edit the resource class file, you&#39;ll need to exit the shell and re-launch it for the updates to be available.</p><p>From here, we can examine our custom resource in a sandbox in the same way that we do with core resources.</p>',3))])}const u=r(c,[["render",o]]),m=JSON.parse(`{"path":"/courses/advanced/05.html","title":"5. Create a Custom Resource - The Git Example","lang":"en-US","frontmatter":{"order":5,"next":"06.md","title":"5. Create a Custom Resource - The Git Example","author":"Aaron Lippold","headerDepth":3,"toc":{"levels":[2,5]},"description":"Let's practice creating our own custom resource. Suppose we want to write tests that examine the current state of a local Git repository. We will create a git resource that can ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"5. Create a Custom Resource - The Git Example\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-23T21:39:20.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron Lippold\\"}]}"],["meta",{"property":"og:url","content":"https://mitre.github.io/saf-training/saf-training/courses/advanced/05.html"}],["meta",{"property":"og:site_name","content":"MITRE SAF Training"}],["meta",{"property":"og:title","content":"5. Create a Custom Resource - The Git Example"}],["meta",{"property":"og:description","content":"Let's practice creating our own custom resource. Suppose we want to write tests that examine the current state of a local Git repository. We will create a git resource that can ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-12-23T21:39:20.000Z"}],["meta",{"property":"article:author","content":"Aaron Lippold"}],["meta",{"property":"article:modified_time","content":"2024-12-23T21:39:20.000Z"}]]},"git":{"createdTime":1656449910000,"updatedTime":1734989960000,"contributors":[{"name":"Emily Rodriguez","username":"","email":"ecrodriguez@mm279976-pc.lan","commits":6},{"name":"wdower","username":"wdower","email":"will@dower.dev","commits":4,"url":"https://github.com/wdower"},{"name":"Will Dower","username":"","email":"wdow95@hotmail.com","commits":1},{"name":"Aaron Lippold","username":"","email":"lippold@gmail.com","commits":2},{"name":"Will","username":"Will","email":"will@dower.dev","commits":11,"url":"https://github.com/Will"},{"name":"p-oneil","username":"p-oneil","email":"poneil@mitre.org","commits":1,"url":"https://github.com/p-oneil"},{"name":"Amndeep Singh Mann","username":"","email":"amann@mitre.org","commits":10},{"name":"Shivani Karikar","username":"","email":"karikarshivani@gmail.com","commits":1}]},"readingTime":{"minutes":8.53,"words":2559},"filePathRelative":"courses/advanced/05.md","autoDesc":true}`);export{u as comp,m as data};
