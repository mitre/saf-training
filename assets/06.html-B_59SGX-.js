import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,a as t,d as k,w as n,r as d,o as g,b as i,e as s}from"./app-Cw6QY_M_.js";const A={};function y(c,a){const h=d("CodeTabs");return g(),p("div",null,[a[22]||(a[22]=t(`<h2 id="refactoring-the-code-to-use-inputs" tabindex="-1"><a class="header-anchor" href="#refactoring-the-code-to-use-inputs"><span>Refactoring the code to use Inputs</span></a></h2><p>Your <code>my_nginx</code> profile is off to a great start. As your requirements evolve, you can add additional controls. You can also run this profile as often as you need to verify whether your systems remain in compliance.</p><p>Let&#39;s review the control file, <code>example.rb</code>.</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-version&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX version&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The required version of NGINX should be installed.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe nginx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;version&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should cmp </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;1.27.0&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-modules&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX modules&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The required NGINX modules should be installed.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe nginx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;modules&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;http_ssl&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;modules&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;stream_ssl&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;modules&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;mail_ssl&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-conf-file&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX configuration file&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The NGINX config file should exist.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/etc/nginx/nginx.conf&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should be_file }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-conf-perms&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX configuration&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/etc/nginx/nginx.conf&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should be_owned_by </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;root&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should be_grouped_into </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;root&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should_not be_readable.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;others&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should_not be_writable.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;others&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should_not be_executable.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;others&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-shell-access&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX shell access&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The NGINX shell access should be restricted to admin users.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe users.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">shells</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">/bash/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usernames</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should be_in [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;admin&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-interview&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX interview&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX admins should have documentation on security procedures.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Manual Review&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    skip </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;This control must be manually reviewed.&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Although these controls are straightforward, imagine if your <code>controls</code> directory contained dozens or <em>hundreds</em> of tests, like we might see for a real security validation profile. Many of these tests will be referring to the same test values over and over again -- what happens when we need to change them? Or if I want to test to a different standard and want to adjust the values the tests are looking for? For example, what happens when a new major release of NGINX happens, and we want to test to make sure our deployed webserver is still up to date with the new latest version?</p><p>One way to improve these tests is to use <code>inputs</code>. Inputs enable you to separate the <em>logic of your tests</em> from the <em>data of your tests</em>. Inputs can be provided in-line with your invocation of <code>inspec exec</code> but they can also be stored in <code>input files</code> and placed under version control. Input files should be in the <code>YAML</code> format (files ending in <code>.yaml</code> or <code>.yml</code>).</p><p>Profile inputs are defined in your profile&#39;s main directory within the <code>inspec.yml</code>. These global <code>inputs</code> can be used across all the controls in your profile.</p><p>Let&#39;s add an input to the <code>inspec.yml</code> file for our profile:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">my_nginx</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">InSpec Profile</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maintainer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">The Authors</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">copyright</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">The Authors</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">copyright_email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">you@example.com</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">license</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Apache-2.0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">summary</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">An InSpec Compliance Profile</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.1.0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">supports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  platform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">os</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">inputs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx_version</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">String</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.27.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now that we have defined the <code>nginx_version</code> input, we can access it in any control by using the <code>input</code> keyword and passing in its name.</p><p>For example:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-version&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX version&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The required version of NGINX should be installed.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe nginx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;version&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should cmp </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> input</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx_version&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Since we gave the input a default value of <code>1.27.0</code>, that value will be passed down to the control from <code>inspec.yml</code> at runtime and nothing about the control&#39;s returned results will change from before.</p><p>We have now swapped out a hard-coded value in the control with a parameter. This is the process of <em>parameterization</em>. It is a common practice during InSpec profile development, where profile authors will write their controls and then read through them to look for values that are hardcoded that could be easily replaced with an input.</p><p>Keep in mind that these inputs are <strong>constants</strong>. Their values should not and do not change during the execution of the program. If you want the input to have a different value, we will <strong>override</strong> them using an inputs file.</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>A good rule of thumb is that any check of a numerical value in an InSpec profile should be replaced with an input.</p></div><p>The next control checks whether certain NGINX modules are installed. Let&#39;s make an input to represent an array of modules we want to check for.</p><p>Example of adding an array object of servers:</p>`,18)),k(h,{data:[{id:"Array Input Generic"},{id:"Array Input - NGINX Modules"},{id:"Full inspec.yml file"}],"tab-id":"shell"},{title0:n(({value:l,isActive:e})=>[...a[0]||(a[0]=[s("Array Input Generic",-1)])]),title1:n(({value:l,isActive:e})=>[...a[1]||(a[1]=[s("Array Input - NGINX Modules",-1)])]),title2:n(({value:l,isActive:e})=>[...a[2]||(a[2]=[s("Full inspec.yml file",-1)])]),tab0:n(({value:l,isActive:e})=>[...a[3]||(a[3]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"servers")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Array")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"server1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"server2")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"server3")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:n(({value:l,isActive:e})=>[...a[4]||(a[4]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"nginx_modules")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Array")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"http_ssl")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"stream_ssl")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"mail_ssl")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab2:n(({value:l,isActive:e})=>[...a[5]||(a[5]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"my_nginx")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"title"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"InSpec Profile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"maintainer"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"The Authors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"copyright"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"The Authors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"copyright_email"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"you@example.com")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"license"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Apache-2.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"summary"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"An InSpec Compliance Profile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"version"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"supports"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"  platform"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"os")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"inputs"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"nginx_version")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"String")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"1.27.0")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"nginx_modules")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Array")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"http_ssl")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"stream_ssl")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"mail_ssl")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[23]||(a[23]=t(`<p>Your control can now be updated to look like this:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-modules&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX modules&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The required NGINX modules should be installed.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  nginx_modules</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> input</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx_modules&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe nginx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    nginx_modules.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">each</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">current_module</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">|</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      its</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;modules&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { should </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">include</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> current_module }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Lastly, we can edit our <code>inspec.yml</code> file to create a list of admin users:</p>`,3)),k(h,{data:[{id:"Array Input - Admin Users"},{id:"Full inspec.yml file"}],"tab-id":"shell"},{title0:n(({value:l,isActive:e})=>[...a[6]||(a[6]=[s("Array Input - Admin Users",-1)])]),title1:n(({value:l,isActive:e})=>[...a[7]||(a[7]=[s("Full inspec.yml file",-1)])]),tab0:n(({value:l,isActive:e})=>[...a[8]||(a[8]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"admin_users")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Array")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"admin")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:n(({value:l,isActive:e})=>[...a[9]||(a[9]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"my_nginx")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"title"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"InSpec Profile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"maintainer"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"The Authors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"copyright"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"The Authors")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"copyright_email"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"you@example.com")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"license"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Apache-2.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"summary"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"An InSpec Compliance Profile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"version"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"supports"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"  platform"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"os")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"inputs"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"nginx_version")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"String")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"1.27.0")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"nginx_modules")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Array")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"http_ssl")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"stream_ssl")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"mail_ssl")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"name"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"admin_users")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    type"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},": "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Array")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"    value"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"admin")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[24]||(a[24]=t(`<p>Your fifth control can be changed to look like this:</p><div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;nginx-shell-access&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  impact </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  title </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;NGINX shell access&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  desc </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;The NGINX shell access should be restricted to admin users.&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  describe users.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">shells</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">/bash/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usernames</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    it { should be_in </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">input</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;admin_users&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  end</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="overriding-inputs" tabindex="-1"><a class="header-anchor" href="#overriding-inputs"><span>Overriding Inputs</span></a></h2><p>We have now defined and parameterized a set of default values for our controls. But what if we want to change those defaults at some point? We can pass in our own values for inputs when we run <code>inspec exec</code> to ensure that each individual run of InSpec uses the values we want.</p><p>Create a file inside your <code>my_nginx</code> profile called <code>inputs.yml</code>:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># my_nginx/inputs.yml</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">admin_users</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">admin</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Note that we are invoking an input name that we defined back in the <code>inspec.yml</code> file (<code>admin_users</code>). We are now overriding the default value by adding the <code>root</code> account to our list of valid account names.</p><p>Remember how our test for requirement 5 was failing because we found an account named <code>root</code> when we were expecting the name <code>admin</code>? We can now tell InSpec that we were intending to look for an account named <code>root</code>, and very importantly, we can do it without having to edit either our control code itself or the <code>inspec.yml</code> file.</p><p>When using InSpec in the real world, we want a strong separation between our underlying test code (the profile itself) and the environment-specific parameters we pass to it (the inputs). Therefore, we <em>never</em> edit the <code>inspec.yml</code> file to simply erase the default values and put in our own; we will instead use InSpec&#39;s ability to <em>override</em> input values via an inputs file.</p><p>Let&#39;s re-run the profile and pass it our custom inputs.</p>`,10)),k(h,{data:[{id:"Command"},{id:"Output - <code v-pre>--input-file</code> flag"}],"tab-id":"shell"},{title0:n(({value:l,isActive:e})=>[...a[10]||(a[10]=[s("Command",-1)])]),title1:n(({value:l,isActive:e})=>[...a[11]||(a[11]=[s("Output - ",-1),i("code",null,"--input-file",-1),s(" flag",-1)])]),tab0:n(({value:l,isActive:e})=>[...a[12]||(a[12]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_nginx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -t"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker://nginx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --input-file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_nginx/inputs.yml")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:n(({value:l,isActive:e})=>[...a[13]||(a[13]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_nginx)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    docker://DOCKER_CONTAINER_ID")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," TARGET_ID")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-version:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," version")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," version"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," >"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "1.27.0"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-modules:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "http_ssl"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "stream_ssl"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "mail_ssl"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-conf-file:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," configuration"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-conf-perms:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," configuration"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," permissions"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (1 "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"failed"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," owned"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "root"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," grouped"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," into"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "root"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," readable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," readable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," writable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," executable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-shell-access:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," shell"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," access")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"root"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"] is expected to be in "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"admin"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," and "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"root"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ↺"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-interview:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," interview")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ↺"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  This"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," control"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," must"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," manually"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," reviewed.")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 3"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," control"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," control"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 9"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[25]||(a[25]=t('<p>And there we are, requirement 5 is now correctly indicating that the test is a pass.</p><p>Notice that all the other tests besides number 5 <em>did not</em> change -- we didn&#39;t specifically override the inputs for those ones in the inputs file, so InSpec did not change the default values.</p><h3 id="passing-inputs-via-the-input-flags" tabindex="-1"><a class="header-anchor" href="#passing-inputs-via-the-input-flags"><span>Passing Inputs Via the <code>--input</code> Flags</span></a></h3><p>There are <a href="https://docs.chef.io/inspec/profiles/inputs" target="_blank" rel="noopener noreferrer">many ways</a> to pass an input to InSpec at runtime. InSpec <a href="https://docs.chef.io/inspec/profiles/inputs/#input-priority" target="_blank" rel="noopener noreferrer">prioritizes</a> input values differently depending on where the value comes from.</p><p>For example, we can pass an input directly on the terminal line using a different flag:</p>',5)),k(h,{data:[{id:"Command"},{id:"Output - <code v-pre>--input</code> flag"}],"tab-id":"shell"},{title0:n(({value:l,isActive:e})=>[...a[14]||(a[14]=[s("Command",-1)])]),title1:n(({value:l,isActive:e})=>[...a[15]||(a[15]=[s("Output - ",-1),i("code",null,"--input",-1),s(" flag",-1)])]),tab0:n(({value:l,isActive:e})=>[...a[16]||(a[16]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"inspec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," exec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," my_nginx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -t"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," docker://nginx"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," --input=admin_users=["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"'root'"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"]")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:n(({value:l,isActive:e})=>[...a[17]||(a[17]=[i("div",{class:"language-sh line-numbers-mode","data-highlighter":"shiki","data-ext":"sh",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-sh"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Redirecting"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cinc-auditor...")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"   InSpec"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Profile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (my_nginx)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Version:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"   0.1.0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"    docker://DOCKER_CONTAINER_ID")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Target"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ID:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," TARGET_ID")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-version:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," version")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," version"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," cmp"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," >"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"="),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "1.27.0"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-modules:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "http_ssl"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "stream_ssl"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  Nginx"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Environment"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," modules"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," include"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "mail_ssl"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-conf-file:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," configuration"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-conf-perms:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," configuration"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," permissions"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," (1 "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"failed"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," owned"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "root"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," grouped"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," into"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},' "root"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ×"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," readable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," readable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," writable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  File"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," /etc/nginx/nginx.conf"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," is"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," expected"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," not"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," to"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," executable"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," by"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," others")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ✔"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-shell-access:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," shell"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," access")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ✔"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  ["),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"root"'),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"] is expected to be in "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},'"root"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"  ↺"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  nginx-interview:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," NGINX"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," interview")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"     ↺"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"  This"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," control"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," must"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," be"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," manually"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," reviewed.")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Profile"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 3"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," controls,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," control"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," control"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Test"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Summary:"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 9"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," successful,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 2"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," failures,"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," skipped")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1}),a[26]||(a[26]=t('<p>The test still passes.</p><h3 id="keeping-multiple-input-files" tabindex="-1"><a class="header-anchor" href="#keeping-multiple-input-files"><span>Keeping Multiple Input Files</span></a></h3><p>To change your inputs for platform specific cases, you can set up multiple input files.</p><p>For example, an NGINX web server could be run on a Windows or Linux machine, which may require different admin users for each context. The inputs can be tailored for each system. You can create a <code>inputs-windows.yml</code> <em>and</em> <code>inputs-linux.yml</code> file in your home directory and only pass the one you actually need to InSpec at runtime.</p><div class="hint-container note"><p class="hint-container-title">Note</p><p>Another example is that production and development environments may require different inputs.</p></div>',5)),k(h,{data:[{id:"inputs-windows.yml"},{id:"inputs-linux.yml"}],"tab-id":"shell"},{title0:n(({value:l,isActive:e})=>[...a[18]||(a[18]=[s("inputs-windows.yml",-1)])]),title1:n(({value:l,isActive:e})=>[...a[19]||(a[19]=[s("inputs-linux.yml",-1)])]),tab0:n(({value:l,isActive:e})=>[...a[20]||(a[20]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"admin_users"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Administrator")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"Randy")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:n(({value:l,isActive:e})=>[...a[21]||(a[21]=[i("div",{class:"language-yaml line-numbers-mode","data-highlighter":"shiki","data-ext":"yaml",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",{class:"language-yaml"},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E06C75"}},"admin_users"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"root")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"  - "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"randy")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),_:1})])}const u=r(A,[["render",y]]),m=JSON.parse('{"path":"/courses/beginner/06.html","title":"6. Inputs in InSpec","lang":"en-US","frontmatter":{"order":6,"next":"07.md","title":"6. Inputs in InSpec","author":"Aaron Lippold","description":"Refactoring the code to use Inputs Your my_nginx profile is off to a great start. As your requirements evolve, you can add additional controls. You can also run this profile as ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"6. Inputs in InSpec\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-11T20:48:13.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron Lippold\\"}]}"],["meta",{"property":"og:url","content":"https://mitre.github.io/saf-training/saf-training/courses/beginner/06.html"}],["meta",{"property":"og:site_name","content":"MITRE SAF Training"}],["meta",{"property":"og:title","content":"6. Inputs in InSpec"}],["meta",{"property":"og:description","content":"Refactoring the code to use Inputs Your my_nginx profile is off to a great start. As your requirements evolve, you can add additional controls. You can also run this profile as ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-11T20:48:13.000Z"}],["meta",{"property":"article:author","content":"Aaron Lippold"}],["meta",{"property":"article:modified_time","content":"2025-09-11T20:48:13.000Z"}]]},"git":{"createdTime":1653259416000,"updatedTime":1757623693000,"contributors":[{"name":"Aaron Lippold","username":"","email":"lippold@gmail.com","commits":4},{"name":"em-c-rod","username":"em-c-rod","email":"32680215+em-c-rod@users.noreply.github.com","commits":2,"url":"https://github.com/em-c-rod"},{"name":"Emily Rodriguez","username":"","email":"ecrodriguez@mm279976-pc.lan","commits":7},{"name":"Shivani Karikar","username":"","email":"karikarshivani@gmail.com","commits":2},{"name":"wdower","username":"wdower","email":"will@dower.dev","commits":4,"url":"https://github.com/wdower"},{"name":"Amndeep Singh Mann","username":"","email":"amann@mitre.org","commits":6},{"name":"p-oneil","username":"p-oneil","email":"poneil@mitre.org","commits":1,"url":"https://github.com/p-oneil"},{"name":"Will","username":"Will","email":"will@dower.dev","commits":1,"url":"https://github.com/Will"}]},"readingTime":{"minutes":6.66,"words":1998},"filePathRelative":"courses/beginner/06.md","autoDesc":true}');export{u as comp,m as data};
