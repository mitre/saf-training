Day 2 of SAF Advanced Developer Class - Creating a Pipeline

- Overall suggestion for the walkthrough bit -- have people write up a github action workflow file *for their own test repo* that they generate from the template
- Suggest we have the workflow file describe using InSpec, Ansible, and the SAF CLI run some of the premade SAF content for NGINX against the same NGINX container image we have been working on writing tests for in the beginner class
- stress that we happen to be doing this in GitHub Actions, but there are loads of tools that do equivalent stuff, and they will be able to transfer these skills to other areas

Outline
- Section N: CI/CD Pipelines (suggest to borrow content from Will's explanation of what the SAF is for interns, lives [here](https://app.gitbook.com/o/FbC5imoOf30TsP3Ma5Is/s/GvZrmOgiXEqRNzarOLFD/onboarding-info/what-is-the-saf))
	- **WHAT(/WHY)** is a pipeline? --> briefly, we make pipelines for the same reason Henry Ford made the assembly line; it makes processes repeatable, consistent, and automated wherever possible
	- define CI/CD
		- Use Will's definitions from GitBook(?):
			- CI - Test code before committing it to a central repository ("continuous integration", CI)
			- CD - Release a new iteration of the codebase on a frequent basis ("continuous delivery", CD)
	- What tools can I use in a pipeline? --> anything you want!
		- We use InSpec for X Y Z purposes in our pipelines
	- USE CASE -- describe the use case we will be following for this class. We will assume that we are engineers trying to build a GOLD IMAGE PIPELINE for an NGINX container image.
		- We need to:
			- Take a base container image (same one as whatever we use in the lab for testing)
			- harden it (use ansible and the https://saf.mitre.org/libs/harden content for NGINX. . .?)
			- validate the hardening by running either the full profile we developed from the beginner class or the actual SAF profile for NGINX
			- verify that the hardening reached a threshold of success (saf cli)
		- should probably describe other common use cases for CI/CD pipelines, like managing IaC in more complex environments
	- Pipelines are broken into JOBS. The JOBS we need in a common pipeline include but are not limited to:
			- Prep (Configure Runner, do stuff like `yum update`)
			- Lint Code (in our case `inspec check .`, maybe a rubocop run)
			- deploy test suite (in our case, the hardened and vanilla boxes we want to test, but more generally, this means pulling and deploying the application you are testing)
			- configure the test suite (i.e. harden one of 'em)
			- validate
			- verify
			- do something with results -- if we passed do X, if not do Y
- Section N+1: GitHub Actions
	- Some background info on GH Actions and why they are useful
		- Show them what a completed workflow file looks like as a code sample and also a diagram. REFER BACK TO DIAGRAM FREQUENTLY
	- Show ANOTHER DIAGRAM that describes where the workflow action file sits in the repo and how it relates to the actual repository code
	- Stress that GH Actions are one of MANY pipeline software solutions
		- obvious parallels are GitLab pipelines, DroneCI, Jenkins
		- Ask people what stuff they've used to automate before, have SAF team members give some war stories, etc.
- Section N+2: Writing the GitHub Action workflow file
	- Based on prior course feedback, have them write at least some of this content instead of copy-pasting it
	- Mention different kinds of workflow triggers
	- jobs and the interplay between jobs (passing variables etc.)
	- At first, have the workflow file literally print "hello world" and drop it in an artifact we can read
- Section N+3: Hardening and Validating
	- Edit the workflow file to add in jobs that actually do stuff (i.e. harden/validate/verify)
	- TBD -- should probably pre-write the packerfile/InSpec profile . . . ?
- Sectoin N+4: Verifying
	- Add a step that saves the output of validate job as an artifact 
		- note that this step should ALWAYS run, we want to save even a failed result so we can diagnose issues
	- Use the [SAF action](https://github.com/mitre/saf_action) for verifying results
		- use as a segue to talking about saving jobs as building blocks for other jobs
			- describe how you can write template files in gitlab that do the same thing.
		- write up a threshold file to define what a successful run is
	