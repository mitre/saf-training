<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.45" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mitre.github.io/saf-training/courses/advanced/10.html"><meta property="og:site_name" content="MITRE SAF Training"><meta property="og:title" content="10. Writing Plural Resources"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-06-28T20:58:30.000Z"><meta property="og:locale" content="en-US"><meta property="article:author" content="Aaron Lippold"><meta property="article:modified_time" content="2022-06-28T20:58:30.000Z"><title>10. Writing Plural Resources | MITRE SAF Training</title><meta name="description" content="The MITRE Security Automation Framework Team's Introduction to InSpec profile development">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/saf-training/assets/style.8e6cefc7.css">
    <link rel="modulepreload" href="/saf-training/assets/app.3b4d192a.js"><link rel="modulepreload" href="/saf-training/assets/10.html.7afc13f2.js"><link rel="modulepreload" href="/saf-training/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/saf-training/assets/10.html.282902e5.js"><link rel="prefetch" href="/saf-training/assets/CODE_OF_CONDUCT.html.54785dc6.js"><link rel="prefetch" href="/saf-training/assets/LICENSE.html.8754396d.js"><link rel="prefetch" href="/saf-training/assets/index.html.4f1b878a.js"><link rel="prefetch" href="/saf-training/assets/intro.html.425618de.js"><link rel="prefetch" href="/saf-training/assets/slide.html.7ced1f4b.js"><link rel="prefetch" href="/saf-training/assets/index.html.fdb81daa.js"><link rel="prefetch" href="/saf-training/assets/disable.html.f6151564.js"><link rel="prefetch" href="/saf-training/assets/encrypt.html.8e9bee1f.js"><link rel="prefetch" href="/saf-training/assets/markdown.html.7c8a8241.js"><link rel="prefetch" href="/saf-training/assets/page.html.377a2d83.js"><link rel="prefetch" href="/saf-training/assets/LinuxInstall.html.0cac14c3.js"><link rel="prefetch" href="/saf-training/assets/MacInstall.html.41fe3aaa.js"><link rel="prefetch" href="/saf-training/assets/index.html.277465f3.js"><link rel="prefetch" href="/saf-training/assets/WindowsInstall.html.92ed3a1d.js"><link rel="prefetch" href="/saf-training/assets/article10.html.8efffe5a.js"><link rel="prefetch" href="/saf-training/assets/article11.html.dc40dacb.js"><link rel="prefetch" href="/saf-training/assets/article12.html.78f21321.js"><link rel="prefetch" href="/saf-training/assets/article9.html.8fd8dfe0.js"><link rel="prefetch" href="/saf-training/assets/02.html.a73a03ba.js"><link rel="prefetch" href="/saf-training/assets/03.html.ca3b50a2.js"><link rel="prefetch" href="/saf-training/assets/index.html.18b1833a.js"><link rel="prefetch" href="/saf-training/assets/02.html.bf2572f3.js"><link rel="prefetch" href="/saf-training/assets/03.html.3f7cb53f.js"><link rel="prefetch" href="/saf-training/assets/04.html.477d6335.js"><link rel="prefetch" href="/saf-training/assets/05.html.2281abbd.js"><link rel="prefetch" href="/saf-training/assets/06.html.82571ce3.js"><link rel="prefetch" href="/saf-training/assets/07.html.b77643b6.js"><link rel="prefetch" href="/saf-training/assets/08.html.c56bc8c0.js"><link rel="prefetch" href="/saf-training/assets/09.html.326f9546.js"><link rel="prefetch" href="/saf-training/assets/11.html.390f6ebd.js"><link rel="prefetch" href="/saf-training/assets/12.html.1e51136a.js"><link rel="prefetch" href="/saf-training/assets/13.html.c6c0d718.js"><link rel="prefetch" href="/saf-training/assets/14.html.491de686.js"><link rel="prefetch" href="/saf-training/assets/index.html.b8660141.js"><link rel="prefetch" href="/saf-training/assets/02.html.7c987422.js"><link rel="prefetch" href="/saf-training/assets/03.html.af9c0315.js"><link rel="prefetch" href="/saf-training/assets/04.html.690bec83.js"><link rel="prefetch" href="/saf-training/assets/05.html.2cacbab2.js"><link rel="prefetch" href="/saf-training/assets/06.html.0bcc77bd.js"><link rel="prefetch" href="/saf-training/assets/07.html.5d53e637.js"><link rel="prefetch" href="/saf-training/assets/08.html.d7f38e50.js"><link rel="prefetch" href="/saf-training/assets/09.html.90730330.js"><link rel="prefetch" href="/saf-training/assets/10.html.45ceb534.js"><link rel="prefetch" href="/saf-training/assets/index.html.5557eed7.js"><link rel="prefetch" href="/saf-training/assets/02.html.8a5061e8.js"><link rel="prefetch" href="/saf-training/assets/index.html.facfb16d.js"><link rel="prefetch" href="/saf-training/assets/02.html.ef103983.js"><link rel="prefetch" href="/saf-training/assets/03.html.81d8f1fe.js"><link rel="prefetch" href="/saf-training/assets/04.html.f6acf977.js"><link rel="prefetch" href="/saf-training/assets/05.html.65b08846.js"><link rel="prefetch" href="/saf-training/assets/06.html.277b1f78.js"><link rel="prefetch" href="/saf-training/assets/07.html.9fbf5f59.js"><link rel="prefetch" href="/saf-training/assets/08.html.b6c683ab.js"><link rel="prefetch" href="/saf-training/assets/09.html.4475c274.js"><link rel="prefetch" href="/saf-training/assets/10.html.437e03cf.js"><link rel="prefetch" href="/saf-training/assets/11.html.c2786113.js"><link rel="prefetch" href="/saf-training/assets/12.html.c0542013.js"><link rel="prefetch" href="/saf-training/assets/13.html.7b9b5607.js"><link rel="prefetch" href="/saf-training/assets/14.html.3d15f93f.js"><link rel="prefetch" href="/saf-training/assets/15.html.beb382b2.js"><link rel="prefetch" href="/saf-training/assets/index.html.cb89b9b1.js"><link rel="prefetch" href="/saf-training/assets/article1.html.0bc40f28.js"><link rel="prefetch" href="/saf-training/assets/article2.html.d30651e1.js"><link rel="prefetch" href="/saf-training/assets/article3.html.7227865e.js"><link rel="prefetch" href="/saf-training/assets/article4.html.52025cc3.js"><link rel="prefetch" href="/saf-training/assets/article5.html.a0ca1361.js"><link rel="prefetch" href="/saf-training/assets/article6.html.b3187aac.js"><link rel="prefetch" href="/saf-training/assets/article7.html.cfcee535.js"><link rel="prefetch" href="/saf-training/assets/article8.html.cd5878fa.js"><link rel="prefetch" href="/saf-training/assets/404.html.397a0508.js"><link rel="prefetch" href="/saf-training/assets/CODE_OF_CONDUCT.html.90622e3b.js"><link rel="prefetch" href="/saf-training/assets/LICENSE.html.f459ba99.js"><link rel="prefetch" href="/saf-training/assets/index.html.4c66c058.js"><link rel="prefetch" href="/saf-training/assets/intro.html.d463302c.js"><link rel="prefetch" href="/saf-training/assets/slide.html.4603adf5.js"><link rel="prefetch" href="/saf-training/assets/index.html.103c2aa5.js"><link rel="prefetch" href="/saf-training/assets/disable.html.cd5340b2.js"><link rel="prefetch" href="/saf-training/assets/encrypt.html.27f8bcd8.js"><link rel="prefetch" href="/saf-training/assets/markdown.html.3c2c5d68.js"><link rel="prefetch" href="/saf-training/assets/page.html.a5eb6cbe.js"><link rel="prefetch" href="/saf-training/assets/LinuxInstall.html.be4b379d.js"><link rel="prefetch" href="/saf-training/assets/MacInstall.html.4c0e28f8.js"><link rel="prefetch" href="/saf-training/assets/index.html.70d8726c.js"><link rel="prefetch" href="/saf-training/assets/WindowsInstall.html.b72b20a9.js"><link rel="prefetch" href="/saf-training/assets/article10.html.10f2fce4.js"><link rel="prefetch" href="/saf-training/assets/article11.html.d49dbb39.js"><link rel="prefetch" href="/saf-training/assets/article12.html.d25f77d6.js"><link rel="prefetch" href="/saf-training/assets/article9.html.fa467a0e.js"><link rel="prefetch" href="/saf-training/assets/02.html.a79e29e7.js"><link rel="prefetch" href="/saf-training/assets/03.html.36a90e71.js"><link rel="prefetch" href="/saf-training/assets/index.html.2f162e2c.js"><link rel="prefetch" href="/saf-training/assets/02.html.19ab2d23.js"><link rel="prefetch" href="/saf-training/assets/03.html.878194f9.js"><link rel="prefetch" href="/saf-training/assets/04.html.c6da558f.js"><link rel="prefetch" href="/saf-training/assets/05.html.34f9f802.js"><link rel="prefetch" href="/saf-training/assets/06.html.68f92ef7.js"><link rel="prefetch" href="/saf-training/assets/07.html.2dfc187f.js"><link rel="prefetch" href="/saf-training/assets/08.html.a749cbc6.js"><link rel="prefetch" href="/saf-training/assets/09.html.1ae6624f.js"><link rel="prefetch" href="/saf-training/assets/11.html.346fee2f.js"><link rel="prefetch" href="/saf-training/assets/12.html.0d9a2780.js"><link rel="prefetch" href="/saf-training/assets/13.html.317b1d4f.js"><link rel="prefetch" href="/saf-training/assets/14.html.f92b6590.js"><link rel="prefetch" href="/saf-training/assets/index.html.07401314.js"><link rel="prefetch" href="/saf-training/assets/02.html.a0b69589.js"><link rel="prefetch" href="/saf-training/assets/03.html.ed7b254d.js"><link rel="prefetch" href="/saf-training/assets/04.html.4d8cf07e.js"><link rel="prefetch" href="/saf-training/assets/05.html.57b851c3.js"><link rel="prefetch" href="/saf-training/assets/06.html.010c8b41.js"><link rel="prefetch" href="/saf-training/assets/07.html.ce8f25c9.js"><link rel="prefetch" href="/saf-training/assets/08.html.d2698ebf.js"><link rel="prefetch" href="/saf-training/assets/09.html.fa6a2615.js"><link rel="prefetch" href="/saf-training/assets/10.html.7084ce0b.js"><link rel="prefetch" href="/saf-training/assets/index.html.c84a2bee.js"><link rel="prefetch" href="/saf-training/assets/02.html.cbeb912e.js"><link rel="prefetch" href="/saf-training/assets/index.html.7febf74a.js"><link rel="prefetch" href="/saf-training/assets/02.html.47e02e9b.js"><link rel="prefetch" href="/saf-training/assets/03.html.23c4ed39.js"><link rel="prefetch" href="/saf-training/assets/04.html.0f0c0ede.js"><link rel="prefetch" href="/saf-training/assets/05.html.e4b19e1c.js"><link rel="prefetch" href="/saf-training/assets/06.html.1289f68c.js"><link rel="prefetch" href="/saf-training/assets/07.html.a92fcbc8.js"><link rel="prefetch" href="/saf-training/assets/08.html.7db98a6e.js"><link rel="prefetch" href="/saf-training/assets/09.html.de222d76.js"><link rel="prefetch" href="/saf-training/assets/10.html.91023b47.js"><link rel="prefetch" href="/saf-training/assets/11.html.179e5e09.js"><link rel="prefetch" href="/saf-training/assets/12.html.3ce83e19.js"><link rel="prefetch" href="/saf-training/assets/13.html.8789bbb1.js"><link rel="prefetch" href="/saf-training/assets/14.html.5d4098e1.js"><link rel="prefetch" href="/saf-training/assets/15.html.50f92338.js"><link rel="prefetch" href="/saf-training/assets/index.html.2355a21b.js"><link rel="prefetch" href="/saf-training/assets/article1.html.a3b6f880.js"><link rel="prefetch" href="/saf-training/assets/article2.html.1c0c80ed.js"><link rel="prefetch" href="/saf-training/assets/article3.html.4f23f9fd.js"><link rel="prefetch" href="/saf-training/assets/article4.html.bcbaeff8.js"><link rel="prefetch" href="/saf-training/assets/article5.html.f883ff16.js"><link rel="prefetch" href="/saf-training/assets/article6.html.cde804b4.js"><link rel="prefetch" href="/saf-training/assets/article7.html.bc767d64.js"><link rel="prefetch" href="/saf-training/assets/article8.html.dd564584.js"><link rel="prefetch" href="/saf-training/assets/404.html.1d55c70a.js"><link rel="prefetch" href="/saf-training/assets/404.8d95f0ad.js"><link rel="prefetch" href="/saf-training/assets/Layout.56f80719.js"><link rel="prefetch" href="/saf-training/assets/Slide.5d6ab2df.js"><link rel="prefetch" href="/saf-training/assets/giscus.es.10e3969d.js"><link rel="prefetch" href="/saf-training/assets/auto.esm.15d52109.js"><link rel="prefetch" href="/saf-training/assets/index.308e684a.js"><link rel="prefetch" href="/saf-training/assets/index.1842ee54.js"><link rel="prefetch" href="/saf-training/assets/mermaid.core.8a33bb3e.js"><link rel="prefetch" href="/saf-training/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/saf-training/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/saf-training/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/saf-training/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/saf-training/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/saf-training/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/saf-training/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/saf-training/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/saf-training/" class="home-link"><img class="logo" src="/saf-training/logo.svg" alt="MITRE SAF Training"><!----><span class="site-name hide-in-pad">MITRE SAF Training</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/saf-training/" class="nav-link" aria-label="MITRE SAF Training"><span class="icon iconfont icon-home" style=""></span>MITRE SAF Training<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Classes"><span class="title"><span class="icon iconfont icon-creative" style=""></span>Classes</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/saf-training/courses/user/" class="nav-link" aria-label="SAF User Class"><span class="icon iconfont icon-creative" style=""></span>SAF User Class<!----></a></li><li class="dropdown-item"><a href="/saf-training/courses/beginner/" class="nav-link" aria-label="Beginner Security Automation Developer Class"><span class="icon iconfont icon-creative" style=""></span>Beginner Security Automation Developer Class<!----></a></li><li class="dropdown-item"><a href="/saf-training/courses/advanced/" class="nav-link active" aria-label="Advanced Security Automation Developer Class"><span class="icon iconfont icon-creative" style=""></span>Advanced Security Automation Developer Class<!----></a></li><li class="dropdown-item"><a href="/saf-training/courses/guidance/" class="nav-link" aria-label="Security Guidance Developer Class"><span class="icon iconfont icon-creative" style=""></span>Security Guidance Developer Class<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Resources"><span class="title"><span class="icon iconfont icon-note" style=""></span>Resources</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/saf-training/resources/" class="nav-link" aria-label="Class Resources"><!---->Class Resources<!----></a></li><li class="dropdown-item"><a href="/saf-training/resources/02.html" class="nav-link" aria-label="Codespace Resources"><!---->Codespace Resources<!----></a></li><li class="dropdown-item"><a href="/saf-training/resources/03.html" class="nav-link" aria-label="Training Development Docs"><!---->Training Development Docs<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/saf-training/installation/" class="nav-link" aria-label="Installation"><span class="icon iconfont icon-note" style=""></span>Installation<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/mitre/saf-training" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-creative" style=""></span><a href="/saf-training/courses/user/" class="title">User Class</a><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-creative" style=""></span><a href="/saf-training/courses/beginner/" class="title">Beginner Class</a><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-creative" style=""></span><a href="/saf-training/courses/advanced/" class="title">Advanced Class</a><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/saf-training/courses/advanced/" class="nav-link sidebar-link sidebar-page" aria-label="1. Class Overview"><span class="icon iconfont icon-page" style=""></span>1. Class Overview<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/02.html" class="nav-link sidebar-link sidebar-page" aria-label="2. Review the Fundamentals"><span class="icon iconfont icon-page" style=""></span>2. Review the Fundamentals<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/03.html" class="nav-link sidebar-link sidebar-page" aria-label="3. Practice the Fundamentals"><span class="icon iconfont icon-page" style=""></span>3. Practice the Fundamentals<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/04.html" class="nav-link sidebar-link sidebar-page" aria-label="4. Tools for Automation"><span class="icon iconfont icon-page" style=""></span>4. Tools for Automation<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/05.html" class="nav-link sidebar-link sidebar-page" aria-label="5. Automate Security Testing"><span class="icon iconfont icon-page" style=""></span>5. Automate Security Testing<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/06.html" class="nav-link sidebar-link sidebar-page" aria-label="6. Explore InSpec Resources"><span class="icon iconfont icon-page" style=""></span>6. Explore InSpec Resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/07.html" class="nav-link sidebar-link sidebar-page" aria-label="7. Local vs Built-in Resources"><span class="icon iconfont icon-page" style=""></span>7. Local vs Built-in Resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/08.html" class="nav-link sidebar-link sidebar-page" aria-label="8. Create a Custom Resource - The Git Example"><span class="icon iconfont icon-page" style=""></span>8. Create a Custom Resource - The Git Example<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/09.html" class="nav-link sidebar-link sidebar-page" aria-label="9. Create a Custom Resource - The Docker Example"><span class="icon iconfont icon-page" style=""></span>9. Create a Custom Resource - The Docker Example<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/saf-training/courses/advanced/10.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="10. Writing Plural Resources"><span class="icon iconfont icon-page" style=""></span>10. Writing Plural Resources<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-plural-resources" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10. Plural Resources"><!---->10. Plural Resources<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-1-using-filtertable-to-write-a-plural-resource" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.1. Using FilterTable to write a Plural Resource"><!---->10.1. Using FilterTable to write a Plural Resource<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-2-filtertable-hands-on" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.2. FilterTable Hands-On"><!---->10.2. FilterTable Hands-On<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-3-predefined-methods-for-filtertable" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.3. Predefined Methods for FilterTable"><!---->10.3. Predefined Methods for FilterTable<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-4-filtertable-examples" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.4 FilterTable Examples"><!---->10.4 FilterTable Examples<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/11.html" class="nav-link sidebar-link sidebar-page" aria-label="11. Dissecting Resources"><span class="icon iconfont icon-page" style=""></span>11. Dissecting Resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/12.html" class="nav-link sidebar-link sidebar-page" aria-label="12. Exercise - Develop your own resources"><span class="icon iconfont icon-page" style=""></span>12. Exercise - Develop your own resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/13.html" class="nav-link sidebar-link sidebar-page" aria-label="13. Add Your Resource to InSpec"><span class="icon iconfont icon-page" style=""></span>13. Add Your Resource to InSpec<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/saf-training/courses/advanced/14.html" class="nav-link sidebar-link sidebar-page" aria-label="14. Custom Resource Examples from InSpec"><span class="icon iconfont icon-page" style=""></span>14. Custom Resource Examples from InSpec<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-creative" style=""></span><a href="/saf-training/courses/guidance/" class="title">Guidance Class</a><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-note" style=""></span><a href="/saf-training/resources/" class="title">Resources</a><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-note" style=""></span><a href="/saf-training/installation/" class="title">Installation</a><span class="arrow right"></span></button><!----></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-page" style=""></span>10. Writing Plural Resources</h1><div class="page-info"><!----><span class="date-info" aria-label="Writing Date📅" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>June 28, 2022</span><meta property="datePublished" content="2022-06-28T20:58:30.000Z"></span><!----><!----><span class="reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 8 min</span><meta property="timeRequired" content="PT8M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-plural-resources" class="router-link-active router-link-exact-active toc-link level2">10. Plural Resources</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-1-using-filtertable-to-write-a-plural-resource" class="router-link-active router-link-exact-active toc-link level3">10.1. Using FilterTable to write a Plural Resource</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-2-filtertable-hands-on" class="router-link-active router-link-exact-active toc-link level3">10.2. FilterTable Hands-On</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-3-predefined-methods-for-filtertable" class="router-link-active router-link-exact-active toc-link level3">10.3. Predefined Methods for FilterTable</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/saf-training/courses/advanced/10.html#_10-4-filtertable-examples" class="router-link-active router-link-exact-active toc-link level3">10.4 FilterTable Examples</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h2 id="_10-plural-resources" tabindex="-1"><a class="header-anchor" href="#_10-plural-resources" aria-hidden="true">#</a> 10. Plural Resources</h2><p>You might have noticed that many InSpec resources have a &quot;plural&quot; version. For example, <code>user</code> has a <code>users</code> counterpart, and <code>package</code> has <code>packages</code>.</p><p>Plural resources examine platform objects in bulk. For example,</p><ul><li>sorting through which packages are installed on a system, or</li><li>which virtual machines are on a cloud provider.</li><li>all processes running more than an hour, or all VMs on a particular subnet.</li></ul><p>Plural resources usually include functions to query the set of objects it represents by an attribute, like so:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe users<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">uid</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>entries <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should eq <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;root&#39;</span></span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;uids&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should eq <span class="token punctuation">[</span><span class="token number">1234</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;gids&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should eq <span class="token punctuation">[</span><span class="token number">1234</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This test queries <strong>all</strong> users to confirm that the only one with a uid of zero is the root user.</p><p>Plural InSpec resources are created by leveraging Ruby&#39;s FilterTable module to capture system data. Let&#39;s dig into how FilterTable works so that you can write your own plural resources.</p><h3 id="_10-1-using-filtertable-to-write-a-plural-resource" tabindex="-1"><a class="header-anchor" href="#_10-1-using-filtertable-to-write-a-plural-resource" aria-hidden="true">#</a> 10.1. Using FilterTable to write a Plural Resource</h3><p>FilterTable is intended to help you author plural resources with <strong>stucture data</strong>. You declare a number of columns of data, attach them to a FilterTable object, and then write methods that the FilterTable can call to populate those columns. You can also define custom matchers that make sense for whatever data you are modeling (to go alongside the standard InSpec matchers like <code>be_in</code>,<code>include</code>, and <code>cmp</code>). You wind up with a queryable structure:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>
inspec<span class="token operator">&gt;</span> etc_hosts<span class="token punctuation">.</span>entries
<span class="token operator">=&gt;</span> 
<span class="token punctuation">[</span><span class="token comment">#&lt;struct  ip_address=&quot;127.0.0.1&quot;, primary_name=&quot;localhost&quot;, all_host_names=[&quot;localhost&quot;, &quot;localhost.localdomain&quot;, &quot;localhost4&quot;, &quot;localhost4.localdomain4&quot;]&gt;,</span>
 <span class="token comment">#&lt;struct  ip_address=&quot;::1&quot;, primary_name=&quot;localhost6&quot;, all_host_names=[&quot;localhost6&quot;, &quot;localhost6.localdomain6&quot;]&gt;,</span>
 <span class="token comment">#&lt;struct  ip_address=&quot;127.0.0.1&quot;, primary_name=&quot;test1.org&quot;, all_host_names=[&quot;test1.org&quot;]&gt;,</span>
 <span class="token comment">#&lt;struct  ip_address=&quot;127.0.0.1&quot;, primary_name=&quot;test2.org&quot;, all_host_names=[&quot;test2.org&quot;]&gt;,</span>
 <span class="token comment">#&lt;struct  ip_address=&quot;127.0.0.1&quot;, primary_name=&quot;test3.org&quot;, all_host_names=[&quot;test3.org&quot;]&gt;,</span>
 <span class="token comment">#&lt;struct  ip_address=&quot;127.0.0.1&quot;, primary_name=&quot;test4.org&quot;, all_host_names=[&quot;test4.org&quot;]&gt;]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-1-1-may-i-have-multiple-filtertable-installations-on-a-class" tabindex="-1"><a class="header-anchor" href="#_10-1-1-may-i-have-multiple-filtertable-installations-on-a-class" aria-hidden="true">#</a> 10.1.1. May I have multiple FilterTable installations on a class?</h4><p>In theory, yes - that would be used to implement different data fetching / caching strategies. It is a very advanced usage, and no core resources currently do this, as far as we know.</p><h3 id="_10-2-filtertable-hands-on" tabindex="-1"><a class="header-anchor" href="#_10-2-filtertable-hands-on" aria-hidden="true">#</a> 10.2. FilterTable Hands-On</h3><p>Let&#39;s take a look at the structure of a resource that leverages FilterTable. We will write a dummy resource that models a small group of students. Our resource will describe each student&#39;s name, grade, and the toys they have. Usually, a resource will include some methods that reach out the system under test to populate the FilterTable with real system data, but for now we&#39;re just going to hard-code in some dummy data.</p><ul><li>Create new profile</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>inspec init profile filtertable-test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Place following file as custom resource in <code>libraries</code> directory as <code>filter.rb</code>.</li></ul><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>You can also use <code>inspec init resource &lt;your-resource-name&gt;</code> to create the template for your resource. When following the prompts, you can choose &quot;plural&quot; to create the template for a plural resource.</p></div><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">&#39;inspec/utils/filter&#39;</span></span>

<span class="token keyword">class</span> <span class="token class-name">Filtertable</span> <span class="token operator">&lt;</span> Inspec<span class="token punctuation">.</span>resource<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    name <span class="token string-literal"><span class="token string">&quot;filtertable&quot;</span></span>
    supports platform<span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;linux&quot;</span></span>

    filter_table <span class="token operator">=</span> FilterTable<span class="token punctuation">.</span>create

    filter_table<span class="token punctuation">.</span>register_column<span class="token punctuation">(</span><span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">field</span><span class="token operator">:</span> <span class="token symbol">:name</span><span class="token punctuation">)</span>
    filter_table<span class="token punctuation">.</span>register_column<span class="token punctuation">(</span><span class="token symbol">:grade</span><span class="token punctuation">,</span> <span class="token symbol">field</span><span class="token operator">:</span> <span class="token symbol">:grade</span><span class="token punctuation">)</span>
    filter_table<span class="token punctuation">.</span>register_column<span class="token punctuation">(</span><span class="token symbol">:toys</span><span class="token punctuation">,</span> <span class="token symbol">field</span><span class="token operator">:</span> <span class="token symbol">:toys</span><span class="token punctuation">)</span>

    filter_table<span class="token punctuation">.</span>register_custom_matcher<span class="token punctuation">(</span><span class="token symbol">:has_bike?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>filter_table<span class="token operator">|</span> filter_table<span class="token punctuation">.</span>toys<span class="token punctuation">.</span>flatten<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;bike&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    filter_table<span class="token punctuation">.</span>register_custom_matcher<span class="token punctuation">(</span><span class="token symbol">:has_middle_schooler?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>filter_table<span class="token operator">|</span> filter_table<span class="token punctuation">.</span>grade<span class="token punctuation">.</span>uniq<span class="token punctuation">.</span>any<span class="token operator">?</span><span class="token punctuation">{</span> <span class="token operator">|</span>grade<span class="token operator">|</span> grade <span class="token operator">&gt;=</span> <span class="token number">6</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    
    filter_table<span class="token punctuation">.</span>register_custom_property<span class="token punctuation">(</span><span class="token symbol">:bike_count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>filter_table<span class="token operator">|</span> filter_table<span class="token punctuation">.</span>toys<span class="token punctuation">.</span>flatten<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;bike&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>count <span class="token punctuation">}</span>
    filter_table<span class="token punctuation">.</span>register_custom_property<span class="token punctuation">(</span><span class="token symbol">:middle_schooler_count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>filter_table<span class="token operator">|</span> filter_table<span class="token punctuation">.</span>where<span class="token punctuation">{</span> grade <span class="token operator">&gt;=</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>count <span class="token punctuation">}</span>

    filter_table<span class="token punctuation">.</span>install_filter_methods_on_resource<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token symbol">:fetch_data</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">fetch_data</span></span>
        <span class="token comment"># This method should return an array of hashes - the raw data.  We&#39;ll hardcode it here.</span>
        <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;Sarah&quot;</span></span><span class="token punctuation">,</span> <span class="token symbol">grade</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token symbol">toys</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;car&#39;</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&#39;train&#39;</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&#39;bike&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;John&quot;</span></span><span class="token punctuation">,</span>  <span class="token symbol">grade</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token symbol">toys</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;top&#39;</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&#39;bike&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;Donny&quot;</span></span><span class="token punctuation">,</span> <span class="token symbol">grade</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token symbol">toys</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;train&#39;</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&#39;nintento&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;Susan&quot;</span></span><span class="token punctuation">,</span> <span class="token symbol">grade</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token symbol">toys</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;car&#39;</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&#39;gameboy&#39;</span></span><span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&#39;bike&#39;</span></span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now we&#39;ve got a nice blob of code in a resource file. Let&#39;s load this resource in the InSpec shell and see what we can do with it.</p><h4 id="_10-2-1-run-the-inspec-shell-with-a-custom-resource" tabindex="-1"><a class="header-anchor" href="#_10-2-1-run-the-inspec-shell-with-a-custom-resource" aria-hidden="true">#</a> 10.2.1. Run the InSpec shell with a custom resource</h4><p>Invoking the InSpec shell with <code>inspec shell</code> will give you access to all the core InSpec resources by default, but InSpec does not automatically know about your locally defined resources unless you point them out. If you&#39;re testing a local resource, use the <code>--depends</code> flag and pass in the profile directory that your resource lives in.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>inspec shell --depends /path/to/profile/root/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_10-2-2-fetching-data" tabindex="-1"><a class="header-anchor" href="#_10-2-2-fetching-data" aria-hidden="true">#</a> 10.2.2. Fetching Data</h4><p>FilterTables organize their data into columns. Your resource will declare a number of columns using the <code>register_column</code> method.</p><p>Once you declare the columns that you want in your FilterTable (<code>name</code>, <code>grade</code>, and <code>toys</code> in our example), you need to insert some data into them using the <code>install_filter_methods_on_resource</code> method. That method takes two args -- <code>self</code> and a data structure that is an array of hashes. The array of hashes will be matched up to the columns you defined using the hashes&#39; keys. For our example we hard-coded this data structure, which is returned by the <code>fetch_data</code> method.</p><p>As we mentioned earlier, a real InSpec resource will include methods that will populate the resource with real system data. Take a look at the <a href="https://github.com/inspec/inspec/blob/63a5fd26a6925b1570ee80e2953d259b58c3012e/lib/inspec/resources/firewalld.rb" target="_blank" rel="noopener noreferrer">Firewalld resource<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> for an example of a resource that does this -- note the resource is ultimately invoking a shell command (<code>firewall-ctl</code>) to populate its FilterTable. There are plenty of other InSpec resources using FilterTable that you can find in the source code if you are interested in more examples.</p><h4 id="_10-2-3-custom-matcher-examples" tabindex="-1"><a class="header-anchor" href="#_10-2-3-custom-matcher-examples" aria-hidden="true">#</a> 10.2.3. Custom Matcher Examples</h4><p>After we define our FilterTable&#39;s columns, we can also define custom matchers just like we do in singluar resources using <code>register_custom_matcher</code>. That function takes a block as an argument that defines a boolean expression that tells InSpec when that matcher should return <code>true</code>. Note that the matcher&#39;s logic can get pretty complicated -- that&#39;s why we&#39;re shoving all of it into a resource so we can avoid having to write complicated tests.</p><ul><li><code>has_bike?</code></li></ul><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe filtertable<span class="token punctuation">.</span>where<span class="token punctuation">(</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;Donny&quot;</span></span> <span class="token punctuation">)</span> <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should have_bike <span class="token punctuation">}</span>
<span class="token keyword">end</span>  

<span class="token symbol">Profile</span><span class="token operator">:</span> inspec<span class="token operator">-</span>shell
<span class="token symbol">Version</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">not</span> specified<span class="token punctuation">)</span>

  filtertable with name <span class="token operator">==</span> <span class="token string-literal"><span class="token string">&quot;Donny&quot;</span></span>
     ×  should have bike
     expected <span class="token comment">#has_bike? to return true, got false</span>

Test Summary<span class="token operator">:</span> <span class="token number">0</span> successful<span class="token punctuation">,</span> <span class="token number">1</span> failure<span class="token punctuation">,</span> <span class="token number">0</span> skipped
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe filtertable<span class="token punctuation">.</span>where<span class="token punctuation">(</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;Sarah&quot;</span></span> <span class="token punctuation">)</span> <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should have_bike <span class="token punctuation">}</span>  
<span class="token keyword">end</span>  

<span class="token symbol">Profile</span><span class="token operator">:</span> inspec<span class="token operator">-</span>shell
<span class="token symbol">Version</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">not</span> specified<span class="token punctuation">)</span>

  filtertable with name <span class="token operator">==</span> <span class="token string-literal"><span class="token string">&quot;Sarah&quot;</span></span>
     ✔  should have bike

Test Summary<span class="token operator">:</span> <span class="token number">1</span> successful<span class="token punctuation">,</span> <span class="token number">0</span> failures<span class="token punctuation">,</span> <span class="token number">0</span> skipped

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the simplest examples, we filter the table down to a single student using <code>where</code> (more on <code>where</code> in a minute) and invoke a matcher that checks if that student has a <code>bike</code> in their list of toys. We can write matchers to have whatever logic we like. For example, while <code>has_bike</code> checks if <em>all</em> of the students in the table under test have a bike, <code>has_middle_schooler</code> checks if <em>any</em> student in the table under test is in the 7th grade or higher.</p><ul><li><code>has_middle_schooler?</code></li></ul><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe filtertable<span class="token punctuation">.</span>where <span class="token punctuation">{</span> name <span class="token operator">=~</span> <span class="token regex-literal"><span class="token regex">/Sarah|John/</span></span> <span class="token punctuation">}</span> <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should have_middle_schooler <span class="token punctuation">}</span>
<span class="token keyword">end</span>

<span class="token symbol">Profile</span><span class="token operator">:</span>   inspec<span class="token operator">-</span>shell
<span class="token symbol">Version</span><span class="token operator">:</span>   <span class="token punctuation">(</span><span class="token keyword">not</span> specified<span class="token punctuation">)</span>
Target <span class="token constant">ID</span><span class="token operator">:</span> 

  filtertable with name <span class="token operator">=~</span> <span class="token regex-literal"><span class="token regex">/Sarah|John/</span></span>
     ✔  is expected to have middle schooler

Test Summary<span class="token operator">:</span> <span class="token number">1</span> successful<span class="token punctuation">,</span> <span class="token number">0</span> failures<span class="token punctuation">,</span> <span class="token number">0</span> skipped

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-2-4-custom-property" tabindex="-1"><a class="header-anchor" href="#_10-2-4-custom-property" aria-hidden="true">#</a> 10.2.4. Custom Property</h4><p>We can also declare custom properties for our resource, using whatever logic we like just like the matchers. Properties can be referred to with <code>its</code> syntax in an InSpec test.</p><ul><li><code>bike_count</code></li></ul><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe filtertable <span class="token keyword">do</span>
  its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;bike_count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should eq <span class="token number">3</span> <span class="token punctuation">}</span>  
<span class="token keyword">end</span>  

<span class="token symbol">Profile</span><span class="token operator">:</span>   inspec<span class="token operator">-</span>shell
<span class="token symbol">Version</span><span class="token operator">:</span>   <span class="token punctuation">(</span><span class="token keyword">not</span> specified<span class="token punctuation">)</span>
Target <span class="token constant">ID</span><span class="token operator">:</span> 

  filtertable
     ✔  bike_count is expected to eq <span class="token number">3</span>

Test Summary<span class="token operator">:</span> <span class="token number">1</span> successful<span class="token punctuation">,</span> <span class="token number">0</span> failures<span class="token punctuation">,</span> <span class="token number">0</span> skipped
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>middle_schooler_count</code></li></ul><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe filtertable <span class="token keyword">do</span>
   its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;middle_schooler_count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should eq <span class="token number">4</span> <span class="token punctuation">}</span>     
<span class="token keyword">end</span>  

<span class="token symbol">Profile</span><span class="token operator">:</span>   inspec<span class="token operator">-</span>shell
<span class="token symbol">Version</span><span class="token operator">:</span>   <span class="token punctuation">(</span><span class="token keyword">not</span> specified<span class="token punctuation">)</span>
Target <span class="token constant">ID</span><span class="token operator">:</span> 

  filtertable
     ×  middle_schooler_count is expected to eq <span class="token number">4</span>
     
     <span class="token symbol">expected</span><span class="token operator">:</span> <span class="token number">4</span>
          <span class="token symbol">got</span><span class="token operator">:</span> <span class="token number">2</span>
     
     <span class="token punctuation">(</span>compared using <span class="token operator">==</span><span class="token punctuation">)</span>


Test Summary<span class="token operator">:</span> <span class="token number">0</span> successful<span class="token punctuation">,</span> <span class="token number">1</span> failure<span class="token punctuation">,</span> <span class="token number">0</span> skipped

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-2-5-suggested-activity" tabindex="-1"><a class="header-anchor" href="#_10-2-5-suggested-activity" aria-hidden="true">#</a> 10.2.5. Suggested activity</h4><p>To get a better feel for how FilterTable works, we suggest you add a few extra features to the sample given above.</p><ul><li><strong>Add a field to the data array and reflect the change in filter table</strong></li><li><strong>Add a custom matcher</strong></li><li><strong>Add a custom property</strong></li></ul><p>Then write some tests to see how your new matchers and properties work.</p><h3 id="_10-3-predefined-methods-for-filtertable" tabindex="-1"><a class="header-anchor" href="#_10-3-predefined-methods-for-filtertable" aria-hidden="true">#</a> 10.3. Predefined Methods for FilterTable</h3><p>When you create a new FilterTable, these methods are now installed automatically: <code>where</code>, <code>entries</code>, <code>raw_data</code>, <code>count</code>, and <code>exist?</code>. Each is very useful both for writing tests in and of themselves and for creating custom matchers and properties inside the resource code.</p><h4 id="_10-3-1-the-where-method" tabindex="-1"><a class="header-anchor" href="#_10-3-1-the-where-method" aria-hidden="true">#</a> 10.3.1 The <code>where</code> method</h4><p>You may have already noticed that a bunch of our example tests are using the <code>where</code> method on the overall FilterTable. This method returns a new FilterTable object created from the rows of the original table that match the query provided to <code>where</code> like an argument, like the <code>WHERE</code> clause in a SQL query. This method is extremely flexible; we give some examples below.</p><p>If you call <code>where</code> as a method with no block and passing hash params, with keys you know are in the raw data, it will fetch the raw data, then filter row-wise and return the resulting Table.</p><p>Multiple criteria are joined with a logical AND.</p><p>The filtering is fancy, not just straight equality.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;red&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">2</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># Regexes</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token regex-literal"><span class="token regex">/^re/</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">2</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># It eventually falls out to === comparison</span>
  <span class="token comment"># Here, range membership 1..2</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">thing_id</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">1.</span><span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">2</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># irregular rows are supported</span>
  <span class="token comment"># Only one row has the :tackiness key, with value &#39;very&#39;.</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">tackiness</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&#39;very&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">1</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_10-3-1-1-where-method-with-blocks" tabindex="-1"><a class="header-anchor" href="#_10-3-1-1-where-method-with-blocks" aria-hidden="true">#</a> 10.3.1.1. <code>where</code> method with blocks</h5><p>You can also call the <code>where</code> method with a block. The block is executed row-wise. If it returns truthy, the row is included in the results. Each field declared with the <code>register_custom_property</code> configuration method is available as a data accessor.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>
  <span class="token comment"># You can have any logic you want in the block</span>
  describe things<span class="token punctuation">.</span>where <span class="token punctuation">{</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">3</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># You can access any fields you declared using `register_column`</span>
  describe things<span class="token punctuation">.</span>where <span class="token punctuation">{</span> thing_id <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">1</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_10-3-1-2-chaining-where-calls-and-tables-without-re-fetching-raw-data" tabindex="-1"><a class="header-anchor" href="#_10-3-1-2-chaining-where-calls-and-tables-without-re-fetching-raw-data" aria-hidden="true">#</a> 10.3.1.2. Chaining <code>where</code> calls and Tables without re-fetching raw data</h5><p>The first time <code>where</code> is called, the data fetcher method is called. <code>where</code> performs filtration on the raw data table. It then constructs a new <code>FilterTable::Table</code>, directly passing in the filtered raw data; this is then the return value from <code>where</code>.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>  <span class="token comment"># This only calls fetch_data once</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token symbol">:red</span><span class="token punctuation">)</span><span class="token punctuation">.</span>where <span class="token punctuation">{</span> thing_id <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">1</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Some other methods return a Table object, and they may be chained without a re-fetch as well.</p><h4 id="_10-3-2-the-entries-method" tabindex="-1"><a class="header-anchor" href="#_10-3-2-the-entries-method" aria-hidden="true">#</a> 10.3.2. The <code>entries</code> method</h4><p>The other <code>register_filter_method</code> call enables a pre-defined method, <code>entries</code>. <code>entries</code> is much simpler than <code>where</code> - in fact, its behavior is unrelated. It returns an encapsulated version of the raw data - a plain array, containing Structs as row-entries. Each struct has an attribute for each time you called <code>register_column</code>.</p><p>Importantly, note that the return value of <code>entries</code> is not the resource, nor the Table - in other words, you cannot chain it. However, you can call <code>entries</code> on any Table.</p><p>If you call <code>entries</code> without chaining it after <code>where</code>, calling entries will trigger the call to the data fetching method.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>
  <span class="token comment"># Access the entries array</span>
  describe things<span class="token punctuation">.</span>entries <span class="token keyword">do</span>
    <span class="token comment"># This is Array#count, not the resource&#39;s `count` method</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">3</span><span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># Access the entries array after chaining off of where</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token symbol">:red</span><span class="token punctuation">)</span><span class="token punctuation">.</span>entries <span class="token keyword">do</span>
    <span class="token comment"># This is Array#count, not the resource&#39;s or table&#39;s `count` method</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">2</span><span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># You can access the struct elements as a method, as a hash keyed on symbol, or as a hash keyed on string</span>
  describe things<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>first<span class="token punctuation">.</span>color <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should cmp <span class="token symbol">:red</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
  describe things<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>first<span class="token punctuation">[</span><span class="token symbol">:color</span><span class="token punctuation">]</span> <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should cmp <span class="token symbol">:red</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
  describe things<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>first<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&#39;color&#39;</span></span><span class="token punctuation">]</span> <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should cmp <span class="token symbol">:red</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-3-3-the-exist-matcher" tabindex="-1"><a class="header-anchor" href="#_10-3-3-the-exist-matcher" aria-hidden="true">#</a> 10.3.3. The <code>exist?</code> matcher</h4><p>This <code>register_custom_matcher</code> call:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>filter_table_config<span class="token punctuation">.</span>register_custom_matcher<span class="token punctuation">(</span><span class="token symbol">:exist?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>filter_table<span class="token operator">|</span> <span class="token operator">!</span>filter_table<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>empty<span class="token operator">?</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>causes a new method to be defined on both the resource class and the Table class. The body of the method is taken from the block that is provided. When the method it called, it will receive the <code>FilterTable::Table</code> instance as its first parameter. (It may also accept a second param, but that doesn&#39;t make sense for this method - see thing_ids).</p><p>As when you are implementing matchers on a singular resource, the only thing that distinguishes this as a matcher is the fact that it ends in <code>?</code>.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>  <span class="token comment"># Bare call on the matcher (called as a method on the resource)</span>
  describe things <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should exist <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># Chained on where (called as a method on the Table)</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token symbol">:red</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should exist <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-3-4-the-count-property" tabindex="-1"><a class="header-anchor" href="#_10-3-4-the-count-property" aria-hidden="true">#</a> 10.3.4. The <code>count</code> property</h4><p>This <code>register_custom_property</code> call:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>filter_table_config<span class="token punctuation">.</span>register_custom_property<span class="token punctuation">(</span><span class="token symbol">:count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>filter_table<span class="token operator">|</span> filter_table<span class="token punctuation">.</span>entries<span class="token punctuation">.</span>count <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>causes a new method to be defined on both the resource class and the Table class. As with <code>exists?</code>, the body is taken from the block.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>  <span class="token comment"># Bare call on the property (called as a method on the resource)</span>
  describe things <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">3</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>

  <span class="token comment"># Chained on where (called as a method on the Table)</span>
  describe things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token symbol">:red</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;count&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token number">2</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-3-5-the-raw-data-method" tabindex="-1"><a class="header-anchor" href="#_10-3-5-the-raw-data-method" aria-hidden="true">#</a> 10.3.5. The <code>raw_data</code> method</h4><p>Unlike <code>entries</code>, which wraps each row in a Struct and omits undeclared fields, <code>raw_data</code> simply returns the actual raw data array-of-hashes. It is not <code>dup</code>&#39;d. People <em>definitely</em> use this out in the wild, even though it returns a rougher data structure.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>  tacky_things <span class="token operator">=</span> things<span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token symbol">color</span><span class="token operator">:</span> <span class="token symbol">:blue</span><span class="token punctuation">)</span><span class="token punctuation">.</span>raw_data<span class="token punctuation">.</span>select <span class="token punctuation">{</span> <span class="token operator">|</span>row<span class="token operator">|</span> row<span class="token punctuation">[</span><span class="token symbol">:tackiness</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  tacky_things<span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token operator">|</span>row<span class="token operator">|</span> row<span class="token punctuation">[</span><span class="token symbol">:thing_id</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>thing_id<span class="token operator">|</span>
    <span class="token comment"># Use to audit a singular Thing</span>
    describe thing<span class="token punctuation">(</span>thing_id<span class="token punctuation">)</span> <span class="token keyword">do</span>
      it <span class="token punctuation">{</span> should_not be_paisley <span class="token punctuation">}</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-4-filtertable-examples" tabindex="-1"><a class="header-anchor" href="#_10-4-filtertable-examples" aria-hidden="true">#</a> 10.4 FilterTable Examples</h3><p>FilterTable is a very flexible and powerful class that works well when designing plural resources. As always, if you ned to write a plural resource, we encourage you to examine existing resources in the InSpec source code to see how other developers have implemented it. Some good examples include:</p><ul><li><a href="https://github.com/inspec/inspec/blob/63a5fd26a6925b1570ee80e2953d259b58c3012e/lib/inspec/resources/firewalld.rb" target="_blank" rel="noopener noreferrer">FirewallD<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/inspec/inspec/blob/63a5fd26a6925b1570ee80e2953d259b58c3012e/lib/inspec/resources/users.rb" target="_blank" rel="noopener noreferrer">Users<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/inspec/inspec/blob/63a5fd26a6925b1570ee80e2953d259b58c3012e/lib/inspec/resources/shadow.rb" target="_blank" rel="noopener noreferrer">Shadow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/mitre/saf-training/edit/main/courses/advanced/10.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">Last update: </span><span class="info">6/28/2022, 8:58:30 PM</span></div><div class="meta-item contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: ecrodriguez@mm279976-pc.lan">Emily Rodriguez</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/saf-training/courses/advanced/09.html" class="nav-link prev" aria-label="9. Create a Custom Resource - The Docker Example"><div class="hint"><span class="arrow left"></span>Prev</div><div class="link"><span class="icon iconfont icon-page" style=""></span>9. Create a Custom Resource - The Docker Example</div></a><a href="/saf-training/courses/advanced/11.html" class="nav-link next" aria-label="11. Dissecting Resources"><div class="hint">Next<span class="arrow right"></span></div><div class="link">11. Dissecting Resources<span class="icon iconfont icon-page" style=""></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Apache-2.0 | Copyright © 2022 - The MITRE Corporation</div><div class="copyright">Copyright © 2022 Aaron Lippold</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/saf-training/assets/app.3b4d192a.js" defer></script>
  </body>
</html>
