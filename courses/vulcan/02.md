---
index: 2
title: 2. Security Guidance
author: Ryan Lakey
headerDepth: 3
---

## 2.1 Security Guidance

Before we go further, let's discuss what we mean by "security guidance" and some of its characteristics that matter to us as security (and automation!) practitioners.

**Security guidance** is documentation that defines what constitutes a secure configuration for a software component or category of components. It includes organizational requirements for security, best practices, and instructions on how to fix problems. It answers the important question that all developers and engineers ask when they want to secure their software -- "What counts as 'secure' for my system in the first place?"

Most software projects will (or at least *should*) align themselves to a particular source for security guidance and follow it as a baseline that answers this question. For example, many commercial companies (and even some civilian government agencies) use the Center for Internet Security Benchmarks (CIS Benchmarks) as their baseline, while software deployed by the US Department of Defense is required to comply with the Defense Information Systems Agency's Security Technical Implementation Guides (STIGs), broadly speaking.

There are many different types of guidance documentation available to software developers. Software vendors often publish best practices guides, administration guides, or business requirements documents to instruct their userbase on how to best make use of the product. Security guidance is ultimately just another type of guidance document for effectively using a piece of software.

::: warning Security Requirements Are Functional Requirements!
Software developers have a historical tendency to consider security as a completely separate activity from the basic process of building a software product. In a DevSecOps environment, however, security is just another functional requirement of your code.

You cannot ship code if it does not meet a functional requirement. Likewise, you cannot ship code that does not meet a security requirement!
:::

## 2.2 Security Guidance in the DOD

**Security guidance** in the DOD comes in two forms: Security Requirements Guides (SRGs) and Security Technical Implementation Guides (STIGs).

### 2.2.1 SRGs
SRGs are a collection of requirements applicable to a given technology family, product category, or organization in general. They are non-product specific requirements used to mitigate common security vulnerabilities encountered across information technology systems and applications. SRGs are developed and maintained by DISA and are the source documents from which a STIG is made.

One example of a requirement from the 165 *General Purpose OS SRG* requirements is as follows:

`SRG ID:` SRG-OS-000021  
`CCI ID:` CCI-000044: The information system enforces the organization-defined limit of consecutive invalid logon attempts by a user during the organization-defined time period.  
`NIST 800-53 Control:` AC-7 a  
`Title:` The operating system must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.  
`Discussion:` By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.  
`Check Text:` Verify that the operating system enforces the limit of three consecutive invalid logon attempts by a user during a 15-minute time period. If it does not, this is a finding.  
`Fix Text:` Configure the operating system to enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.  

SRGs come in a number of broad categories such as "Web Server" and "Database". The full list is provided below for reference.

::: note Current SRGs
Application
- AAA Services
- Application Server
- Central Log Server
- Container Platform
- Domain Name System
- Database
- Mainframe Product
- Unified Endpoint Management Agent
- Unified Endpoint Management Server
- Web Server

Network
- Application Layer Gateway
- Firewall
- Intrusion Detection and Prevention System
- Layer 2 Switch
- Network Device Management
- Router
- SDN Controller
- Voice Video Endpoint
- Voice Video Session Management
- VPN

Operating System
- General Purpose OS
- Virtual Machine Manager
:::

### 2.2.2 STIGs
STIGs are proscriptive, detailed, and comprehensive hardening guides for US DOD systems based on DOD and National Institute of Standards and Technology (NIST) requirements. These guides and their components can be any piece of technology that needs a secure configuration -- operating systems, web servers, applications, routers, firewalls, and so on.

Additionally DISA defines a STIG as *"An operationally implementable compendium of DoD IA controls, Security Regulations, and Best Practices for Securing an IA or IA-Enabled Device (Operating System, Network, Application Software, etc.). STIGs provide guidance for areas including mitigating insider threats, containing applications, preventing lateral movements, and securing information system credentials. The goals of STIG implementation are Intrusion Avoidance, Intrusion Detection, Response and Recovery.‚Äù*

STIGs can be written by DISA themselves as required but an interested vendor can also write a STIG through the [Vendor STIG Development Process](https://public.cyber.mil/stigs/vendor-process/). Regardless of who develops it all official STIGs go through risk analysis by DISA Risk Management Executive, are digitally signed, and posted on cyber.mil. Once posted they become mandatory for all DoD components.

A published STIG itself is composed of the requirements from the applicable SRGs that are deemed "Applicable - Configurable" and have under gone technical writing to create check and fix content. The publication artifacts consist of an Overview document, a Revision History document, and an XCCDF XML document with the controls.

To close the loop on our SRG requirement example above, an "Applicable - Configurable" requirement may look like this once completed for a specific product, Photon OS in this example.

`Title:` The Photon operating system must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.  
`Discussion:` By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.  
`Check Text:`  
```
At the command line, run the following commands to verify accounts are locked after three consecutive invalid logon attempts by a user during a 15-minute time period:

# grep '^deny =' /etc/security/faillock.conf

Example result:

deny = 3

If the "deny" option is not set to "3" or less (but not "0"), is missing or commented out, this is a finding.

# grep '^fail_interval =' /etc/security/faillock.conf

Example result:

fail_interval = 900

If the "fail_interval" option is not set to "900" or more, is missing or commented out, this is a finding.

Note: If faillock.conf is not used to configure the "pam_faillock.so" module, then these options may be specified on the faillock lines in the system-auth and system-account PAM files.
```
`Fix Text:`  
```
Navigate to and open:

/etc/security/faillock.conf

Add or update the following lines:

deny = 3
fail_interval = 900
```

## 2.3 Where Do All The Requirements Come From, Anyway?
Published directives from the DOD's Chief Information Officer (DOD CIO) describe the overall Risk Management Framework for DOD Systems (DOD RMF). The DOD RMF requires all information systems across the DOD to be categorized according to how much risk they represent to the organization if compromised. It also requires system owners to select controls from the National Institute of Standards and Technology's (NIST) security control families.

::: note NIST Control Families 
You may be familiar with the control families from [NIST Special Publication 800-53](https://csrc.nist.gov/pubs/sp/800/53/r5/upd1/final), because almost all US Government agencies (and quite a few companies) use them as the authoritative list that defines what security controls are.
:::

To speed up the process of control selection, DISA created and published the [Control Correlation Identifiers (CCIs)](https://public.cyber.mil/stigs/cci/), which describe *actions that can be taken* to cover the NIST security control families. CCIs are a bridge between the extremely high-level policy  documents that govern the whole DOD and the low-level documents (i.e. STIGs) that actually tell people how to implement that policy.

The SRGs themselves are *subsets* of CCIs that apply to general categories of information systems. This means that individual system owners do not have to figure out on their own which control families need to be covered for their system; they can instead say "I am deploying a router, so I must cover the requirements selected in the Router SRG."

As described before, an SRG can then be tailored into STIGs that give security guidance for individual pieces of software. The full chain of requirements to implementation therefore looks like this:

![Process Flow of DOD Requirements Assembly Into SRGs/STIGs](../../assets/img/STIGSources.png)
