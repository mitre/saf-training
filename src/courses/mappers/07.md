---
order: 7
next: 08.md
title: Required OHDF Schema Fields
author: Charles Hu
---

## Required OHDF Schema Fields

Not all fields in the schema have to be filled or even used in an OHDF mapper. In practice, most implementations either provide a blank field or omit an unused field entirely.

Note that just because you can skip a schema field does not mean that you should. Always aim to maximize the filled fields in your mapper and only skip a field as a last resort if no applicable equivalent exists in your source data. Consider required fields as priority fields that you should aim to fill out first instead of the bare minimum necessary to create a mapper.

The fields that are specifically required by the schema are as follows:

::: details Required Fields
```json
{
  platform: {
    name,
    release
  },
  version,
  statistics,
  profiles: [
    0: {
      name,
      sha256,
      supports,
      attributes,
      groups,
      controls: [
        0: {
          id,
          impact,
          refs,
          tags,
          source_location,
          results: [
            0: {
              code_desc,
              start_time
            },
          ]
        },
      ]
    },
  ]
}
```
:::

## In Context

The required fields in context of the full schema are shown below:

::: details Full Schema
```json
{
  platform: {                // required field
    name,                    // required field
    release,                 // required field
    target_id
  },
  version,                   // required field
  statistics: {              // required field
    duration
  },
  profiles: [                // required field
    0: {
      name,                  // required field
      version,
      sha256,                // required field
      title,
      maintainer,
      summary,
      license,
      copyright,
      copyright_email,
      supports,              // required field
      attributes,            // required field
      groups,                // required field
      controls: [            // required field
        0: {
          id,                // required field
          title,
          desc,
          descriptions,
          impact,            // required field
          refs,              // required field
          tags,              // required field
          code,
          source_location,   // required field
          results: [         // required field
            0: {
              status,
              code_desc,     // required field
              message,
              run_time,
              start_time     // required field
            }
          ]
        },
      ],
      status
    },
  ],
  passthrough: {
    auxiliary_data: [
      0: {
        name,
        data
      },
    ],
    raw
  }
}
```
:::

## Example

Here's an example of GoSec source data and the converted OHDF file that has been annotated to show the required/not required fields.

Here are some key questions to keep note of while reading through the example:

- Why is a required field filled/unfilled?
- Why is an unrequired field filled/unfilled?
- Is there an appropriate field from the source data to fill in an unfilled field in the OHDF file?

::: details Source Data
```json
{
  "Golang errors": {},
  "Issues": [
    {
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "rule_id": "G304",
      "details": "Potential file inclusion via variable",
      "file": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go",
      "code": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
      "line": "83",
      "column": "14",
      "nosec": false,
      "suppressions": null
    }
  ],
  "Stats": {
    "files": 199,
    "lines": 12401,
    "nosec": 0,
    "found": 7
  },
  "GosecVersion": "dev"
}
```
:::

::: details Converted OHDF File
```json
{
  "platform": {                   // required
    "name": "Heimdall Tools",     // required
    "release": "2.10.8"           // required
  },
  "version": "2.10.8",            // required
  "statistics": {},               // required
  "profiles": [                   // required
    {
      "name": "Gosec scanner",    // required
      "title": "gosec",           // not required
      "version": "dev",           // not required
      "supports": [],             // required
      "attributes": [],           // required
      "groups": [],               // required
      "status": "loaded",         // not required
      "controls": [               // required
        {
          "tags": {                                           // required
            "nist": ["SI-10"],
            "cwe": {
              "id": "22",
              "url": "https://cwe.mitre.org/data/definitions/22.html"
            },
            "nosec": "",
            "suppressions": "",
            "severity": "MEDIUM",
            "confidence": "HIGH"
          },
          "refs": [],                                         // required
          "source_location": {},                              // required
          "title": "Potential file inclusion via variable",   // not required
          "id": "G304",                                       // required
          "desc": "",                                         // not required
          "impact": 0.5,                                      // required
          "results": [                                        // required
            {
              "status": "failed",   // not required
              "code_desc": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",  // required
              "message": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go, line:83, column:14", // not required
              "start_time": ""      // required
            }
          ]
        }
      ],
      "sha256": "d0506f4b7715bf8b1cd81a8a87ab8efcce41ebeb2b5ec5fcfb23d3bdd136f48c"  // required
    }
  ],
  "passthrough": {                                                            // not required
    "auxiliary_data": [{ "name": "Gosec", "data": { "Golang errors": {} } }]  // not required
  }
}
```
:::
