---
order: 6
next: 07.md
title: Formal OHDF Schema Definition
author: Charles Hu
---

## Breaking Down the Formal OHDF Schema

We can break down the formal OHDF schema in the same manner as before by observing each structure in the hierarchy from a top-down view.

::: note Full OHDF Schema
The following section contains a breakdown of a streamlined version of the OHDF schema. For the full and up-to-date version, see [here](https://saf.mitre.org/framework/normalize/ohdf-schema). Visit [here](https://github.com/mitre/heimdall2/blob/master/libs/inspecjs/src/generated_parsers/v_1_0/exec-json.ts) for the technical implementation of the schema.
:::

:::note Required Fields
Not all fields are required. This will be expanded upon in the next section.
:::

### 1. <i>Exec JSON</i>
 
Field Name | Definition
-|-
`platform` | Platform substructure (see `Additional Structures`).
`profiles` | Profiles substructure (see below).
`statistics` | Statistics substructure (see below).
`version` | Version of tool generating the file.

### 2. <i>**Profiles**</i>

Field Name | Definition
-|-
`name` | Name of profile, usually the original security tool; must be unique.
`version` | Version of security tool.
`sha256` | Checksum of the profile (NOTE: AUTOMATICALLY GENERATED BY HDF CONVERTERS, DO NOT POPULATE).
`title` | Title of security tool; must be human readable.
`maintainer` | Maintainer(s).
`summary` | Summary of security data (e.g., the STIG header).
`license` | Copyright license.
`copyright` | Copyright holder.
`copyright_email` | Copyright holder's email.
`supports` | Supported platform targets.
`attributes` | Inputs/attributes used in scan.
`groups` | Set of descriptions for the control groups (e.g., control IDs).
`controls` | Controls substructure (see below).
`status` | Status of profile (typically 'loaded').
`status_message` | Reason for the status.
`skip_message` | Reason for skipping this profile if skipped.
`depends` | Set of dependencies this profile depends on (e.g., an overlay profile is dependent on another profile).
`parent_profile` | Name of the parent profile if this profile is a dependency of another profile.
`description` | Description of profile; should be more detailed than summary.
`inspec_version` | The version of the Inspec tool used to generate this profile.

#### Knowledge Check

Given a snippet of GoSec data, try and identify what information is applicable to the <i>**Profiles**</i> structure and which field they would correlate with.

::: details GoSec Source Data
```json
{
  "Golang errors": {},
  "Issues": [
    {
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "rule_id": "G304",
      "details": "Potential file inclusion via variable",
      "file": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go",
      "code": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
      "line": "83",
      "column": "14",
      "nosec": false,
      "suppressions": null
    }
  ],
  "Stats": {
    "files": 199,
    "lines": 12401,
    "nosec": 0,
    "found": 7
  },
  "GosecVersion": "dev"
}
```
:::

::: details OHDF Converted GoSec Data
```json
"profiles": [
  {
    "name": "Gosec scanner",
    "title": "gosec",
    "version": "dev",
    "supports": [],
    "attributes": [],
    "groups": [],
    "status": "loaded",
    "controls": [
      ...
    ],
    "sha256": "d0506f4b7715bf8b1cd81a8a87ab8efcce41ebeb2b5ec5fcfb23d3bdd136f48c"
  }
]
```
:::

### 3. <i>**Controls**</i>
Field Name | Definition
-|-
`id` | ID of control, used for sorting.
`title` | Title of control.
`desc` | The overarching description of the control.
`descriptions` | Additional descriptions; usually 'check' and 'fix' text for control.
`impact` | Security severity of control. On a scale of 0 to 1. This metric is aligned with the [Common Vulnerability Scoring System (CVSS)](https://www.first.org/cvss/).
`refs` | References to external control documentation.
`tags` | Control tags; typically correlate to existing vulnerability/weakness database (e.g., NIST, CVE, CWE).
`code` | Control source code for code preservation.
`source_location` | Location of control within source code.
`results` | Results substructure (see below).
`waiver_data` | Information on waiver if applicable.
`attestation_data` | Information on attestation if applicable.

#### Knowledge Check

Given a snippet of GoSec data, try and identify what information is applicable to the <i>**Controls**</i> structure and which field they would correlate with.

::: details GoSec Source Data
```json
{
  "Golang errors": {},
  "Issues": [
    {
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "rule_id": "G304",
      "details": "Potential file inclusion via variable",
      "file": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go",
      "code": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
      "line": "83",
      "column": "14",
      "nosec": false,
      "suppressions": null
    }
  ],
  "Stats": {
    "files": 199,
    "lines": 12401,
    "nosec": 0,
    "found": 7
  },
  "GosecVersion": "dev"
}
```
:::

::: details OHDF Converted GoSec Data
```json
"controls": [
  {
    "tags": {
      "nist": ["SI-10"],
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "nosec": "",
      "suppressions": "",
      "severity": "MEDIUM",
      "confidence": "HIGH"
    },
    "refs": [],
    "source_location": {},
    "title": "Potential file inclusion via variable",
    "id": "G304",
    "desc": "",
    "impact": 0.5,
    "results": [
      ...
    ]
  }
],
```
:::

### 4. <i>**Results**</i>

Field Name | Definition
-|-
`status` | `passed`/`failed` status of test (other status include `skipped` and `error`).
`skip_message` | Reasoning for if test has `skipped` status.
`code_desc` | Test expectations as defined by control.
`exception` | Type of exception if one was thrown.
`backtrace` | Backtrace of exception if one was thrown.
`message` | Explanation of test status; typically in the form of expected and actual results.
`resource` | Resources used in the test (e.g., Inspec).
`resource_id` | The unique ID of the used resources.
`run_time` | Overall runtime of test.
`start_time` | Starting time of test.

#### Knowledge Check

Given a snippet of GoSec data, try and identify what information is applicable to the <i>**Results**</i> structure and which field they would correlate with.

::: details GoSec Source Data
```json
{
  "Golang errors": {},
  "Issues": [
    {
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "rule_id": "G304",
      "details": "Potential file inclusion via variable",
      "file": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go",
      "code": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
      "line": "83",
      "column": "14",
      "nosec": false,
      "suppressions": null
    }
  ],
  "Stats": {
    "files": 199,
    "lines": 12401,
    "nosec": 0,
    "found": 7
  },
  "GosecVersion": "dev"
}
```
:::

::: details OHDF Converted GoSec Data
```json
"results": [
  {
    "status": "failed",
    "code_desc": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
    "message": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go, line:83, column:14",
    "start_time": ""
  }
]
```
:::

### 5. Additional Structures

There are additional structures in the OHDF schema which are used for metadata/extraneous information storage. These exist alongside the <i>profiles</i> structure on the top level of the HDF schema. The general structure for the top level of the HDF schema is as follows:

Field Name | Definition
-|-
`platform` | Information on the platform producing the export.
`platform.name` | Name of platform export was run on.
`platform.release` | Platform version.
`platform.target_id` | Platform target ID (i.e., further identifying information on platform).
`statistics` | Statistics relating to target scan run.
`statistics.controls` | Break down of control statistics by result status.
`statistics.duration` | Duration of run (in seconds).
`profiles` | Profiles structure.
`passthrough` | Extraneous information storage.
`passthrough.auxiliary_data` | Storage for unused data from the sample file.
`passthrough.auxiliary_data.name` | Name of auxiliary data source.
`passthrough.auxiliary_data.data` | Auxiliary data.
`passthrough.raw` | Raw data dump of input security service export.

#### Knowledge Check

Given a snippet of GoSec data, try and identify what information is applicable to the additional structures and which field they would correlate with.

::: details GoSec Source Data
```json
{
  "Golang errors": {},
  "Issues": [
    {
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "rule_id": "G304",
      "details": "Potential file inclusion via variable",
      "file": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go",
      "code": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
      "line": "83",
      "column": "14",
      "nosec": false,
      "suppressions": null
    }
  ],
  "Stats": {
    "files": 199,
    "lines": 12401,
    "nosec": 0,
    "found": 7
  },
  "GosecVersion": "dev"
}
```
:::

::: details OHDF Converted GoSec Data
```json
{
  "platform": { "name": "Heimdall Tools", "release": "2.10.8" },
  "version": "2.10.8",
  "statistics": {},
  "profiles": [],
  "passthrough": {
    "auxiliary_data": [{ "name": "Gosec", "data": { "Golang errors": {} } }]
  }
}
```
:::

## Knowledge Check

:::details What is the purpose of <i>Profiles</i>, <i>Controls</i>, and <i>Results</i>?
- <i>Profiles</i> provides a high-level overview of the security tool result and the targeted system (i.e., metadata).

- <i>Controls</i> provides information on the security requirements being applied to the target system.

- <i>Results</i> provides information on the actual checks to ensure that the target system is compliant with the security requirements.
:::

:::details What is the relationship between <i>Profiles</i>, <i>Controls</i>, and <i>Results</i>?
- The profile contains some number of controls which were tested against the target system during the original security tool run.

- Any given control contains some number of results which reflect the implemented tests to check if the target system is actually compliant.
:::

:::details What is the purpose of `passthrough`?
`passthrough` is used to store extraneous information from the source data that has no equivalent in the OHDF schema. It is also used to store the entire raw source data in the `raw` subfield. The overall goal is to preserve data as thoroughly as possible. 
:::
