---
order: 6
next: 07.md
title: Formal OHDF Schema Definition
author: Charles Hu
---

## Breaking Down the Formal OHDF Schema

We can break down the formal OHDF schema in the same manner as before by observing each structure in the hierarchy from a top-down view.

::: note Full OHDF Schema
The following section contains a breakdown of a streamlined version of the OHDF schema. For the full and up-to-date version, see [here](https://saf.mitre.org/framework/normalize/ohdf-schema). Visit [here](https://github.com/mitre/heimdall2/blob/master/libs/inspecjs/src/generated_parsers/v_1_0/exec-json.ts) for the technical implementation of the schema.
:::

### 1. <i>Exec JSON</i>
 
Field Name | Definition
-|-
`platform` | Platform substructure (see `Additional Structures`).
`profiles` | Profiles substructure (see below).
`statistics` | Statistics substructure (see below).
`version` | Version of tool generating the file.

### 2. <i>**Profiles**</i>

Field Name | Definition
-|-
`name` | Name of profile, usually the original security tool; must be unique.
`version` | Version of security tool.
`sha256` | Checksum of the profile (NOTE: AUTOMATICALLY GENERATED BY HDF CONVERTERS, DO NOT POPULATE).
`title` | Title of security tool; must be human readable.
`maintainer` | Maintainer(s).
`summary` | Summary of security data (e.g., the STIG header).
`license` | Copyright license.
`copyright` | Copyright holder.
`copyright_email` | Copyright holder's email.
`supports` | Supported platform targets.
`attributes` | Inputs/attributes used in scan.
`groups` | Set of descriptions for the control groups (e.g., control IDs).
`controls` | Controls substructure (see below).
`status` | Status of profile (typically 'loaded').
`status_message` | Reason for the status.
`skip_message` | Reason for skipping this profile if skipped.
`depends` | Set of dependencies this profile depends on (e.g., an overlay profile is dependent on another profile).
`parent_profile` | Name of the parent profile if this profile is a dependency of another profile.
`description` | Description of profile; should be more detailed than summary.
`inspec_version` | The version of the Inspec tool used to generate this profile.

#### Example

:::note Required Fields
Not all fields are required. This will be expanded upon in the next section.
:::

Here's an example of a <i>profiles</i> section from a converted GoSec data file:

::: details OHDF Converted GoSec Data
```json
"profiles": [
  {
    "name": "Gosec scanner",
    "title": "gosec",
    "version": "dev",
    "supports": [],
    "attributes": [],
    "groups": [],
    "status": "loaded",
    "controls": [
      ...
    ],
    "sha256": "d0506f4b7715bf8b1cd81a8a87ab8efcce41ebeb2b5ec5fcfb23d3bdd136f48c"
  }
]
```
:::

### 3. <i>**Controls**</i>
Field Name | Definition
-|-
`id` | ID of control, used for sorting.
`title` | Title of control.
`desc` | The overarching description of the control.
`descriptions` | Additional descriptions; usually 'check' and 'fix' text for control.
`impact` | Security severity of control. On a scale of 0 to 1. This metric is aligned with the [Common Vulnerability Scoring System (CVSS)](https://www.first.org/cvss/).
`refs` | References to external control documentation.
`tags` | Control tags; typically correlate to existing vulnerability/weakness database (e.g., NIST, CVE, CWE).
`code` | Control source code for code preservation.
`source_location` | Location of control within source code.
`results` | Results substructure (see below).
`waiver_data` | Information on waiver if applicable.
`attestation_data` | Information on attestation if applicable.

#### Example

Here's an example of a <i>controls</i> section from a converted GoSec data file:

::: details OHDF Converted GoSec Data
```json
"controls": [
  {
    "tags": {
      "nist": ["SI-10"],
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "nosec": "",
      "suppressions": "",
      "severity": "MEDIUM",
      "confidence": "HIGH"
    },
    "refs": [],
    "source_location": {},
    "title": "Potential file inclusion via variable",
    "id": "G304",
    "desc": "",
    "impact": 0.5,
    "results": [
      ...
    ]
  }
],
```
:::

### 4. <i>**Results**</i>

Field Name | Definition
-|-
`status` | `passed`/`failed` status of test (other status include `skipped` and `error`).
`skip_message` | Reasoning for if test has `skipped` status.
`code_desc` | Test expectations as defined by control.
`exception` | Type of exception if one was thrown.
`backtrace` | Backtrace of exception if one was thrown.
`message` | Explanation of test status; typically in the form of expected and actual results.
`resource` | Resources used in the test (e.g., Inspec).
`resource_id` | The unique ID of the used resources.
`run_time` | Overall runtime of test.
`start_time` | Starting time of test.

#### Example

Here's an example of a <i>results</i> section from a converted Twistlock data file:

::: details OHDF Converted Twistlock Data
```json
"results": [
  {
    "status": "failed",
    "code_desc": "Package \"nss-util\" should be updated to latest version above impacted versions [\"*\"]",
    "message": "Expected latest version of \"nss-util\"\nDetected vulnerable version \"3.67.0-7.el8_5\" of \"nss-util\"",
    "start_time": "2022-05-18T12:24:22Z"
  }
]
```
:::

### 5. Additional Structures

There are additional structures in the OHDF schema which are used for metadata/extraneous information storage. These exist alongside the <i>profiles</i> structure on the top level of the HDF schema. The general structure for the top level of the HDF schema is as follows:

Field Name | Definition
-|-
`platform` | Information on the platform producing the export.
`platform.name` | Name of platform export was run on.
`platform.release` | Platform version.
`platform.target_id` | Platform target ID (i.e., further identifying information on platform).
`statistics` | Statistics relating to target scan run.
`statistics.controls` | Break down of control statistics by result status.
`statistics.duration` | Duration of run (in seconds).
`profiles` | Profiles structure.
`passthrough` | Extraneous information storage.
`passthrough.auxiliary_data` | Storage for unused data from the sample file.
`passthrough.auxiliary_data.name` | Name of auxiliary data source.
`passthrough.auxiliary_data.data` | Auxiliary data.
`passthrough.raw` | Raw data dump of input security service export.

#### Example

Here's an example of the additional structures from a converted Twistlock data file:

::: details OHDF Converted Twistlock Data
```json
{
  "platform": {
    "name": "Heimdall Tools",
    "release": "2.10.8",
    "target_id": "registry.io/test:1a7a431a105aa04632f5f5fbe8f753bd245add0a"
  },
  "version": "2.10.8",
  "statistics": {},
  "profiles": [
    ...
  ],
  "passthrough": {
    "auxiliary_data": [
      {
        "name": "Twistlock",
        "data": {
          "results": [
            {
              "id": "sha256:b1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b",
              "distro": "Red Hat Enterprise Linux release 8.6 (Ootpa)",
              "distroRelease": "RHEL8",
              "digest": "sha256:c0274cb1e0c6e92d2ccc1e23bd19b7dddedbaa2da26861c225d4ad6cec5047f4",
              "packages": [
                {
                  "type": "os",
                  "name": "nss-util",
                  "version": "3.67.0-7.el8_5",
                  "licenses": ["MPLv2.0"]
                }
              ],
              "applications": [
                {
                  "name": ".net-core",
                  "version": "5.0.17",
                  "path": "/usr/lib64/dotnet/dotnet"
                }
              ],
              "complianceScanPassed": true,
              "vulnerabilityScanPassed": true,
              "history": [{ "created": "2022-05-03T08:38:31Z" }],
              "scanTime": "2022-05-18T12:24:32.855444532Z",
              "scanID": "6284e580d9600f8d0db159e2"
            }
          ],
          "consoleURL": "https://twistlock.test.net/#!/monitor/vulnerabilities/images/ci?search=sha256%3Ab1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b"
        }
      }
    ]
  }
}
```
:::

## Knowledge Check

:::details What is the purpose of <i>Profiles</i>, <i>Controls</i>, and <i>Results</i>?
- <i>Profiles</i> provides a high-level overview of the security tool result and the targeted system (i.e., metadata).

- <i>Controls</i> provides information on the security requirements being applied to the target system.

- <i>Results</i> provides information on the actual checks to ensure that the target system is compliant with the security requirements.
:::

:::details What is the relationship between <i>Profiles</i>, <i>Controls</i>, and <i>Results</i>?
- Any given profile contains some number of controls which were tested against the target system during the original security tool run.

- Any given control contains some number of results which reflect the implemented tests to check if the target system is actually compliant.
:::

:::details What is `passthrough`?
`passthrough` is used to store extraneous information from the source data that has no equivalent in the OHDF schema. It is also used to store the entire raw source data in the `raw` subfield.
:::
