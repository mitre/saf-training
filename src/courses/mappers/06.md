---
order: 6
next: 07.md
title: Formal OHDF Schema Definition
author: Charles Hu
---

## Breaking Down the Formal OHDF Schema

We can break down the formal OHDF schema in the same manner as before by observing each structure in the hierarchy from a top-down view.

::: note Full OHDF Schema
The following section contains a breakdown of a streamlined version of the OHDF schema. For the full and up-to-date version, see [here](https://saf.mitre.org/framework/normalize/ohdf-schema).
:::

### 1. <i>**Profiles**</i>

::: details Profiles Schema
```json
profiles: [
  0: {
    name,
    version,
    sha256,
    title,
    maintainer,
    summary,
    license,
    copyright,
    copyright_email,
    supports,
    attributes,
    groups,
    controls,
    status
  },
  ... // More items may exist if the security service produces multiple profiles per export
]
```
:::

- `name`: Name of profile, usually the original security service tool; should be unique.
- `version`: Version of security service tool.
- `sha256`: Checksum of the profile (NOTE: AUTOMATICALLY GENERATED BY HDF CONVERTERS, DO NOT POPULATE).
- `title`: Title of security service scan; should be human readable.
- `maintainer`: Maintainer.
- `summary`: Summary of security service export (e.g., the STIG header).
- `license`: Copyright license.
- `copyright`: Copyright holder.
- `copyright_email`: Copyright holder's email.
- `supports`: Supported platform targets.
- `attributes`: Inputs/attributes used in scan.
- `groups`: Set of descriptions for the control groups (e.g., control IDs).
- `controls`: Controls substructure (see below).
- `status`: Status of profile (typically 'loaded').

#### Example

Here's an example of a <i>profiles</i> section from a converted GoSec data file:

::: details OHDF Converted GoSec Data
```json
"profiles": [
  {
    "name": "Gosec scanner",
    "title": "gosec",
    "version": "dev",
    "supports": [],
    "attributes": [],
    "groups": [],
    "status": "loaded",
    "controls": [
      ...
    ],
    "sha256": "d0506f4b7715bf8b1cd81a8a87ab8efcce41ebeb2b5ec5fcfb23d3bdd136f48c"
  }
]
```
:::

### 2. <i>**Controls**</i>

::: details Controls Schema
```json
controls: [
  0: {
    id,
    title,
    desc,
    descriptions,
    impact,
    refs,
    tags,
    code,
    source_location,
    results
  },
  ... // More items may exist if there are multiple controls reported per profile
]
```
:::

- `id`: ID of control, used for sorting; should be unique for each unique control.
- `title`: Title of control.
- `desc`: Description of the control.
- `descriptions`: Additional descriptions; usually 'check' and 'fix' text for control.
- `impact`: Security severity of control. On a scale of 0.1 to 1. This metric is aligned with the [Common Vulnerability Scoring System (CVSS)](https://www.first.org/cvss/).
- `refs`: References to external control documentation.
- `tags`: Control tags; typically correlate to existing vulnerability/weakness database (e.g., NIST, CVE, CWE).
- `code`: Control source code for code preservation.
- `source_location`: Location of control within source code.
- `results`: Results substructure (see below).

#### Example

Here's an example of a <i>controls</i> section from a converted GoSec data file:

::: details OHDF Converted GoSec Data
```json
"controls": [
  {
    "tags": {
      "nist": ["SI-10"],
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "nosec": "",
      "suppressions": "",
      "severity": "MEDIUM",
      "confidence": "HIGH"
    },
    "refs": [],
    "source_location": {},
    "title": "Potential file inclusion via variable",
    "id": "G304",
    "desc": "",
    "impact": 0.5,
    "results": [
      ...
    ]
  }
],
```
:::

### 3. <i>**Results**</i>

::: details Results Schema
```json
results: [
  0: {
    status,
    code_desc,
    message,
    run_time,
    start_time
  },
  ... // More items may exist if there are multiple results tested per control
]
```
:::

- `status`: Pass/fail status of test (other statuses exist but are rare).
- `code_desc`: Test expectations as defined by control.
- `message`: Demonstration of expected and actual result of test to justify test status.
- `run_time`: Overall runtime of test.
- `start_time`: Starting time of test.

#### Example

Here's an example of a <i>results</i> section from a converted Twistlock data file:

::: details OHDF Converted Twistlock Data
```json
"results": [
  {
    "status": "failed",
    "code_desc": "Package \"nss-util\" should be updated to latest version above impacted versions [\"*\"]",
    "message": "Expected latest version of \"nss-util\"\nDetected vulnerable version \"3.67.0-7.el8_5\" of \"nss-util\"",
    "start_time": "2022-05-18T12:24:22Z"
  }
]
```
:::

### 4. Additional Structures

There are additional structures in the OHDF schema which are used for metadata/extraneous information storage. These exist alongside the <i>profiles</i> structure on the top level of the HDF schema. The general structure for the top level of the HDF schema is as follows:

::: details Additional Schema
```json
{
  platform: {
    name,
    release,
    target_id
  },
  version,
  statistics: {
    duration
  },
  profiles,
  passthrough: {
    auxiliary_data: [
      0: {
        name,
        data
      },
      ... // More items may exist if there are multiple auxiliary data sources available
    ],
    raw
  }
}
```
:::

- `platform`: Information on the platform producing the export.
  - `name`: Name of platform export was run on.
  - `release`: Platform version.
  - `target_id`: Platform target ID (i.e., further identifying information on platform).
- `version`: Platform version.
- `statistics`: Statistics relating to target scan run.
  - `duration`: Duration of run.
- `profiles`: Profiles structure.
- `passthrough`: Extraneous information storage.
  - `auxiliary_data`: Storage for unused data from the sample file.
    - `name`: Name of auxiliary data source.
    - `data`: Auxiliary data.
  - `raw`: Raw data dump of input security service export.

#### Example

Here's an example of the additional structures from a converted Twistlock data file:

::: details OHDF Converted Twistlock Data
```json
{
  "platform": {
    "name": "Heimdall Tools",
    "release": "2.10.8",
    "target_id": "registry.io/test:1a7a431a105aa04632f5f5fbe8f753bd245add0a"
  },
  "version": "2.10.8",
  "statistics": {},
  "profiles": [
    ...
  ],
  "passthrough": {
    "auxiliary_data": [
      {
        "name": "Twistlock",
        "data": {
          "results": [
            {
              "id": "sha256:b1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b",
              "distro": "Red Hat Enterprise Linux release 8.6 (Ootpa)",
              "distroRelease": "RHEL8",
              "digest": "sha256:c0274cb1e0c6e92d2ccc1e23bd19b7dddedbaa2da26861c225d4ad6cec5047f4",
              "packages": [
                {
                  "type": "os",
                  "name": "nss-util",
                  "version": "3.67.0-7.el8_5",
                  "licenses": ["MPLv2.0"]
                }
              ],
              "applications": [
                {
                  "name": ".net-core",
                  "version": "5.0.17",
                  "path": "/usr/lib64/dotnet/dotnet"
                }
              ],
              "complianceScanPassed": true,
              "vulnerabilityScanPassed": true,
              "history": [{ "created": "2022-05-03T08:38:31Z" }],
              "scanTime": "2022-05-18T12:24:32.855444532Z",
              "scanID": "6284e580d9600f8d0db159e2"
            }
          ],
          "consoleURL": "https://twistlock.test.net/#!/monitor/vulnerabilities/images/ci?search=sha256%3Ab1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b"
        }
      }
    ]
  }
}
```
:::
