---
order: 6
next: 07.md
title: Formal OHDF Schema Definition
author: Charles Hu
---

## Breaking Down the Formal OHDF Schema

We can break down the formal OHDF schema in the same manner as before by observing each structure in the hierarchy from a top-down view.

::: note Full OHDF Schema
The following section contains a breakdown of a streamlined version of the OHDF schema. For the full and up-to-date version, see [here](https://saf.mitre.org/framework/normalize/ohdf-schema).
:::

### 1. <i>**Profiles**</i>

::: details Profiles Schema
```
profiles: [
  0: {
    name,
    version,
    sha256,
    title,
    maintainer,
    summary,
    license,
    copyright,
    copyright_email,
    supports,
    attributes,
    groups,
    controls,
    status
  },
  ... // More items may exist if the security service produces multiple profiles per export
]
```
:::

- `name`: Name of profile, usually the original security service tool; should be unique.
- `version`: Version of security service tool.
- `sha256`: Checksum of the profile (NOTE: AUTOMATICALLY GENERATED BY HDF CONVERTERS, DO NOT POPULATE).
- `title`: Title of security service scan; should be human readable.
- `maintainer`: Maintainer.
- `summary`: Summary of security service export (e.g., the STIG header).
- `license`: Copyright license.
- `copyright`: Copyright holder.
- `copyright_email`: Copyright holder's email.
- `supports`: Supported platform targets.
- `attributes`: Inputs/attributes used in scan.
- `groups`: Set of descriptions for the control groups (e.g., control IDs).
- `controls`: Controls substructure (see below).
- `status`: Status of profile (typically 'loaded').

### 2. <i>**Controls**</i>

::: details Controls Schema
```
controls: [
  0: {
    id,
    title,
    desc,
    descriptions,
    impact,
    refs,
    tags,
    code,
    source_location,
    results
  },
  ... // More items may exist if there are multiple controls reported per profile
]
```
:::

- `id`: ID of control, used for sorting; should be unique for each unique control.
- `title`: Title of control.
- `desc`: Description of the control.
- `descriptions`: Additional descriptions; usually 'check' and 'fix' text for control.
- `impact`: Security severity of control.
- `refs`: References to external control documentation.
- `tags`: Control tags; typically correlate to existing vulnerability/weakness database (e.g., NIST, CVE, CWE).
- `code`: Control source code for code preservation.
- `source_location`: Location of control within source code.
- `results`: Results substructure (see below).

### 3. <i>**Results**</i>

::: details Results Schema
```
results: [
  0: {
    status,
    code_desc,
    message,
    run_time,
    start_time
  },
  ... // More items may exist if there are multiple results tested per control
]
```
:::

- `status`: Pass/fail status of test (other statuses exist but are rare).
- `code_desc`: Test expectations as defined by control.
- `message`: Demonstration of expected and actual result of test to justify test status.
- `run_time`: Overall runtime of test.
- `start_time`: Starting time of test.

### 4. Additional Structures

There are additional structures in the OHDF schema which are used for metadata/extraneous information storage. These exist alongside the <i>profiles</i> structure on the top level of the HDF schema. The general structure for the top level of the HDF schema is as follows:

::: details Additional Schema
```
{
  platform: {
    name,
    release,
    target_id
  },
  version,
  statistics: {
    duration
  },
  profiles,
  passthrough: {
    auxiliary_data: [
      0: {
        name,
        data
      },
      ... // More items may exist if there are multiple auxiliary data sources available
    ],
    raw
  }
}
```
:::

- `platform`: Information on the platform producing the export.
  - `name`: Name of platform export was run on.
  - `release`: Platform version.
  - `target_id`: Platform target ID (i.e., further identifying information on platform).
- `version`: Platform version.
- `statistics`: Statistics relating to target scan run.
  - `duration`: Duration of run.
- `profiles`: Profiles structure.
- `passthrough`: Extraneous information storage.
  - `auxiliary_data`: Storage for unused data from the sample file.
    - `name`: Name of auxiliary data source.
    - `data`: Auxiliary data.
  - `raw`: Raw data dump of input security service export.
