---
order: 4
next: 05.md
title: What Is an OHDF Mapper?
author: Charles Hu
---

## What Is a Mapper?

A mapper is an instance of an adapter design pattern which is used to correlate (or map) items in two different objects with one another. Mappers are useful in that they allow us to correlate values in objects that are nominally different but semantically the same. A result of this is that we can easily transform one object type into another through the use of mappings which define the direct relationship of values in each object type. An important aspect of the transformation process is that while the objects containing the values are transformed, the values themselves typically remain the same.

Mappings are the actual correlation of values between two different objects. They are the basis for mappers and are responsible for defining which values between two objects are semantically the same. Mappers are the implementation of mappings which perform the necessary processing to transform the objects according to relationships found in the mappings. In order to have a mapper that is as accurate as possible in its transformations, the mappings should ideally include correlations for all values in the objects.

Here is a scenario which demonstrates some key aspects of mappers:

::: details Transferring IDs
Say we have a business that is changing its employee identification software and needs to transfer the current credentials of its employees from Software A to Software B. The data formats the softwares use for IDs are as follows:
```json
// Software A
{Name, DoB, Age, Title}

// Software B
{employee, employeeBirthday, employeeAge, jobTitle}
```

How do we transfer John's credentials from Software A to Software B?
```json
{Name: 'John Doe', DoB: 10-6-1992, Age: 32, Title: 'Security Technician'}
```

What we can do is create a mapping which correlates the items from Software A's ID scheme to Software B's:
```json
{employee: Name, employeeBirthday: DoB, employeeAge: Age, jobTitle: Title}
```

With this, we can then develop a mapper which takes John's credentials from Software A and transforms it to Software B's format as so:
```json
{Name: 'John Doe', DoB: 10-6-1992, Age: 32, Title: 'Security Technician'}

                                 ||
                                \  /
                                 \/

                               MAPPER

                                 ||
                                \  /
                                 \/

{employee: 'John Doe', employeeBirthday: 10-6-1992, employeeAge: 32, jobTitle: 'Security Technician'}
``` 

The important thing to note here is that mappers rely on underlying mappings which match semantically similar fields between two objects. These matches allow us to correctly convert each item in one object to the other.

Also note that mappers make translating between two objects trivial, which means that anyone can do it and we can automate mappers to perform object conversions for us.
:::

## What Is an OHDF Mapper?

An OHDF mapper is a mapper that allows the underlying conversion infrastructure found in OHDF Converters to correlate certain objects or values from one overarching security tool data format to another overarching security tool data format. In the case of the SAF tool suite, these mappers allow for the conversion of any given data format to OHDF (\*-to-OHDF) and vice versa (OHDF-to-\*) using the tools provided by the existing conversion infrastructure.

OHDF mappers are built upon the schemas that define the involved data formats, and the mechanics of the mappers revolve around correlating each schema's fields as accurately as possible.

### Examples

The following section show some simplified examples of security tool data that has been converted to OHDF using OHDF mappers.

Here are some key questions to keep note of while reading through these examples:

- How is the source data structured/organized (e.g., by requirement, by target system, by finding)?
- How is the OHDF file structured?
- Where are data fields in the source data going when converted to OHDF?

#### GoSec

::: details Source Data
```json
{
  "Golang errors": {},
  "Issues": [
    {
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "cwe": {
        "id": "22",
        "url": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "rule_id": "G304",
      "details": "Potential file inclusion via variable",
      "file": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go",
      "code": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
      "line": "83",
      "column": "14",
      "nosec": false,
      "suppressions": null
    }
  ],
  "Stats": {
    "files": 199,
    "lines": 12401,
    "nosec": 0,
    "found": 7
  },
  "GosecVersion": "dev"
}
```
:::

::: details Converted OHDF File
```json
{
  "platform": { "name": "Heimdall Tools", "release": "2.10.8" },
  "version": "2.10.8",
  "statistics": {},
  "profiles": [
    {
      "name": "Gosec scanner",
      "title": "gosec",
      "version": "dev",
      "supports": [],
      "attributes": [],
      "groups": [],
      "status": "loaded",
      "controls": [
        {
          "tags": {
            "nist": ["SI-10"],
            "cwe": {
              "id": "22",
              "url": "https://cwe.mitre.org/data/definitions/22.html"
            },
            "nosec": "",
            "suppressions": "",
            "severity": "MEDIUM",
            "confidence": "HIGH"
          },
          "refs": [],
          "source_location": {},
          "title": "Potential file inclusion via variable",
          "id": "G304",
          "desc": "",
          "impact": 0.5,
          "results": [
            {
              "status": "failed",
              "code_desc": "82: \t\tcase tar.TypeReg:\n83: \t\t\tf, err := os.OpenFile(target, os.O_CREATE|os.O_RDWR, os.FileMode(header.Mode))\n84: \t\t\tif err != nil {\n",
              "message": "C:\\Users\\AGILLUM\\OneDrive - The MITRE Corporation\\Documents\\Code\\grype-0.34.4\\internal\\file\\tar.go, line:83, column:14",
              "start_time": ""
            }
          ]
        }
      ],
      "sha256": "d0506f4b7715bf8b1cd81a8a87ab8efcce41ebeb2b5ec5fcfb23d3bdd136f48c"
    }
  ],
  "passthrough": {
    "auxiliary_data": [{ "name": "Gosec", "data": { "Golang errors": {} } }]
  }
}
```
:::

#### Twistlock

::: details Source Data
```json
{
  "results": [
    {
      "id": "sha256:b1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b",
      "name": "registry.io/test:1a7a431a105aa04632f5f5fbe8f753bd245add0a",
      "distro": "Red Hat Enterprise Linux release 8.6 (Ootpa)",
      "distroRelease": "RHEL8",
      "digest": "sha256:c0274cb1e0c6e92d2ccc1e23bd19b7dddedbaa2da26861c225d4ad6cec5047f4",
      "collections": ["All", "TEST-COLLECTION"],
      "packages": [
        {
          "type": "os",
          "name": "nss-util",
          "version": "3.67.0-7.el8_5",
          "licenses": ["MPLv2.0"]
        }
      ],
      "applications": [
        {
          "name": ".net-core",
          "version": "5.0.17",
          "path": "/usr/lib64/dotnet/dotnet"
        }
      ],
      "complianceDistribution": {
        "critical": 0,
        "high": 0,
        "medium": 0,
        "low": 0,
        "total": 0
      },
      "complianceScanPassed": true,
      "vulnerabilities": [
        {
          "id": "CVE-2021-43529",
          "status": "affected",
          "cvss": 9.8,
          "description": "DOCUMENTATION: A remote code execution flaw was found in the way NSS verifies certificates. This flaw allows an attacker posing as an SSL/TLS server to trigger this issue in a client application compiled with NSS when it tries to initiate an SSL/TLS connection.  Similarly, a server application compiled with NSS, which processes client certificates, can receive a malicious certificate via a client, triggering the flaw. The highest threat to this vulnerability is confidentiality, integrity, as well as system availability.              STATEMENT: The issue is not limited to TLS. Any applications that use NSS certificate verification are vulnerable; S/MIME is impacted as well.  Similarly, a server application compiled with NSS, which processes client certificates, can receive a malicious certificate via a client.  Firefox is not vulnerable to this flaw as it uses the mozilla::pkix for certificate verification. Thunderbird is affected when parsing email with the S/MIME signature.  Thunderbird on Red Hat Enterprise Linux 8.4 and later does not need to be updated since it uses the system NSS library, but earlier Red Hat Enterprise Linux 8 extended life streams will need to update Thunderbird as well as NSS.             MITIGATION: Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affec",
          "severity": "critical",
          "packageName": "nss-util",
          "packageVersion": "3.67.0-7.el8_5",
          "link": "https://access.redhat.com/security/cve/CVE-2021-43529",
          "riskFactors": [
            "Remote execution",
            "Attack complexity: low",
            "Attack vector: network",
            "Critical severity",
            "Recent vulnerability"
          ],
          "impactedVersions": ["*"],
          "publishedDate": "2021-12-01T00:00:00Z",
          "discoveredDate": "2022-05-18T12:24:22Z",
          "layerTime": "2022-05-16T23:12:25Z"
        }
      ],
      "vulnerabilityDistribution": {
        "critical": 5,
        "high": 1,
        "medium": 86,
        "low": 5,
        "total": 97
      },
      "vulnerabilityScanPassed": true,
      "history": [
        {
          "created": "2022-05-03T08:38:31Z"
        }
      ],
      "scanTime": "2022-05-18T12:24:32.855444532Z",
      "scanID": "6284e580d9600f8d0db159e2"
    }
  ],
  "consoleURL": "https://twistlock.test.net/#!/monitor/vulnerabilities/images/ci?search=sha256%3Ab1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b"
}
```
:::

::: details Converted OHDF File
```json
{
  "platform": {
    "name": "Heimdall Tools",
    "release": "2.10.8",
    "target_id": "registry.io/test:1a7a431a105aa04632f5f5fbe8f753bd245add0a"
  },
  "version": "2.10.8",
  "statistics": {},
  "profiles": [
    {
      "name": "Twistlock Scan",
      "title": "Twistlock Project: All / TEST-COLLECTION",
      "summary": "Package Vulnerability Summary: 97 Application Compliance Issue Total: 0",
      "supports": [],
      "attributes": [],
      "groups": [],
      "status": "loaded",
      "controls": [
        {
          "tags": {
            "nist": ["SI-2", "RA-5"],
            "cci": ["CCI-002605", "CCI-001643"],
            "cveid": "CVE-2021-43529"
          },
          "refs": [],
          "source_location": {},
          "title": "CVE-2021-43529",
          "id": "CVE-2021-43529",
          "desc": "DOCUMENTATION: A remote code execution flaw was found in the way NSS verifies certificates. This flaw allows an attacker posing as an SSL/TLS server to trigger this issue in a client application compiled with NSS when it tries to initiate an SSL/TLS connection.  Similarly, a server application compiled with NSS, which processes client certificates, can receive a malicious certificate via a client, triggering the flaw. The highest threat to this vulnerability is confidentiality, integrity, as well as system availability.              STATEMENT: The issue is not limited to TLS. Any applications that use NSS certificate verification are vulnerable; S/MIME is impacted as well.  Similarly, a server application compiled with NSS, which processes client certificates, can receive a malicious certificate via a client.  Firefox is not vulnerable to this flaw as it uses the mozilla::pkix for certificate verification. Thunderbird is affected when parsing email with the S/MIME signature.  Thunderbird on Red Hat Enterprise Linux 8.4 and later does not need to be updated since it uses the system NSS library, but earlier Red Hat Enterprise Linux 8 extended life streams will need to update Thunderbird as well as NSS.             MITIGATION: Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affec",
          "impact": 0.9,
          "code": "{\n  \"id\": \"CVE-2021-43529\",\n  \"status\": \"affected\",\n  \"cvss\": 9.8,\n  \"description\": \"DOCUMENTATION: A remote code execution flaw was found in the way NSS verifies certificates. This flaw allows an attacker posing as an SSL/TLS server to trigger this issue in a client application compiled with NSS when it tries to initiate an SSL/TLS connection.  Similarly, a server application compiled with NSS, which processes client certificates, can receive a malicious certificate via a client, triggering the flaw. The highest threat to this vulnerability is confidentiality, integrity, as well as system availability.              STATEMENT: The issue is not limited to TLS. Any applications that use NSS certificate verification are vulnerable; S/MIME is impacted as well.  Similarly, a server application compiled with NSS, which processes client certificates, can receive a malicious certificate via a client.  Firefox is not vulnerable to this flaw as it uses the mozilla::pkix for certificate verification. Thunderbird is affected when parsing email with the S/MIME signature.  Thunderbird on Red Hat Enterprise Linux 8.4 and later does not need to be updated since it uses the system NSS library, but earlier Red Hat Enterprise Linux 8 extended life streams will need to update Thunderbird as well as NSS.             MITIGATION: Red Hat has investigated whether a possible mitigation exists for this issue, and has not been able to identify a practical example. Please update the affec\",\n  \"severity\": \"critical\",\n  \"packageName\": \"nss-util\",\n  \"packageVersion\": \"3.67.0-7.el8_5\",\n  \"link\": \"https://access.redhat.com/security/cve/CVE-2021-43529\",\n  \"riskFactors\": [\n    \"Remote execution\",\n    \"Attack complexity: low\",\n    \"Attack vector: network\",\n    \"Critical severity\",\n    \"Recent vulnerability\"\n  ],\n  \"impactedVersions\": [\n    \"*\"\n  ],\n  \"publishedDate\": \"2021-12-01T00:00:00Z\",\n  \"discoveredDate\": \"2022-05-18T12:24:22Z\",\n  \"layerTime\": \"2022-05-16T23:12:25Z\"\n}",
          "results": [
            {
              "status": "failed",
              "code_desc": "Package \"nss-util\" should be updated to latest version above impacted versions [\"*\"]",
              "message": "Expected latest version of \"nss-util\"\nDetected vulnerable version \"3.67.0-7.el8_5\" of \"nss-util\"",
              "start_time": "2022-05-18T12:24:22Z"
            }
          ]
        }
      ],
      "sha256": "998180601124e9d2b4f03be239a5bb68d9045ba2dc5a26fa2c8d453500288b2e"
    }
  ],
  "passthrough": {
    "auxiliary_data": [
      {
        "name": "Twistlock",
        "data": {
          "results": [
            {
              "id": "sha256:b1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b",
              "distro": "Red Hat Enterprise Linux release 8.6 (Ootpa)",
              "distroRelease": "RHEL8",
              "digest": "sha256:c0274cb1e0c6e92d2ccc1e23bd19b7dddedbaa2da26861c225d4ad6cec5047f4",
              "packages": [
                {
                  "type": "os",
                  "name": "nss-util",
                  "version": "3.67.0-7.el8_5",
                  "licenses": ["MPLv2.0"]
                }
              ],
              "applications": [
                {
                  "name": ".net-core",
                  "version": "5.0.17",
                  "path": "/usr/lib64/dotnet/dotnet"
                }
              ],
              "complianceScanPassed": true,
              "vulnerabilityScanPassed": true,
              "history": [{ "created": "2022-05-03T08:38:31Z" }],
              "scanTime": "2022-05-18T12:24:32.855444532Z",
              "scanID": "6284e580d9600f8d0db159e2"
            }
          ],
          "consoleURL": "https://twistlock.test.net/#!/monitor/vulnerabilities/images/ci?search=sha256%3Ab1c0237ebd29860066656372da10d8d7da33b34715986f74b3d5a7e4ba060d1b"
        }
      }
    ]
  }
}
```
:::
