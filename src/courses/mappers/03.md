---
order: 3
next: 04.md
title: Understanding the OHDF Schema
author: Charles Hu
---

## An Overview of the OHDF Schema

The OHDF schema is designed to provide a simple, structured, and hierarchal view of security validation results. Any file or object that implements the schema can be broken down into a hierarchy of three structures. These structures are:

1) <i>**Profiles**</i>: This structure contains metadata on the scan target of the original security service export and on the run performed by the security tool. <i>Profiles</i> provide a high-level overview of the security service scan and the targeted system, which are formated in a manner which is digestible and immediately accessible to the assessor.

2) <i>**Controls**</i>: Controls are security standards that are used to prevent, mitigate, and address various security risks to sensitive information and infrastructure. In the case of OHDF, the <i>controls</i> structure is a collection of controls tested for by an external security service to ensure that the target complies with vulnerability and weakness prevention standards. Any given <i>profile</i> contains any number of <i>controls</i> which were tested against the target system during the original security service analysis.

3) <i>**Results**</i>: The <i>results</i> structure contains information on the results of specific tests ran by the security service on the scan target against a security control. These results will always correlate to a certain control and will either report `passed` or `failed` to indicate the test status (other statuses exist but are rare) which cumulatively influence the determined compliance level of the scan target for some set of controls. Any given <i>control</i> contains any number of <i>results</i> which reflect the implemented tests to check if the target system is actually compliant with the control.

## Breaking Down the Formal OHDF Schema

::: note Full OHDF Schema
The following section contains a breakdown of a streamlined version of the OHDF schema. For the full and up-to-date version, see [here](https://saf.mitre.org/framework/normalize/ohdf-schema).
:::

We can break down the formal OHDF schema in the same manner as before by observing each structure in the hierarchy from a top-down view.

1) <i>**Profiles**</i>:
```
profiles: [
  0: {
    name             // Name of profile, usually the original security service tool; should be unique
    version          // Version of security service tool
    sha256           // Checksum of the profile; NOTE: AUTOMATICALLY GENERATED BY HDF CONVERTERS, DO NOT POPULATE
    title            // Title of security service scan; should be human readable
    maintainer       // Maintainer
    summary          // Summary of security service export (e.g., the STIG header)
    license          // Copyright license
    copyright        // Copyright holder
    copyright_email  // Copyright holder's email
    supports         // Supported platform targets
    attributes       // Inputs/attributes used in scan
    groups           // Set of descriptions for the control groups (e.g., control IDs)
    controls         // Controls substructure (see below)
    status           // Status of profile (typically 'loaded')
  }
  ... // More items may exist if the security service produces multiple profiles per export
]
```

2) <i>**Controls**</i>:

```
controls: [
  0: {
    id               // ID of control; used for sorting, should be unique for each unique control
    title            // Title of control
    desc             // Description of the control
    descriptions     // Additional descriptions; usually 'check' and 'fix' text for control
    impact           // Security severity of control
    refs             // References to external control documentation
    tags             // Control tags; typically correlate to existing vulnerability/weakness database (e.g., NIST, CVE, CWE)
    code             // Control source code for code preservation
    source_location  // Location of control within source code
    results          // Results substructure (see below)
  }
  ... // More items may exist if there are multiple controls reported per profile
]
```

3) <i>**Results**</i>:

```
results: [
  0: {
    status         // Pass/fail status of test (other statuses exist but are rare)
    code_desc      // Test expectations as defined by control
    message        // Demonstration of expected and actual result of test to justify test status
    run_time       // Overall runtime of test
    start_time     // Starting time of test
  }
  ... // More items may exist if there are multiple results tested per control
]
```

These aforementioned structures cumulatively result in the following generalized structure which primarily defines OHDF:

```
// Data fields have been removed for the sake of demonstration
profiles: [
  0: {
    controls: [
      0: {
        results: [
          0: {
          },
          ...
        ]
      },
      ...
    ]
  },
  ...
]
```

There are additional structures in the OHDF schema which are used for metadata/extraneous information storage. These exist alongside the <i>profiles</i> structure on the top level of the HDF schema. The general structure for the top level of the HDF schema is as follows:

```
{
  platform: {               // Information on the platform producing the export
    name                    // Name of platform export was run on
    release                 // Platform version
    target_id               // Platform target ID (i.e., further identifying information on platform)
  }
  version                   // Platform version
  statistics: {             // Statistics relating to target scan run
    duration                // Duration of run
  }
  profiles                  // Profiles structure
  passthrough: {            // Extraneous information storage
    auxiliary_data: [       // Storage for unused data from the sample file
      0: {
        name                // Name of auxiliary data source
        data                // Auxiliary data
      }
      ... // More items may exist if there are multiple auxiliary data sources available
    ]
    raw                     // Raw data dump of input security service export
  }
}
```

## The OHDF Schema

The streamlined OHDF schema is as follows:
```
{
  platform: {                // required field
    name                     // required field
    release                  // required field
    target_id
   }
  version                    // required field
  statistics: {              // required field
    duration
   }
  profiles: [                // required field
    0: {
      name                   // required field
      version
      sha256                 // required field
      title
      maintainer
      summary
      license
      copyright
      copyright_email
      supports               // required field
      attributes             // required field
      groups                 // required field
      controls: [            // required field
        0: {
          id                 // required field
          title
          desc
          descriptions
          impact             // required field
          refs               // required field
          tags               // required field
          code
          source_location    // required field
          results: [         // required field
            0: {
              status
              code_desc      // required field
              message
              run_time
              start_time     // required field
            }
          ]
        }
      ]
      status
    }
  ]
  passthrough: {
    auxiliary_data: [
      0: {
        name
        data
      }
    ]
    raw
  }
}
```
