---
order: 3
next: 04.md
title: Background & Overview 2
author: Charles Hu
---


### HDF Schema Breakdown <a name="schema"></a>

The HDF schema can be grouped into 3 sets of structures, with each structure being a subset of the previous structure. These groupings are: <i>profiles, controls</i>, and <i>results.</i>

The <i>profiles</i> structure contains metadata on the scan target of the original security service export and on the run performed by the security tool. This provides a high-level overview of the scan service run and target which are both digestible and easily accessible to the user. A generalized format is as follows:

```
profiles: [
  0: {
    name                 //Name of profile, usually the original security service tool; should be unique
    version              //Version of security service tool
    sha256               //Hash of HDF file; NOTE: AUTOMATICALLY GENERATED BY HDF CONVERTERS, DO NOT POPULATE
    title                //Title of security service scan; should be human readable
    maintainer           //Maintainer
    summary              //Summary of security service export
    license              //Copyright license
    copyright            //Copyright holder
    copyright_email      //Copyright holder's email
    supports             //Supported platform targets
    attributes           //Inputs/attributes used in scan
    groups               //Set of descriptions for the control groups
    controls             //Controls substructure (see below)
    status               //Status of profile (typically 'loaded')
  }
  ... //More items may exist if the security service produces multiple scan targets per export
]
``` 

Controls are security parameters used to prevent unauthorized access to sensitive information or infrastructure. In the case of HDF Converters, the <i>controls</i> structure is a collection of such controls tested for retroactively by an external security service to ensure that the target complies with vulnerability and weakness prevention standards. The <i>controls</i> structure is a subset of the <i>profiles</i> structure. A generalized format is as follows:

```
controls: [
  0: {
    id                //ID of control; used for sorting, should be unique for each unique control
    title             //Title of control
    desc              //Description of the control
    descriptions      //Additional descriptions; usually 'check' and 'fix' text for control
    impact            //Security severity of control
    refs              //References to external control documentation
    tags              //Control tags; typically correlate to existing vulnerability/weakness database (e.g., NIST, CVE, CWE)
    code              //Control source code for code preservation
    source_location   //Location of control within source code
    results           //Results substructure (see below)
  }
  ... //More items may exist if there are multiple controls reported per profile
]
```

The <i>results</i> structure contains information on the results of specific tests ran by the security service on the scan target against a set of security controls. These results will always correlate to a certain control and will either report 'passed' or 'failed' to indicate the test status (other statuses exist but are rare), which cumulatively affect the compliance level of the scan target with the indicated control set. The <i>results</i> structure is a subset of the <i>controls</i> structure. A generalized structure is as follows:

```
results: [
  0: {
    status         //Pass/fail status of test (other statuses exist but are rare)
    code_desc      //Test expectations as defined by control
    message        //Demonstration of expected and actual result of test to justify test status
    run_time       //Overall runtime of test
    start_time     //Starting time of test
  }
  ... //More items may exist if there are multiple results reported per control
]
```

These aforementioned structures cumulatively result in the following generalized structure which primarily defines the HDF:

```
//Data fields have been removed for the sake of demonstration
profiles: [
  0: {
    controls: [
      0: {
        results: [
          0: {
          },
          ...
        ]
      },
      ...
    ]
  },
  ...
]
```

There are additional structures in the HDF schema which are used for metadata/extraneous information storage. These exist alongside the <i>profiles</i> structure on the top level of the HDF schema. The general structure for the top level of the HDF schema is as follows:

```
{
  platform: {                //Information on the platform handling the HDF file; usually 'Heimdall Tools'
    name                    //Platform name
    release                 //Platform version
    target_id               //Platform target ID
  }
  version                    //Platform version
  statistics: {              //Statistics relating to target scan run
    duration                //Duration of run
  }
  profiles                   //Profiles structure
  passthrough: {             //Extraneous information storage
    auxiliary_data: [       //Storage for unused data from the sample file
      0: {
        name                //Name of auxiliary data source
        data                //Auxiliary data
      }
      ... //More items may exist if there are multiple auxiliary data sources available
    ]
    raw                     //Raw data dump of input security service export
  }
}
```
